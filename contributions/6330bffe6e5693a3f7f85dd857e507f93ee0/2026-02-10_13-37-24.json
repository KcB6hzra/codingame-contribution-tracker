{
  "id": 6330,
  "activeVersion": 10,
  "score": 11,
  "votableId": 17173984,
  "codingamerId": 599497,
  "views": 205,
  "commentableId": 17082443,
  "title": "Feature Extraction",
  "status": "ACCEPTED",
  "type": "PUZZLE_INOUT",
  "nickname": "codybumba",
  "publicHandle": "6330bffe6e5693a3f7f85dd857e507f93ee0",
  "codingamerHandle": "143ab94e386de9f77f9edf708ce4ff15794995",
  "lastVersion": {
    "version": 10,
    "autocloseTime": 1616742767284,
    "data": {
      "title": "Feature Extraction",
      "topics": [
        {
          "labelMap": {
            "2": "Convolution"
          }
        },
        {
          "labelMap": {
            "2": "Sliding window"
          }
        },
        {
          "id": 139,
          "handle": "dot-product",
          "labelMap": {
            "1": "Dot product",
            "2": "Dot product"
          },
          "puzzleCount": 1,
          "parentTopicId": 93
        }
      ],
      "solution": "r, c = [int(i) for i in input().split()]\npixels = [[] for _ in range(r)]\n\nfor i in range(r):\n    for j in input().split():\n        pixels[i].append(int(j))\n\nm, n = [int(i) for i in input().split()]\nweights = [[] for _ in range(m)]\n\nfor i in range(m):\n    for j in input().split():\n        weights[i].append(int(j))\n\nfor i in range(r-m+1):\n    a=[]\n    for j in range(c-n+1):\n        sum = 0\n        for k in range(m):\n            for l in range(n):\n                sum += pixels[i+k][j+l] * weights[k][l]\n        a.append(sum)\n    print(*a)\n",
      "statement": "<<Convolution>> is a method for extracting features from an input image which can be used for training a Deep Neural Network to classify input image. It produces an output matrix where each element is a weighted sum of neighbouring input elements using a <<kernel>> (weight matrix).\n\nGiven an input image of size [[r]] × [[c]] pixels (each pixel represented by an integer) and a kernel of size [[m]] × [[n]], print the ([[r]]-[[m]]+1) × ([[c]]-[[n]]+1) output pixels after the convolution.\n\nTo calculate the output pixel values, place the <<top left corner>> of kernel of size [[m]] × [[n]] on the input image matrix starting from the top left corner and then shift it one step right as long as it fits in the input image matrix. Then start again on the next row down.\n\nAt each location, calculate the sum of the weights multiplied by the pixel values at the overlapped cells. \n\n<<Example how convolution works>>\n\n{{Image Pixel Matrix}} \n\na11 a12 a13 a14\na21 a22 a23 a24\na31 a32 a33 a34\na41 a42 a43 a44\n\n{{Kernel Weight Matrix}}\n\nw11 w12\nw21 w22\n\nIn this case we have 9 possible placements of the kernel matrix. {{Output image size is 3×3}}.\n\nTop left corner at {{(0,0)}}\nWeighted Sum = a11 * w11 + a12 * w12 + a21 * w21 + a22 * w22\n\nTop left corner at {{(0,1)}}\nWeighted Sum = a12 * w11 + a13 * w12 + a22 * w21 + a23 * w22\n\nTop left corner at {{(0,2)}}\nWeighted Sum = a13 * w11 + a14 * w12 + a23 * w21 + a24 * w22\n\nTop left corner at {{(1,0)}}\nWeighted Sum = a21 * w11 + a22 * w12 + a31 * w21 + a32 * w22\n\nTop left corner at {{(1,1)}}\nWeighted Sum = a22 * w11 + a23 * w12 + a32 * w21 + a33 * w22\n\nSo on...\n\n<<For an animated visualization please refer to this link:>>  tinyurl.com/nk0vnyel\n\n<<Resources for more information:>>\nhttps://d2l.ai/chapter_convolutional-neural-networks/conv-layer.html\nhttps://developers.google.com/machine-learning/practica/image-classification/convolutional-neural-networks",
      "testCases": [
        {
          "title": "Test 1",
          "isTest": true,
          "testIn": "3 3\n100 200 100\n200 100 200\n50 100 50\n2 2\n-1 1\n1 -1",
          "testOut": "200 -200\n-150 150",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 1",
          "isTest": false,
          "testIn": "3 3\n200 200 100\n200 100 200\n50 100 250\n2 2\n1 -1\n-1 1",
          "testOut": "-100 200\n150 50",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 2",
          "isTest": true,
          "testIn": "5 5\n100 200 0 200 240\n20 230 240 0 250\n117 199 200 267 83\n29 212 243 111 33\n100 200 300 400 500\n3 3\n-1 0 -1\n-1 0 -1\n-1 0 -1",
          "testOut": "-677 -1096 -1013\n-849 -1019 -1049\n-989 -1389 -1359",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 2",
          "isTest": false,
          "testIn": "5 5\n100 200 0 200 240\n20 230 240 0 250\n117 199 200 267 83\n29 212 243 111 33\n100 200 300 400 500\n3 3\n1 0 -1\n1 0 -1\n1 0 -1",
          "testOut": "-203 162 -133\n-517 263 317\n-497 -167 127",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 3",
          "isTest": true,
          "testIn": "10 10\n247 152 122 236 159 118 172 233 133 121\n174 201 193 86 94 203 42 3 69 21\n221 56 36 182 108 163 48 240 119 89\n162 150 97 219 180 133 78 51 237 62\n189 100 234 246 138 50 69 201 90 98\n42 155 149 181 172 194 17 234 134 52\n247 249 131 244 11 227 32 221 14 197\n132 246 162 16 24 185 15 146 156 227\n121 3 118 199 241 231 18 12 152 147\n185 231 237 114 239 145 215 33 218 227\n5 5\n1 1 1 1 1\n1 2 2 2 1\n1 2 3 2 1\n1 2 2 2 1\n1 1 1 1 1",
          "testOut": "5238 5033 4882 4664 4140 3970\n5182 5379 4911 4432 4178 3881\n5664 5667 4990 4720 4257 4362\n5714 5580 4839 4388 4271 4366\n5414 5240 4569 4428 4287 4309\n5379 5266 4919 4535 4388 4361",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 3",
          "isTest": false,
          "testIn": "10 10\n161 72 73 175 63 209 15 212 23 56\n223 103 198 139 203 180 214 193 133 40\n68 156 56 193 8 235 172 254 66 112\n103 206 186 130 152 135 139 3 16 69\n85 130 236 57 159 88 76 14 24 180\n29 58 36 53 120 178 231 247 66 89\n84 223 83 43 174 148 159 91 77 201\n201 240 10 199 82 177 67 46 172 150\n227 57 75 85 45 44 194 176 27 201\n15 75 10 247 198 103 62 197 161 255\n5 5\n1 1 1 1 1\n1 -2 2 -2 1\n1 -2 3 -2 1\n1 -2 -2 -2 1\n1 1 1 1 1",
          "testOut": "306 1268 218 999 127 1330\n191 1286 895 1696 1341 1893\n1476 661 1434 405 635 704\n1446 913 1294 211 604 1179\n515 827 647 397 569 1098\n6 1542 938 1573 907 1086",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 4",
          "isTest": true,
          "testIn": "10 5\n129 176 6 190 225\n210 5 179 222 62\n137 51 87 40 106\n173 149 166 183 85\n53 81 213 6 228\n144 73 6 216 183\n32 9 200 34 54\n68 197 15 183 138\n143 197 113 34 94\n101 98 139 89 207\n3 3\n2 2 2\n2 5 2\n2 2 2",
          "testOut": "1975 2449 2900\n2467 2425 2380\n2667 2450 2777\n2359 2825 2590\n1841 1694 2928\n1515 2466 2160\n2539 2009 2279\n2733 2469 2126",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 4",
          "isTest": false,
          "testIn": "10 5\n229 112 117 120 172\n6 178 242 31 185\n106 252 18 131 205\n80 241 42 228 31\n116 247 41 5 133\n84 105 158 81 21\n217 207 53 88 118\n15 70 160 239 13\n106 69 181 141 164\n154 165 211 152 194\n3 3\n-2 2 -2\n-2 5 -2\n-2 2 -2",
          "testOut": "182 -168 -1221\n1110 -1464 -273\n1397 -1880 472\n885 -1209 -209\n95 -488 -457\n11 -679 34\n-562 -360 275\n-839 -25 -359",
          "isValidator": true,
          "needValidation": true
        }
      ],
      "difficulty": "easy",
      "constraints": "Kernel matrix is a square matrix.\n[[m]] ≤ [[r]] and [[n]] ≤ [[c]]",
      "coverBinaryId": 59513687608556,
      "stubGenerator": "read r:int c:int\nloop r loopline c pixel:int\nread m:int n:int\nloop m loopline n weight:int\nwrite output matrix",
      "inputDescription": "<<Line 1:>> The height ([[r]]) and width ([[c]]) of input image matrix separated by space.\n<<Next [[r]] lines:>> [[c]] pixel values separated by spaces.\n<<Line [[r]]+2:>> The height ([[m]]) and width ([[n]]) of the kernel matrix separated by space.\n<<Next [[m]] lines:>> [[n]] weights separated by spaces.",
      "solutionLanguage": "Python3",
      "outputDescription": "Print the output image matrix after the convolution."
    },
    "draft": false,
    "readyForModeration": true,
    "statementHTML": "<div class=\"statement-body\">\n<div class=\"statement-section statement-goal\">\n   <h2><span class=\"icon icon-goal\">&nbsp;</span><span>Goal </span></h2>\n   <span class=\"question-statement\"><strong>Convolution</strong> is a method for extracting features from an input image which can be used for training a Deep Neural Network to classify input image. It produces an output matrix where each element is a weighted sum of neighbouring input elements using a <strong>kernel</strong> (weight matrix).<br><br>Given an input image of size <var>r</var> &times; <var>c</var> pixels (each pixel represented by an integer) and a kernel of size <var>m</var> &times; <var>n</var>, print the (<var>r</var>-<var>m</var>+1) &times; (<var>c</var>-<var>n</var>+1) output pixels after the convolution.<br><br>To calculate the output pixel values, place the <strong>top left corner</strong> of kernel of size <var>m</var> &times; <var>n</var> on the input image matrix starting from the top left corner and then shift it one step right as long as it fits in the input image matrix. Then start again on the next row down.<br><br>At each location, calculate the sum of the weights multiplied by the pixel values at the overlapped cells. <br><br><strong>Example how convolution works</strong><br><br><const>Image Pixel Matrix</const> <br><br>a11 a12 a13 a14<br>a21 a22 a23 a24<br>a31 a32 a33 a34<br>a41 a42 a43 a44<br><br><const>Kernel Weight Matrix</const><br><br>w11 w12<br>w21 w22<br><br>In this case we have 9 possible placements of the kernel matrix. <const>Output image size is 3&times;3</const>.<br><br>Top left corner at <const>(0,0)</const><br>Weighted Sum = a11 * w11 + a12 * w12 + a21 * w21 + a22 * w22<br><br>Top left corner at <const>(0,1)</const><br>Weighted Sum = a12 * w11 + a13 * w12 + a22 * w21 + a23 * w22<br><br>Top left corner at <const>(0,2)</const><br>Weighted Sum = a13 * w11 + a14 * w12 + a23 * w21 + a24 * w22<br><br>Top left corner at <const>(1,0)</const><br>Weighted Sum = a21 * w11 + a22 * w12 + a31 * w21 + a32 * w22<br><br>Top left corner at <const>(1,1)</const><br>Weighted Sum = a22 * w11 + a23 * w12 + a32 * w21 + a33 * w22<br><br>So on...<br><br><strong>For an animated visualization please refer to this link:</strong>  tinyurl.com/nk0vnyel<br><br><strong>Resources for more information:</strong><br>https://d2l.ai/chapter_convolutional-neural-networks/conv-layer.html<br>https://developers.google.com/machine-learning/practica/image-classification/convolutional-neural-networks</span>\n</div>\n<div class=\"statement-section statement-protocol\">\n   <div class=\"blk\">\n      <div class=\"title\">Input</div>\n      <div class=\"question-statement-input\"><strong>Line 1:</strong> The height (<var>r</var>) and width (<var>c</var>) of input image matrix separated by space.<br><strong>Next <var>r</var> lines:</strong> <var>c</var> pixel values separated by spaces.<br><strong>Line <var>r</var>+2:</strong> The height (<var>m</var>) and width (<var>n</var>) of the kernel matrix separated by space.<br><strong>Next <var>m</var> lines:</strong> <var>n</var> weights separated by spaces.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Output</div>\n      <div class=\"question-statement-output\">Print the output image matrix after the convolution.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Constraints</div>\n      <div class=\"question-statement-constraints\">Kernel matrix is a square matrix.<br><var>m</var> &le; <var>r</var> and <var>n</var> &le; <var>c</var></div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Example</div>\n      <div class=\"statement-inout\">\n         <div class=\"statement-inout-in\">\n            <div class=\"title\">Input</div>\n            <pre class=\"question-statement-example-in\">3 3\n100 200 100\n200 100 200\n50 100 50\n2 2\n-1 1\n1 -1</pre>\n         </div>\n         <div class=\"statement-inout-out\">\n            <div class=\"title\">Output</div>\n            <pre class=\"question-statement-example-out\">200 -200\n-150 150</pre>\n         </div>\n      </div>\n   </div>\n</div>"
  },
  "validatedFor": 153986977927,
  "avatar": 20517704819076,
  "commentCount": 22,
  "upVotes": 11,
  "downVotes": 0,
  "validateAction": {
    "actionId": 539884,
    "progress": 1,
    "alreadyDone": false
  },
  "statusHistory": [
    {
      "status": "ACCEPTED",
      "date": 1616743665234,
      "data": {
        "author": "ACTION"
      }
    }
  ],
  "editable": true,
  "draft": false,
  "readyForModeration": true
}