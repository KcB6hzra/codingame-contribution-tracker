{
  "id": 105615,
  "activeVersion": 75,
  "score": 6,
  "votableId": 34992660,
  "codingamerId": 2064637,
  "views": 219,
  "commentableId": 34839559,
  "title": "BMP Compression",
  "status": "ACCEPTED",
  "type": "PUZZLE_INOUT",
  "nickname": "java_coffee_cup",
  "publicHandle": "105615743c85425b98b0fae376894d845c68fc",
  "codingamerHandle": "f4c116cad137a7eee91b727ff6fe53597364602",
  "lastVersion": {
    "version": 75,
    "autocloseTime": 1729242790673,
    "freezeTime": 1727255590673,
    "data": {
      "title": "BMP Compression",
      "topics": [
        {
          "labelMap": {
            "2": "Quadtree"
          }
        },
        {
          "id": 64,
          "handle": "image-processing",
          "category": "ADVANCED",
          "labelMap": {
            "1": "Traitement d'images",
            "2": "Image processing"
          },
          "pageTitle": "Image processing: exercises and theory",
          "puzzleCount": 9,
          "parentTopicId": 41,
          "contentDetailsId": 101
        },
        {
          "id": 71,
          "handle": "recursion",
          "category": "FUNDAMENTALS",
          "labelMap": {
            "1": "Récursion",
            "2": "Recursion"
          },
          "pageTitle": "Recursion: exercises and theory",
          "puzzleCount": 42,
          "parentTopicId": 41,
          "contentDetailsId": 77
        },
        {
          "id": 153,
          "handle": "2d-array",
          "category": "FUNDAMENTALS",
          "labelMap": {
            "1": "2D array",
            "2": "2D array"
          },
          "puzzleCount": 60,
          "parentTopicId": 93
        }
      ],
      "solution": "import java.util.LinkedList;\nimport java.util.List;\nimport java.util.Queue;\nimport java.util.Scanner;\nimport java.util.stream.Collectors;\n\npublic class Solution {\n\n\tpublic static void main(String[] args) {\n\t\tScanner in = new Scanner(System.in);\n\t\tString header = in.next();\n\t\tint w = Integer.parseInt(in.next());\n\t\tint h = Integer.parseInt(in.next());\n\t\tint ln = in.nextInt();\n\n\t\tin.nextLine();\n\t\tif (header.equals(\"B\")) {\n\t\t\tBitmap b = new Bitmap('B', w, h);\n\t\t\tfor (int y = 0; y < h; y++) {\n\t\t\t\tb.addBitmapLine(in.nextLine(), y);\n\t\t\t}\n\t\t\tb.b2c(0, 0, w, h);\n\t\t\tb.display();\n\t\t}\n\t\t// header is C\n\t\telse {\n\t\t\tBitmap b = new Bitmap('C', w, h);\n\t\t\tfor (int i = 0; i < ln; i++) {\n\t\t\t\tb.addCompressedLine(in.nextLine(), i);\n\t\t\t}\n\t\t\tb.finishCompressedInput();\n\t\t\tb.c2b(0, 0, w, h);\n\t\t\tb.display();\n\t\t}\n\t\tin.close();\n\t}\n}\n\nclass Bitmap {\n\tchar header;\n\tint w, h;\n\tchar[][] arr;\n\tStringBuilder sb;\n\tchar c0 = '.';\n\tchar c1 = '#';\n\tQueue<Character> q = new LinkedList<>();\n\n\tpublic Bitmap(char header, int w, int h) {\n\t\tthis.header = header;\n\t\tthis.w = w;\n\t\tthis.h = h;\n\t\tarr = new char[w][h];\n\t\tsb = new StringBuilder();\n\t}\n\n\tpublic void finishCompressedInput() {\n\t\tList<Character> list = sb.toString().chars().mapToObj(c -> (char) c).collect(Collectors.toList());\n\t\tq.addAll(list);\n\t}\n\n\tpublic void addCompressedLine(String s, int i) {\n\t\tsb.append(s);\n\t}\n\n\tpublic void addBitmapLine(String line, int y) {\n\t\tfor (int x = 0; x < line.length(); x++) {\n\t\t\tarr[x][y] = line.charAt(x);\n\t\t}\n\t}\n\n\tpublic void b2c(int x, int y, int ww, int hh) {\n\n\t\tif (ww == 0 || hh == 0) {\n\t\t\treturn;\n\t\t}\n\t\tint result = allSame(x, y, ww, hh);\n\n\t\tif (result == 0) {\n\t\t\tsb.append(\"0\");\n\t\t} else if (result == 1) {\n\t\t\tsb.append(\"1\");\n\t\t} else {\n\t\t\t// divide into 4 parts\n\t\t\tsb.append(\"+\");\n\t\t\tint w1 = (ww + 1) / 2;\n\t\t\tint h1 = (hh + 1) / 2;\n\t\t\tb2c(x, y, w1, h1);\n\t\t\tb2c(x + w1, y, ww / 2, (hh + 1) / 2);\n\t\t\tb2c(x, y + h1, w1, hh / 2);\n\t\t\tb2c(x + w1, y + h1, ww / 2, hh / 2);\n\t\t}\n\t}\n\n\tpublic void c2b(int x, int y, int ww, int hh) {\n\t\tif (ww == 0 || hh == 0 || q.isEmpty()) {\n\t\t\treturn;\n\t\t}\n\t\tchar c = q.poll();\n\n\t\tif (c == '0') {\n\t\t\tfillArea(x, y, ww, hh, c0);\n\t\t} else if (c == '1') {\n\t\t\tfillArea(x, y, ww, hh, c1);\n\t\t} else {\n\t\t\tint w1 = (ww + 1) / 2;\n\t\t\tint h1 = (hh + 1) / 2;\n\t\t\tc2b(x, y, w1, h1);\n\t\t\tc2b(x + w1, y, ww / 2, (hh + 1) / 2);\n\t\t\tc2b(x, y + h1, w1, hh / 2);\n\t\t\tc2b(x + w1, y + h1, ww / 2, hh / 2);\n\t\t}\n\t}\n\n\tpublic void display() {\n\t\t// b2c, display Compressed\n\t\tif (header == 'B') {\n\t\t\tint fixedLen = 50;\n\t\t\tSystem.out.printf(\"C %d %d\\n\", w, h);\n\t\t\tSystem.out.println((int) (Math.ceil((double) sb.length() / fixedLen)));\n\t\t\tint st = 0;\n\t\t\tint ed = fixedLen;\n\t\t\twhile (st < sb.length()) {\n\t\t\t\tif (ed > sb.length()) {\n\t\t\t\t\ted = sb.length();\n\t\t\t\t}\n\t\t\t\tSystem.out.println(sb.substring(st, ed));\n\t\t\t\tst += fixedLen;\n\t\t\t\ted += fixedLen;\n\t\t\t}\n\t\t}\n\t\t// c2b, display Bitmap\n\t\telse {\n\t\t\tSystem.out.printf(\"B %d %d\\n\", w, h);\n\t\t\tSystem.out.println(h);\n\t\t\tsb.setLength(0);\n\t\t\tfor (int y = 0; y < h; y++) {\n\t\t\t\tfor (int x = 0; x < w; x++) {\n\t\t\t\t\tsb.append(arr[x][y]);\n\t\t\t\t}\n\t\t\t\tsb.append(\"\\n\");\n\t\t\t}\n\t\t\tSystem.out.print(sb.toString());\n\t\t}\n\t}\n\n\t// for c2b\n\tprivate void fillArea(int xx, int yy, int ww, int hh, char c) {\n\t\tfor (int y = yy; y < yy + hh; y++) {\n\t\t\tfor (int x = xx; x < xx + ww; x++) {\n\t\t\t\tarr[x][y] = c;\n\t\t\t}\n\t\t}\n\t}\n\n\t// for b2c\n\t// return 0 if all are 0; return 1 if all are 1;\n\t// return -1 if NOT all the same\n\tprivate int allSame(int xx, int yy, int ww, int hh) {\n\t\tboolean has0 = false;\n\t\tboolean has1 = false;\n\t\tfor (int y = yy; y < yy + hh; y++) {\n\t\t\tfor (int x = xx; x < xx + ww; x++) {\n\t\t\t\tif (arr[x][y] == c0) {\n\t\t\t\t\thas0 = true;\n\t\t\t\t} else if (arr[x][y] == c1) {\n\t\t\t\t\thas1 = true;\n\t\t\t\t}\n\t\t\t\tif (has0 && has1) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (has0 && !has1) {\n\t\t\treturn 0;\n\t\t} else if (has1 && !has0) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn -1;\n\t}\n}\n",
      "statement": "Binary graphic data (black and white images) can be stored in bitmap files where a white pixel is represented by 0 and a black pixel is represented by 1. We shall explore two methods for storing these 0's and 1's.\n\nMethod 1 - 2D array of 0's and 1's representing all pixels in the image.\nMethod 2 - Decomposition. \n\n<<Algorithm>>\n\n■ The entire image area is considered. If the area is fully composed of white pixels, Write a single {{0}}. If the area is fully composed of black pixels, Write a single {{1}}. After writing this {{0}} or {{1}}, done for the area.\n■ If the area is a mixture of black and white pixels, Write {{+}} as a marking to indicate we are going to decompose the area into four quarters.\n■ After a decomposition, focus on each of the quarters, in the order of upper-left, upper-right, lower-left, and finally lower-right, treating each quarter just like the full image area to write {{0}}, {{1}}, or {{+}} according to the same rules, until all pixels in each quarter are fully considered and recorded.\n■ When dividing an area into quarters, if the width and height of the area are even, the cutting lines cut at the middle of the sides, evenly dividing the area into four sub-areas. If the width is odd, the left side sub-areas will have one pixel wider than the right sub-areas. If the height is odd, the upper sub-areas will have one pixel taller than the lower sub-areas.\n■ If the area to be decomposed has only one row of pixels, horizontal cut is skipped. Do only the vertical cut. If the area has only one column of pixels, vertical cut is skipped. Do only the horizontal cut.\n\n<<Compression ◄ ► De-compression>>\n\nResearchers called this decomposition structure <<Quadtree>>. It was a popular research topic in the 1980's for encoding and compressing graphics.\n\nIn this puzzle, you are given binary images in 2D array of characters. We use {{.}} and {{#}} rather than 0 and 1 to obtain sharper visuals. You are going to encode the data into quadtree structure. Data will usually be compressed after encoding.\n\nBesides, you also have to reverse the procedure to de-compress quadtree image data back to 2D array of image pixels.\n\n<<Optional reading>>\n\nSkip if you wish to. The following section verbosely explains how the image in the Example is encoded.\n\n`....#  2D array of pixels\n...#.  encoded result:\n#.#..\n.#...  +0+0110++101+0100\n\n\n...│.#  The whole image is\n...│#.  neither all-black nor all-white.\n───┼──\n#.#│..  Write +. Divide.\n.#.│..\n\nUpper-L, all white. Write 0\nUpper-R, mixed. Write +. Divide 4 pixels into 4 quarters\n  └── upper-L is white. Write 0\n  └── upper-R is black. Write 1\n  └── lower-L is black. Write 1\n  └── lower-R is white. Write 0\nLower-L, 2 rows of 3 columns. Mixed.\n  └── Write +. Divide.\n  └── upper-L is '#.' mixed. Write +. Divide.\n        └── sub-areas are '#' and '.'. Write 1 and 0\n  └── upper-R is '#'. Write 1\n  └── lower-L is '.#' mixed. Write +. Divide.\n        └── sub-areas are '.' and '#'. Write 0 and 1\n  └── lower-R is '.'. Write 0\nLower-R, all white. Write 0`\n\n\n<<References>>\n\nA. Rosenfeld, \"Quadtree grammars for picture languages,\" IEEE Trans. Syst., Man, Cybern., vol. SMC-12, pp. 401-405, 1982.\n\nK. Knowlton, \"Progressive transmission of grey scale and B/W pictures by simple, efficient and lossless encoding schemes,\" Proc. IEEE, vol. 68, pp. 885-896, 1980.",
      "testCases": [
        {
          "title": "Example",
          "isTest": true,
          "testIn": "B 5 4\n4\n....#\n...#.\n#.#..\n.#...",
          "testOut": "C 5 4\n1\n+0+0110++101+0100",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Example Validator",
          "isTest": false,
          "testIn": "B 4 5\n5\n...#\n..#.\n..#.\n.#..\n#...",
          "testOut": "C 4 5\n1\n+0++01+1010+01100",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Dot",
          "isTest": true,
          "testIn": "B 3 3\n3\n...\n..#\n...",
          "testOut": "C 3 3\n1\n+0+0100",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Dot Validator",
          "isTest": false,
          "testIn": "B 3 3\n3\n...\n.#.\n...",
          "testOut": "C 3 3\n1\n++0001000",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Blank",
          "isTest": true,
          "testIn": "B 3 5\n5\n###\n###\n###\n###\n###",
          "testOut": "C 3 5\n1\n1",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Blank Validator",
          "isTest": false,
          "testIn": "B 5 3\n3\n.....\n.....\n.....",
          "testOut": "C 5 3\n1\n0",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Smiley",
          "isTest": true,
          "testIn": "B 43 23\n23\n...........................................\n...................#######.................\n..............#####.......#####............\n...........###.................###.........\n.........##.......................##.......\n.......##..........................###.....\n......##.............................##....\n.....##........##..........###........##...\n....##........####........#####.......##...\n....##..........#...........#..........##..\n....##.................................##..\n....##.................................##..\n....##.................................##..\n....##........##.............##.......##...\n.....##........##...........###.......##...\n......##........###.......###........##....\n.......###.........#######.........###.....\n.........##......................###.......\n...........###.................###.........\n..............######.....######............\n....................#####..................\n...........................................\n...........................................",
          "testOut": "C 43 23\n10\n+++000+0+0011++0110++0001++0001+0011+100++11000000\n++0+00010++011++10+100000+0++011+0110++0110++0+00+\n01101+00++1000+0+0100000++++0011+00+1000++011+0010\n0+0+110000+00+++100+0110+0110++0+00010++011++00100\n100+++10000000++0+010000+++100100+1000+++011+0110+\n+0110+++0++011+0110+01+00++10000++10+011+001001++0\n+00100++0110+0+010000++1001+0011000+++1100+001100+\n+001100100++0++00+011010++0011++011+10000+++100000\n00+0+++011100+100++0001+011110+++10000000++0+00111\n0++0011+11000000++++10000000000",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Smiley Validator",
          "isTest": false,
          "testIn": "B 41 24\n24\n.........................................\n.........................................\n..............#############..............\n..........####.............####..........\n........###...................###........\n......###........................##......\n.....##...........................###....\n....##.............................###...\n...##.......###............###......##...\n..##...........###......###..........##..\n..##........###...........####.......##..\n..##.................................##..\n..##.................................##..\n..##.................................##..\n...##...............................##...\n....##........#########.####........##...\n.....##......##...##..##...##.....###....\n......##.........................##......\n........###....................##........\n..........####.............####..........\n..............#############..............\n.........................................\n.........................................\n.........................................",
          "testOut": "C 41 24\n10\n+++000++0001+011110++0001+0011++11000000++0+01+011\n0+10+++10000000++0101++100+100+01++1000++00++011+1\n00++00+011+011000++1000000+++0011+00++10000+++0110\n0+110100+00++00100+01+100+0+00++011+10+0+110000+++\n10011+001000++0+110100+++100100+1000+++011+0110++0\n110++++0101++100+1000+100+0++0110100++00+1000+100+\n00++0001+111000++1101+111000+0++0100+11010000+++00\n11001+001100++00++10+011+110000++10+011000+0+++011\n+0110+100+0+0011+01+10++10+100000++0011++00+011+00\n11++100000+++1000000000",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Ghost",
          "isTest": true,
          "testIn": "B 80 46\n46\n...........................####.....####........................................\n.........................##..............##.....................................\n.......................##..................##...................................\n......................#.........................................................\n.....................#.......................#..................................\n....................##........................#.................................\n....................#.......####...............#................................\n...................##...###.##..#..............#................................\n...................#...##...##..#...............#...............................\n...................#...##.#.#..##................#..............................\n..................##....###.####.................#..............................\n..................##.............................##.............................\n..................#...............................#.............................\n..................#...............................#.............................\n..................#................###########....#.............................\n......##.........................#...............###............................\n....##.........................##....................#..........................\n...##..........................#................................................\n..##..........................#.......................#.........................\n..#...........................#.......................#.........................\n..#...........................#................####...#.........................\n..#...............##..........##.......###...##.......#.........................\n..##............#..#...........##...##..........................................\n...#....#...###....#.............###............................................\n....####...........#............................................................\n...................#............................................................\n...................#............................................................\n....................#.................................#.........................\n....................##.................................#........................\n.....................##.................................#.......................\n......................#..................................##.....................\n.......................#...................................##...................\n........................#....................................##.................\n.........................##....................................####.............\n........................................................................###.....\n...........................##..............................................##...\n................................##...........................................##.\n..................................##..........................................##\n.....................................####......................#########.......#\n..........................................######......######............###....#\n...........................................................................##..#\n.............................................................................##.\n..............................................................................##\n...............................................................................#\n................................................................................\n................................................................................",
          "testOut": "C 80 46\n19\n+++000+0+0+00010+010+0+011101+++0001++0110+110000+\n+01+0100+1000++++10000000+++01100+11000000++++100+\n100+000101++0010101+0+110100+++01010+101100+++1001\n0+0100+++011100000++00+0+000101+++011+100000+0+0+1\n0100+1000+++0101+1000+0100++010+01+100+000+01++010\n+01+0+0+0011++00+011+1000++010000++++100+1000++100\n00++100++0110+0+01++0110+++++00+01100100++00+1000+\n+01000+0++010100+100+0+01010+01+00+00++100000+++00\n11+00++10000+0+010000++++100+1000++10000++1000+001\n0000+0+00+011++10000++10000++0+0101++100+010+0+010\n000++++0+100100++0011+10000000+++0100+110000+0+010\n10+010+0+01000000++00++00+1000+1000++0+110000+++10\n00000000++++0110100+100+0+010000++001000000++0++01\n00+10000000+++0001+00100+01+00++10000++0100+110000\n00++0+00+0+000100+00++10000+0+++01001+00100+0100+0\n0++00++10000+++01100+001100++0010000+00+00+0110++0\n0+++10001+001100++0011000+00+0+000100++0011+001100\n00++00+0+110000++1100+110000+0++1001+001001++1001+\n001100+0+0101+10+010+0++0100+10110+0100",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Ghost Validator",
          "isTest": false,
          "testIn": "B 28 29\n29\n.............########.......\n...........###.....###......\n..........#...........##....\n..........#...........##....\n.......###.............###..\n.......###..............###.\n......#.##..............###.\n.....##.#...............#.#.\n.....##.#...............#.#.\n.....##.#...#......#....#.##\n.....##.##..#...........#..#\n.....##.##....##.#......#..#\n......#..#....##.......##..#\n.......#..#.....#.....##..#.\n.......#..##..####....##.##.\n.......##..##.##.##..##..#..\n........#...#.##..#..#..##..\n........##..##.#.##..#..#...\n......####..##..##...#..#...\n.....#####.###.......#..#...\n....#...##.####.....##..#...\n....#...##.#####...###..#...\n....#...##.###########..#...\n...#....##.##.#....####.##..\n...#....##.##.##...#..#..#..\n...#....#..##.##..#...#..##.\n...#....#..#...####...#####.\n...#....###............#..#.\n...#....##................#.",
          "testOut": "C 28 29\n14\n+++000+00+00011++000+0101++0011100+1+1010+0101+100\n00+0++01011+010110+0+1000+++01010+0101+1010++00010\n+01000++0010+1001+10+01+00+100++++1100+110000++110\n110000+++00100+0101+10100+0+11010+0101++10110+1101\n0++00+0011+0001++0001000++1100+0010110++0+01010+01\n01++0101+0101++0001+1110+01+10++0001+1010++0+000+0\n10++0110+10+100+++11010+0111+1010++11010+01011++11\n01+1010+01+101++0+00010+0101++1000000+0+01010+010+\n++0101+1010+0101+1000+1+1010++0101+0011+01+10++100\n0000+++1+0100+0100+0111++10100+10000++0010010+0+01\n+011+++1110+0001+1010+0101++1010000++1010+0101+10+\n010+++1110+110010++11011+01100++0100+110000++10000\n00+++1011+0101+01010++00100+10110++0100+111000++11\n010+010",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Space",
          "isTest": true,
          "testIn": "B 84 39\n39\n....................................................................................\n....................................................................................\n....................................................................................\n....................................................................................\n....................................................................................\n....................................................................................\n....................................................................................\n............######................################..................................\n............##..##............####..............######..........######..............\n............####..........####........................####..####......####..........\n........................####............................####............##..........\n......................####................................####..........##..........\n....####............####....................................##..........##..........\n..####..##..........##........................................##......##............\n..##......##......##..........................................##....##..............\n..##....####......##..............................................####..............\n..########......####............................................####................\n................##............................................####..................\n................##..........................................##..##..................\n................##......................................####......##......####......\n................##....................................####......####....##..####....\n................##................................####..........##......##..####....\n................####............................####............##........####......\n............##....##........................####................##..................\n..........##......##....................####..................####..................\n........####........##..............####......................##....................\n........##..........##..........####........................####....................\n........##............##..######............................##......................\n........##..........########............................####........................\n..........##########......##..........................####..........................\n............................####..................######............................\n................................##################..................................\n....................................................................................\n....................................................................................\n....................................................................................\n....................................................................................\n....................................................................................\n....................................................................................\n....................................................................................",
          "testOut": "C 84 39\n20\n+++000++00++0111+00+100+++0110++0111++10000+00+00+\n000+01+0110++00+011+0011++100000+++000++011+00+100\n++011+01++100++01+100+01+0+000+01+00++1000+0+01+01\n+10+++0101++1001100++0111+11100000++++10000000++01\n11+1010+1000++100+100++++00+011+111010+++10000000+\n++1000000000++00++0011+00+1000+1100+00+++1000++011\n1+00+011+00+00+++0111++1000+++1000++01110+0++0+110\n000++1011+0010+01+100+0+010+010+0+000+01+0001++01+\n10+100++0+0101+++1000++100+01+++0110++10000+++00+0\n11+111010+++10000000+++01100+100+00+001+100+++000+\n000+01+0++101001+10+++0110++1000++01+10+01+10+0++0\n101+1110+01+100++01+100+01++++10000000+0+010100+00\n11+0+011+10+0+000+0001++++100+1000++011+01+0011+11\n0+01+++1000++1000+++0011+011000++1100000000++0+++0\n1100+11000000+++0011+001100++0011+0011000000+++0++\n0001+00111+10++011+1000++++011+100+11000000+000+01\n0+0++0001+0111+01+10+01++0111++10000+++++011+011+1\n000++0110+0100+++0110100+++010111+10+++100+1000000\n0++++100+1000000000++++0011+001100++0110+11000000+\n++1100000000000",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Space Validator",
          "isTest": false,
          "testIn": "B 78 33\n33\n..............................................................................\n..............................................................................\n......................................................########................\n................................................########....######............\n............................................######................##..........\n......................................##########....................##........\n................................######......##....##..................##......\n............................######........##......##..................##......\n......................######..............##............................##....\n................######....................##........####................##....\n............####................................####....................##....\n..........................................######........................##....\n......................................######........####................##....\n..................................######..............##..............##......\n..............................######........##..........##............##......\n..........................######............####..........##........##........\n......................####....................####................##..........\n..................####....................####..######........####............\n..............####......................####..........##########..............\n..........####......................####..................####................\n......####......................####....................##....................\n....##........................####....................##......................\n..................................................####........................\n................................................####..........................\n..............................................##..............................\n............................................##................................\n........................................####..................................\n......................................####....................................\n....................................####......................................\n..................................##..........................................\n..............................####............................................\n............................####..............................................\n..............................................................................",
          "testOut": "C 78 33\n16\n++0+00+00+00+011+0110++00+011+0+011+10+1+10000+0++\n00+011+++0111++10000000++++10000000+000+000+01+00+\n00+011+++0111++1000++0+0111+11+100++100000+++000+0\n+0111+0+0011+11++1000++10000++1100+1+10+100+01010+\n+00++01100+++0110000+++00100+++011100++100+01+100+\n0+0+010000++++1000++01100+++0110010+++0100+000+01+\n0111+1+1000++0110++10000+0001+00+100++++100000+00+\n1000+1+10+011+0++100+01+10+00++1000+0+0100+0++0101\n0+01010+00+++100000+0+01+01+10++++0110++01100+++10\n00000+++000+00++0111++000+01+0110+1+10000++0+0100+\n++100000000++++10000000+00+00+011++011+1000++1+100\n00000+0+000+0+01+011+000+0100++0+011+10++10000++10\n0000++++01++0111++10+0100+++1000000++1100+00110+0+\n01+01+10+000+0+01+01+10++00++0111++10000+10000+++0\n111++10000+10000000+++00++0111++10000+10++10000000\n0",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Bike",
          "isTest": true,
          "testIn": "C 57 16\n11\n++0+0++010++1000+0+0101+0011+00+0+0+010++01+10+110\n+01+++0+011+0+100+00++1000++100++10+100+++01+100+0\n+01++100+++000+01+0010+0+0111+10+1000++0+010++011+\n+1+100+010+0+10+0+01++100+0101+00+1100+++1000++01+\n100+++0++100+0+010+0++011+01+10++0+010+0+010+++011\n+10+01++100+++0+01++1000++100+0++0100++011+0++1000\n++100++0+0110+01++0++1000+0100+++011+1000+++0+010+\n+01+100000++++0+010+0+010++010+01+10++0+0111+10+11\n+0+100++++1000++011++100++0+0100++100+1+10+01++100\n+0++1000++100+0++0+0100+1000+0++0+010+100+++011+10\n000",
          "testOut": "B 57 16\n16\n........................##...............................\n......................#............#####.................\n.....................#.............#####.................\n...................###################...................\n..................####.............####..................\n.................#....#...........##..##.................\n.......##########......##........##.....###########......\n.....##.......##.#.......##.....##......###........##....\n....#........##...##.......#....#.....##...#.........#...\n...#......####.....#.......##...#.....####..####......#..\n...#.....#####.....#.....####...#################.....#..\n...#......###......#........#######...#......###......#..\n....#.............#....................#.............#...\n......##........##......................##........##.....\n.........#####..............................#####........\n.........................................................",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Bike Validator",
          "isTest": false,
          "testIn": "C 32 18\n7\n++0+0++100100+100+0+0100++000+011+0+010+010+11+001\n00++00+00+10000+110+0010+1+1010+00+01+10++01+100+1\n0+++0+01010+01++0001+0011+011+0+010+010+++1100+001\n101++00100+100+10100++0+010+01+00110+1100++0011+00\n11+1100+1100++0++1100+1000000+1+10+010+++0100+1100\n00+0+10100+10++011+01+10+0+100+10++0011+0011+1100+\n1100++0011+0+1010+1100+1000",
          "testOut": "B 32 18\n18\n............#...................\n.............#..................\n..............#.................\n...............#................\n................#...............\n....##########################..\n...###########################..\n...#.........................##.\n...#....##..........##...##...#.\n...#....##..........###..###..#.\n...#.###..###.................#.\n...#.###..###.................#.\n...#....##..........###..###..#.\n...#....##...........#...##...#.\n...#..........................#.\n...###########################..\n....##########################..\n................................",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Flower",
          "isTest": true,
          "testIn": "C 19 42\n10\n+++00+0++01000+1++1011+10+++0001+01+01010++010++10\n0+10+++10100+10+1011+01++01011+0+++100+100000++++0\n1+0100+1000+11+10100++++0+0111++011++10000++101++0\n101+01++1011111+1110+00++100000+++1+1011++101+1101\n0+1000++01011+01011+++011+1011+00+++100++100+011++\n+1011+100++0+++011++0110++1000+0011++++01+0101++01\n1++01+0101++011++01011+00+1100+10+01+10+10+0+01010\n+0100+00++0011+0100++01+0100++++1110000+++100++100\n00+00+1100+10+00+10+10+00+0011+00+100+00++0011+010\n0++01+0100++10100+10000",
          "testOut": "B 19 42\n42\n...................\n...........##......\n......###.####.....\n......#.###.##.....\n......#..#...#.....\n......#.....###....\n...#####..#.####...\n..##..##..#.####...\n...##...#.#####....\n...###..######.....\n...#.#########.....\n...##..#######.....\n....#######..#.....\n........######.....\n........####.......\n.........#.#.......\n...........##.#####\n...........####...#\n...........###...##\n...........####.##.\n...........######..\n..........##.##....\n...#####..##.......\n...##.###.#........\n....#...##.........\n.....#####.........\n......####.........\n.........#.........\n.........#.........\n.........#.........\n...###############.\n...##..........##..\n....#..........#...\n....#..........#...\n....#..........#...\n....#..........#...\n....#..........#...\n....#..........#...\n....#..........#...\n....############...\n...................\n...................",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Flower Validator",
          "isTest": false,
          "testIn": "C 16 49\n8\n+++111+111+10+1+1110+1+10000+1+1++0111111++++011++\n01111+++0110101+1010++++10100+11+1010+0++10000+11+\n+1010++1001+0+++011++0111101++++011++01111+++01111\n111+1++11++1000++1000+01++01++011++1000+++10000+01\n1+++010++1000+++010++1000+01++01+01111+++000++011+\n++100+10+010+00++010+01+++100++01000++11++10011++0\n11011++001++011+++100++010001+1++01111+++011011++0\n11111",
          "testOut": "B 16 49\n49\n################\n################\n########.#######\n########.#######\n#######...######\n#######...######\n#######....#####\n######.....#####\n######......####\n#####........###\n####.........###\n####..........##\n###...........##\n###............#\n#######...######\n#######...######\n#######...######\n#######...######\n#######...######\n#######...######\n#######...######\n#######...######\n#######...######\n#######...######\n#######...######\n#######...######\n#######....#####\n######......####\n#####.......####\n####.....#...###\n####...#.##..###\n####..#...#..###\n####.#.....#.###\n######......####\n#####........###\n####....#....###\n####...#.#...###\n####...#..#..###\n####..#....#.###\n#####.......####\n#####...#....###\n####....##...###\n####...###...###\n####..#####..###\n####..######.###\n################\n################\n################\n################",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "CG",
          "isTest": true,
          "testIn": "C 38 19\n7\n+++1+11+100+111+100+++1100+110000++1100+11000000++\n10100+10100+0+0+0011+011+000+011++++1100+110000++1\n100+1100000+0101++11+0111+1+101+10+11+011+++0011+0\n01111+0+0100+1001++100++1000+++1000000+01010+0101+\n++10100+1011++01111+++000111+10+1100++100++100001+\n00+1011+0011++++1100000000+0+01010+0101+00+0011+01\n11++000+01111",
          "testOut": "B 38 19\n19\n######################################\n##########...................#########\n#######........................#######\n#####......................######.####\n####.......................######..###\n###.........................###.....##\n###..............#######............##\n###.............##########..........##\n###............###########..........##\n###...........###########...........##\n###..........#########..............##\n###.........#######.................##\n###.......####......................##\n###....#####........................##\n###########.........................##\n##########........................####\n##########.......................#####\n#############..............###########\n######################################",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "CG Validator",
          "isTest": false,
          "testIn": "C 28 13\n6\n++1+1+11+100+1+10+100+00+011+1+1000+10+01++0+01+01\n+10++10000++1000+++110+011+00+010++011001++0+0100+\n00+01000++01001++100+01+++1+1011+10+1001++100+000+\n+011+1++100+1001++100+0++011+0110++011++00+1+100++\n0+100+01++01111+0+011++1+101+100+1+100++0+010+011+\n0+011",
          "testOut": "B 28 13\n13\n############################\n############.....###########\n##########.........#########\n########....##.#.....#######\n######....##.....#.....#####\n####....##.........#.....###\n##....##.............#.....#\n###.##.................#..##\n#####...................####\n#####.......#####.......####\n#####.......#####.......####\n#####.......#####.......####\n#####.......#####.......####",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "ASCII",
          "isTest": true,
          "testIn": "C 20 11\n4\n+++++011+1011++1010+1100+++101+101+0101++1010++11+\n100+11100+10++1100+1+1001+01+01++11+1001++1000++01\n01+0101+01+01++++101+1010++1010++00+011+101100+++1\n001+0111++++10011000++0101+0101+01+011++10+0110",
          "testOut": "B 20 11\n11\n.##################.\n#.################.#\n#.#..............#.#\n#.#.###########..#.#\n#.#.##..#.#..##..#.#\n#.#.....#.#......#.#\n#.#.....#.#......#.#\n#.#...#######....#.#\n#.#..............#.#\n#..##############..#\n..################..",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "ASCII Validator",
          "isTest": false,
          "testIn": "C 20 11\n4\n+++++011+1011++1010+1100+++101+1010++1010+++01111+\n1100+011++1100+1+1001+01+01++1100+1100+10+10++0101\n+0101+01+01++++101+1010++1010++0011+001100+++1001+\n+01111+++0011+011000++0101+0101+01+011++10+011+10",
          "testOut": "B 20 11\n11\n.##################.\n#.################.#\n#.#..............#.#\n#.#...#########..#.#\n#.#..###.........#.#\n#.#....#####.#...#.#\n#.#...........#..#.#\n#.#..#########...#.#\n#.#..............#.#\n#..##############..#\n.##################.",
          "isValidator": true,
          "needValidation": true
        }
      ],
      "difficulty": "medium",
      "constraints": "1 ≤ [[c]],[[r]],[[ln]] ≤ 500",
      "coverBinaryId": 129846347249108,
      "stubGenerator": "read h:word(16) c:int r:int\nread ln:int\nloop ln read line:string(1024)\nwrite answer\n",
      "inputDescription": "<<Line 1 :>> [[h]] [[c]] [[r]], space separated\n[[h]] is a header character, either {{B}} for bitmap or {{C}} for compressed-bitmap\n[[c]] is an integer for number of columns in the uncompressed image\n[[r]] is an integer for number of rows in the uncompressed image\n\n<<Line 2 :>> An integer [[ln]] for number of lines to follow\n\n<<Following [[ln]] lines :>> When it is a {{B}}itmap, [[ln]] is the same as [[r]]. Each line has a length of [[c]]. Read all lines to obtain an image in 2D array. \n\nWhen it is a {{C}}ompressed-bitmap, [[ln]] indicates how many lines the encoded image data is split into. Each line has a length of <<50>>. The last line can be shorter.",
      "solutionLanguage": "Java",
      "outputDescription": "When input is a {{B}}itmap, encode the image into quadtree data structure as defined above. When the data string is longer than 50, split the output data into <<50>> characters per line. Two regular header lines of {{C}}ompressed-bitmap input are needed. Refer to the Input description.\n\nWhen input is a {{C}}ompressed-bitmap, decode the data into 2D array of image data. Use dot {{.}} for white pixels. Use {{#}} for black pixels. Two regular header lines of {{B}}itmap input are needed. Refer to the input description.\n\nBecause input and output have compatible data structures, it is possible to re-inject an output data to the same program to obtain the original input data."
    },
    "draft": false,
    "readyForModeration": true,
    "statementHTML": "<div class=\"statement-body\">\n<div class=\"statement-section statement-goal\">\n   <h2><span class=\"icon icon-goal\">&nbsp;</span><span>Goal </span></h2>\n   <span class=\"question-statement\">Binary graphic data (black and white images) can be stored in bitmap files where a white pixel is represented by 0 and a black pixel is represented by 1. We shall explore two methods for storing these 0's and 1's.<br><br>Method 1 - 2D array of 0's and 1's representing all pixels in the image.<br>Method 2 - Decomposition. <br><br><strong>Algorithm</strong><br><br>■ The entire image area is considered. If the area is fully composed of white pixels, Write a single <const>0</const>. If the area is fully composed of black pixels, Write a single <const>1</const>. After writing this <const>0</const> or <const>1</const>, done for the area.<br>■ If the area is a mixture of black and white pixels, Write <const>+</const> as a marking to indicate we are going to decompose the area into four quarters.<br>■ After a decomposition, focus on each of the quarters, in the order of upper-left, upper-right, lower-left, and finally lower-right, treating each quarter just like the full image area to write <const>0</const>, <const>1</const>, or <const>+</const> according to the same rules, until all pixels in each quarter are fully considered and recorded.<br>■ When dividing an area into quarters, if the width and height of the area are even, the cutting lines cut at the middle of the sides, evenly dividing the area into four sub-areas. If the width is odd, the left side sub-areas will have one pixel wider than the right sub-areas. If the height is odd, the upper sub-areas will have one pixel taller than the lower sub-areas.<br>■ If the area to be decomposed has only one row of pixels, horizontal cut is skipped. Do only the vertical cut. If the area has only one column of pixels, vertical cut is skipped. Do only the horizontal cut.<br><br><strong>Compression ◄ ► De-compression</strong><br><br>Researchers called this decomposition structure <strong>Quadtree</strong>. It was a popular research topic in the 1980's for encoding and compressing graphics.<br><br>In this puzzle, you are given binary images in 2D array of characters. We use <const>.</const> and <const>#</const> rather than 0 and 1 to obtain sharper visuals. You are going to encode the data into quadtree structure. Data will usually be compressed after encoding.<br><br>Besides, you also have to reverse the procedure to de-compress quadtree image data back to 2D array of image pixels.<br><br><strong>Optional reading</strong><br><br>Skip if you wish to. The following section verbosely explains how the image in the Example is encoded.<br><br><pre style=\"font-family: monospace\">....#  2D array of pixels<br>...#.  encoded result:<br>#.#..<br>.#...  +0+0110++101+0100<br><br><br>...│.#  The whole image is<br>...│#.  neither all-black nor all-white.<br>───┼──<br>#.#│..  Write +. Divide.<br>.#.│..<br><br>Upper-L, all white. Write 0<br>Upper-R, mixed. Write +. Divide 4 pixels into 4 quarters<br>  └── upper-L is white. Write 0<br>  └── upper-R is black. Write 1<br>  └── lower-L is black. Write 1<br>  └── lower-R is white. Write 0<br>Lower-L, 2 rows of 3 columns. Mixed.<br>  └── Write +. Divide.<br>  └── upper-L is '#.' mixed. Write +. Divide.<br>        └── sub-areas are '#' and '.'. Write 1 and 0<br>  └── upper-R is '#'. Write 1<br>  └── lower-L is '.#' mixed. Write +. Divide.<br>        └── sub-areas are '.' and '#'. Write 0 and 1<br>  └── lower-R is '.'. Write 0<br>Lower-R, all white. Write 0</pre><br><br><br><strong>References</strong><br><br>A. Rosenfeld, &quot;Quadtree grammars for picture languages,&quot; IEEE Trans. Syst., Man, Cybern., vol. SMC-12, pp. 401-405, 1982.<br><br>K. Knowlton, &quot;Progressive transmission of grey scale and B/W pictures by simple, efficient and lossless encoding schemes,&quot; Proc. IEEE, vol. 68, pp. 885-896, 1980.</span>\n</div>\n<div class=\"statement-section statement-protocol\">\n   <div class=\"blk\">\n      <div class=\"title\">Input</div>\n      <div class=\"question-statement-input\"><strong>Line 1 :</strong> <var>h</var> <var>c</var> <var>r</var>, space separated<br><var>h</var> is a header character, either <const>B</const> for bitmap or <const>C</const> for compressed-bitmap<br><var>c</var> is an integer for number of columns in the uncompressed image<br><var>r</var> is an integer for number of rows in the uncompressed image<br><br><strong>Line 2 :</strong> An integer <var>ln</var> for number of lines to follow<br><br><strong>Following <var>ln</var> lines :</strong> When it is a <const>B</const>itmap, <var>ln</var> is the same as <var>r</var>. Each line has a length of <var>c</var>. Read all lines to obtain an image in 2D array. <br><br>When it is a <const>C</const>ompressed-bitmap, <var>ln</var> indicates how many lines the encoded image data is split into. Each line has a length of <strong>50</strong>. The last line can be shorter.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Output</div>\n      <div class=\"question-statement-output\">When input is a <const>B</const>itmap, encode the image into quadtree data structure as defined above. When the data string is longer than 50, split the output data into <strong>50</strong> characters per line. Two regular header lines of <const>C</const>ompressed-bitmap input are needed. Refer to the Input description.<br><br>When input is a <const>C</const>ompressed-bitmap, decode the data into 2D array of image data. Use dot <const>.</const> for white pixels. Use <const>#</const> for black pixels. Two regular header lines of <const>B</const>itmap input are needed. Refer to the input description.<br><br>Because input and output have compatible data structures, it is possible to re-inject an output data to the same program to obtain the original input data.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Constraints</div>\n      <div class=\"question-statement-constraints\">1 &le; <var>c</var>,<var>r</var>,<var>ln</var> &le; 500</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Example</div>\n      <div class=\"statement-inout\">\n         <div class=\"statement-inout-in\">\n            <div class=\"title\">Input</div>\n            <pre class=\"question-statement-example-in\">B 5 4\n4\n....#\n...#.\n#.#..\n.#...</pre>\n         </div>\n         <div class=\"statement-inout-out\">\n            <div class=\"title\">Output</div>\n            <pre class=\"question-statement-example-out\">C 5 4\n1\n+0+0110++101+0100</pre>\n         </div>\n      </div>\n   </div>\n</div>"
  },
  "validatedFor": 42113724045,
  "avatar": 13281799951852,
  "commentCount": 10,
  "upVotes": 6,
  "downVotes": 0,
  "validateAction": {
    "actionId": 1003454,
    "progress": 1,
    "alreadyDone": false
  },
  "statusHistory": [
    {
      "status": "ACCEPTED",
      "date": 1728614921000,
      "data": {
        "author": "ACTION"
      }
    }
  ],
  "editable": true,
  "draft": false,
  "readyForModeration": true
}