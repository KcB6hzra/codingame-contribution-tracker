{
  "id": 1743,
  "activeVersion": 9,
  "score": 15,
  "votableId": 9252657,
  "codingamerId": 301922,
  "views": 399,
  "commentableId": 9186745,
  "title": "2-player game on a calculator",
  "status": "ACCEPTED",
  "type": "PUZZLE_INOUT",
  "nickname": "tyrcho",
  "publicHandle": "17435fbcbd168dff9dc70dd2d58129f34785",
  "codingamerHandle": "e30e2eaed69f0747e8826dbf32015ea1229103",
  "lastVersion": {
    "version": 9,
    "autocloseTime": 1543960146009,
    "data": {
      "title": "2-player game on a calculator",
      "topics": [
        {
          "id": 60,
          "handle": "dynamic-programming",
          "labelMap": {
            "1": "Programmation dynamique",
            "2": "Dynamic programming"
          },
          "pageTitle": "Dynamic programming: exercises and theory",
          "puzzleCount": 5,
          "parentTopicId": 41,
          "contentDetailsId": 85
        }
      ],
      "solution": "import scala.collection.mutable\r\nimport Board._\r\n\r\nobject Solution extends App {\r\n    val n = readInt\r\n    println( WinningMoves(n).winningMoves.toList.sorted.mkString(\" \"))\r\n}\r\n\r\ncase class Board(nextPlayer: Boolean = true,\r\n                 remaining: Int = 40,\r\n                 lastMove: Option[Move] = None\r\n                ) {\r\n\r\n  def play(move: Move): Board =\r\n    copy(\r\n      remaining = remaining - move.position,\r\n      nextPlayer = !nextPlayer,\r\n      lastMove = Some(move)\r\n    )\r\n\r\n  def winner: Option[Boolean] =\r\n    if (remaining >= 0) None\r\n    else Some(nextPlayer)\r\n\r\n  def possibleMoves: List[Move] =\r\n    lastMove match {\r\n      case Some(Move(v)) => adjacentMoves(v)\r\n      case None => List.tabulate(10)(Move.apply)\r\n    }\r\n}\r\n\r\nobject Board {\r\n  val adjacents = Vector(\r\n    List.tabulate(9)(1.+),\r\n    List(2, 4, 5),\r\n    List(1, 3, 4, 5, 6),\r\n    List(2, 5, 6),\r\n    List(1, 2, 5, 7, 8),\r\n    List(1, 2, 3, 4, 6, 7, 8, 9),\r\n    List(2, 3, 5, 8, 9),\r\n    List(4, 5, 8),\r\n    List(4, 5, 6, 7, 9),\r\n    List(5, 6, 8)\r\n  )\r\n\r\n  val adjacentMoves: Vector[List[Move]] = adjacents.map(l => l.map(Move.apply))\r\n}\r\n\r\ncase class Move(position: Int)\r\n\r\n\r\nobject WinningMoves {\r\n\r\n  val cache = mutable.Map(0 -> AnalyzedState(0, Set.empty))\r\n\r\n  def apply(remaining: Int): AnalyzedState =\r\n    cache.getOrElseUpdate(remaining, genNext(remaining))\r\n\r\n  private def genNext(remaining: Int): AnalyzedState = {\r\n    val winningMoves =\r\n      for {\r\n        move <- 1 to (remaining min 9)\r\n        previousState = apply(remaining - move)\r\n        previousMoves = 1 to (previousState.remaining min 9)\r\n        adj           = Board.adjacents(move)\r\n        if !previousMoves.exists(m => adj.contains(m) && previousState.winningMoves(m))\r\n      } yield move\r\n    AnalyzedState(remaining, winningMoves.toSet)\r\n  }\r\n\r\n  case class AnalyzedState(remaining: Int, winningMoves: Set[Int])\r\n}\r\n",
      "statement": "A number [[N]] is displayed on the calculator. \n\nFirst player picks a digit d between 1 and 9.\n[[N]] is replaced by [[N]] - d.\nSecond player does the same thing, but has to choose a key which is adjacent to the last one (but not the same one, you cannot repeat the digit select by the opponent).\nRepeat until one player gets a negative number. He lost !\n\nFor example, we start with [[N]] =  20.\n\n`7  8  9` \n`4  5  6` \n`1  2  3` \nFirst player can pick any digit and hits 8.\n[[N]] becomes 12.\n\n`7  x  9` \n`4  5  6` \n`*  *  *` \nSecond player can pick 4, 5, 6, 7 or 9. He picks 9\n[[N]] becomes 3.\n\n`*  8  x` \n`*  5  6` \n`*  *  *` \nFirst player can pick 5, 6 or 8. He picks 5.\n[[N]] becomes -2.\nFirst player has lost this game.\n\nYour job is to find all winning moves in a starting situation.\n\nExamples:\n- if [[N]] = 1, then 1 is the only winning move (getting to 0 makes the other player lose since he will have to make [[N]] negative on his turn).\n- if [[N]] = 8, then 5 is NOT a winning move (since second player can reply with 3).\n\nNote: detailed specification of what is \"near\".\n\nWhen 1 was selected, then 2, 4 or 5 can be selected.\nWhen 2 was selected, then 1, 3, 4, 5 or 6 can be selected.\nWhen 3 was selected, then 2, 5 or 6 can be selected.\nWhen 4 was selected, then 1, 2, 5, 7, or 8 can be selected.\nWhen 5 was selected, then 1, 2, 3, 4, 6, 7, 8 or 9 can be selected.\nWhen 6 was selected, then 2, 3, 5, 8 or 9 can be selected.\nWhen 7 was selected, then 4, 5 or 8 can be selected.\nWhen 8 was selected, then 4, 5, 6, 7 or 9 can be selected.\nWhen 9 was selected, then 5, 6, or 8 can be selected.",
      "testCases": [
        {
          "title": "Test 1",
          "isTest": true,
          "testIn": "2",
          "testOut": "1 2",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 1",
          "isTest": false,
          "testIn": "1",
          "testOut": "1",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 2",
          "isTest": true,
          "testIn": "9",
          "testOut": "1 7 8 9",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 2",
          "isTest": false,
          "testIn": "8",
          "testOut": "7 8",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 3",
          "isTest": true,
          "testIn": "35",
          "testOut": "1 3 7",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 3",
          "isTest": false,
          "testIn": "18",
          "testOut": "1 3",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 4",
          "isTest": true,
          "testIn": "256",
          "testOut": "1 3 7 9",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 4",
          "isTest": false,
          "testIn": "138",
          "testOut": "1 3 7 9",
          "isValidator": true,
          "needValidation": true
        }
      ],
      "difficulty": "medium",
      "constraints": "0 < [[N]] < 1000",
      "stubGenerator": "read N:int\r\nwrite answer",
      "inputDescription": "<<Line 1 :>> An integer [[N]] : the starting number",
      "solutionLanguage": "Scala",
      "outputDescription": "<<Line 1 :>> 0 to 9 integers, separated with spaces, from lowest to highest. These are the winning moves when playing first and [[N]] is the starting number"
    },
    "draft": false,
    "readyForModeration": true,
    "statementHTML": "<div class=\"statement-body\">\n<div class=\"statement-section statement-goal\">\n   <h2><span class=\"icon icon-goal\">&nbsp;</span><span>Goal </span></h2>\n   <span class=\"question-statement\">A number <var>N</var> is displayed on the calculator. <br><br>First player picks a digit d between 1 and 9.<br><var>N</var> is replaced by <var>N</var> - d.<br>Second player does the same thing, but has to choose a key which is adjacent to the last one (but not the same one, you cannot repeat the digit select by the opponent).<br>Repeat until one player gets a negative number. He lost !<br><br>For example, we start with <var>N</var> =  20.<br><br><pre style=\"font-family: monospace\">7  8  9</pre> <br><pre style=\"font-family: monospace\">4  5  6</pre> <br><pre style=\"font-family: monospace\">1  2  3</pre> <br>First player can pick any digit and hits 8.<br><var>N</var> becomes 12.<br><br><pre style=\"font-family: monospace\">7  x  9</pre> <br><pre style=\"font-family: monospace\">4  5  6</pre> <br><pre style=\"font-family: monospace\">*  *  *</pre> <br>Second player can pick 4, 5, 6, 7 or 9. He picks 9<br><var>N</var> becomes 3.<br><br><pre style=\"font-family: monospace\">*  8  x</pre> <br><pre style=\"font-family: monospace\">*  5  6</pre> <br><pre style=\"font-family: monospace\">*  *  *</pre> <br>First player can pick 5, 6 or 8. He picks 5.<br><var>N</var> becomes -2.<br>First player has lost this game.<br><br>Your job is to find all winning moves in a starting situation.<br><br>Examples:<br>- if <var>N</var> = 1, then 1 is the only winning move (getting to 0 makes the other player lose since he will have to make <var>N</var> negative on his turn).<br>- if <var>N</var> = 8, then 5 is NOT a winning move (since second player can reply with 3).<br><br>Note: detailed specification of what is &quot;near&quot;.<br><br>When 1 was selected, then 2, 4 or 5 can be selected.<br>When 2 was selected, then 1, 3, 4, 5 or 6 can be selected.<br>When 3 was selected, then 2, 5 or 6 can be selected.<br>When 4 was selected, then 1, 2, 5, 7, or 8 can be selected.<br>When 5 was selected, then 1, 2, 3, 4, 6, 7, 8 or 9 can be selected.<br>When 6 was selected, then 2, 3, 5, 8 or 9 can be selected.<br>When 7 was selected, then 4, 5 or 8 can be selected.<br>When 8 was selected, then 4, 5, 6, 7 or 9 can be selected.<br>When 9 was selected, then 5, 6, or 8 can be selected.</span>\n</div>\n<div class=\"statement-section statement-protocol\">\n   <div class=\"blk\">\n      <div class=\"title\">Input</div>\n      <div class=\"question-statement-input\"><strong>Line 1 :</strong> An integer <var>N</var> : the starting number</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Output</div>\n      <div class=\"question-statement-output\"><strong>Line 1 :</strong> 0 to 9 integers, separated with spaces, from lowest to highest. These are the winning moves when playing first and <var>N</var> is the starting number</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Constraints</div>\n      <div class=\"question-statement-constraints\">0 &lt; <var>N</var> &lt; 1000</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Example</div>\n      <div class=\"statement-inout\">\n         <div class=\"statement-inout-in\">\n            <div class=\"title\">Input</div>\n            <pre class=\"question-statement-example-in\">2</pre>\n         </div>\n         <div class=\"statement-inout-out\">\n            <div class=\"title\">Output</div>\n            <pre class=\"question-statement-example-out\">1 2</pre>\n         </div>\n      </div>\n   </div>\n</div>"
  },
  "validatedFor": 229081024716,
  "avatar": 1742081719876,
  "commentCount": 22,
  "upVotes": 15,
  "downVotes": 0,
  "validateAction": {
    "actionId": 280344,
    "progress": 1,
    "alreadyDone": false
  },
  "statusHistory": [],
  "editable": true,
  "draft": false,
  "readyForModeration": true
}