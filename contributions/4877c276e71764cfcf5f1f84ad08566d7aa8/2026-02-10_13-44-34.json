{
  "id": 4877,
  "activeVersion": 32,
  "score": 6,
  "votableId": 12745127,
  "codingamerId": 3022016,
  "views": 367,
  "commentableId": 12669300,
  "title": "Futoshiki Solver",
  "status": "ACCEPTED",
  "type": "PUZZLE_INOUT",
  "nickname": "Sundiver",
  "publicHandle": "4877c276e71764cfcf5f1f84ad08566d7aa8",
  "codingamerHandle": "a4d5c1786311a05772d1b2f5dadac78e6102203",
  "lastVersion": {
    "version": 32,
    "autocloseTime": 1590576627083,
    "data": {
      "title": "Futoshiki Solver",
      "topics": [
        {
          "id": 56,
          "handle": "backtracking",
          "labelMap": {
            "1": "Retour sur trace",
            "2": "Backtracking"
          },
          "pageTitle": "Backtracking: exercises and theory",
          "puzzleCount": 8,
          "parentTopicId": 41,
          "contentDetailsId": 80
        }
      ],
      "solution": "enum class Dir(val coords: Pair<Int, Int>) {\n    U(-1 to 0),\n    D(1 to 0),\n    L(0 to -1),\n    R(0 to 1)\n}\n\nvar board: Array<Array<Int>> = arrayOf()\nvar gs: Map<Pair<Int, Int>, List<Dir>> = mutableMapOf()\nfun main() {\n    parseInput(readInput())\n    solve()\n    println(board.map { it.joinToString(\"\") }.joinToString(\"\\n\"))\n}\n\nfun readInput(): List<String> = List(readLine()!!.toInt()) { readLine()!! }\n\nfun parseInput(input: List<String>) {\n    board = (0..input.lastIndex step 2).map { input[it] }\n        .map { (0..it.lastIndex step 2).map { c -> (it[c] - 48).toInt() }.toTypedArray() }\n        .toTypedArray()\n    gs = (0 until input.size).flatMap { i ->\n        (1..input.size step 2).map { it - (i % 2) }.filter { it < input.size }.filter { j -> input[i][j] != ' ' }\n            .map { j ->\n                when (input[i][j]) {\n                    '^' -> ((i + 1) / 2 to j / 2) to Dir.U\n                    'v' -> (i / 2 to j / 2) to Dir.D\n                    '<' -> (i / 2 to (j + 1) / 2) to Dir.L\n                    '>' -> (i / 2 to j / 2) to Dir.R\n                    else -> error(\"illegal input\")\n                }\n            }\n    }.groupBy { pair: Pair<Pair<Int, Int>, Dir> -> pair.first }\n        .map { entry -> entry.key to entry.value.map { it.second } }.toMap()\n}\n\n\nfun solve(): Boolean {\n    val next = `next free cell`() ?: return true\n    for (i in 1..board.size) {\n        if (valid(next, i)) {\n            board[next.first][next.second] = i\n            if (solve()) return true\n            board[next.first][next.second] = 0\n        }\n    }\n    return false\n}\n\noperator fun Pair<Int, Int>.plus(other: Pair<Int, Int>) = first + other.first to second + other.second\noperator fun Array<Array<Int>>.invoke(idx: Pair<Int, Int>) = this[idx.first][idx.second]\n\nfun valid(coords: Pair<Int, Int>, n: Int): Boolean {\n    for (i in board.indices) {\n        if (board(coords.first to i) == n || board(i to coords.second) == n) return false\n    }\n    gs.getOrDefault(coords, listOf()).any { direction -> n < board(coords + direction.coords) }\n        .also { if (it) return false }\n    if (listOf(Dir.U to Dir.D, Dir.D to Dir.U, Dir.R to Dir.L, Dir.L to Dir.R)\n            .any { dirs ->\n                gs.getOrDefault(coords + dirs.first.coords, emptyList())\n                    .contains(dirs.second) && board(coords + dirs.first.coords) < n && board(coords + dirs.first.coords) != 0\n            }\n    ) return false\n\n    return true\n}\n\nfun `next free cell`(): Pair<Int, Int>? {\n    (0..board.lastIndex).forEach { y -> (0..board.lastIndex).forEach { x -> if (board(y to x) == 0) return y to x } }\n    return null\n}",
      "statement": "Futoshiki is a Japanese numeric logic puzzle similar to the more popular Sudoku.\nSee https://en.wikipedia.org/wiki/Futoshiki\nLike in Sudoku, in a Futoshiki of size n every row and every column must contain every number from 1 to n.\nUnlike Sudoku there may be greater than / less than relations between cells.\n\nFor a n×n Futoshiki the input will be 2n-1 lines of digits {{0..n}} ({{0}} meaning empty), and either spaces or inequality constraints {{^}} {{v}} {{<}} {{>}} separating the digits of length 2n-1.\n\n{{^}} meaning the cell below the symbol has a higher value than the one above the symbol and so on.\n\n\n<<Example:>> A 2×2 Futoshiki\n```0>0\nv ^\n0<0```having the solution:\n```21\n12```",
      "testCases": [
        {
          "title": "No comparisons",
          "isTest": true,
          "testIn": "3\n1 0\n   \n0 0",
          "testOut": "12\n21",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "No comparisons",
          "isTest": false,
          "testIn": "3\n0 1\n   \n0 0",
          "testOut": "21\n12",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "Comparisons only horizontal",
          "isTest": true,
          "testIn": "3\n0>0\n   \n0<0",
          "testOut": "21\n12",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "Comparisons only horizontal",
          "isTest": false,
          "testIn": "3\n0<0\n   \n0>0",
          "testOut": "12\n21",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "Comparisons only vertical",
          "isTest": true,
          "testIn": "3\n0 0\n^ v\n0 0",
          "testOut": "12\n21",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "Comparisons only vertical",
          "isTest": false,
          "testIn": "3\n0 0\nv ^\n0 0",
          "testOut": "21\n12",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "5x5",
          "isTest": true,
          "testIn": "9\n0>3 5 1 0\n         \n0 2 0 5 0\n        ^\n0 0 0 0 0\n         \n0 5 0 3 0\n         \n0 4 3 2<0",
          "testOut": "43512\n32451\n51243\n25134\n14325",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "5x5",
          "isTest": false,
          "testIn": "9\n0 0 0 0 0\n^        \n4 5 0 3 2\n         \n0 4 0 5 0\n         \n1 3 0 2 5\n         \n0 0 0>0 0",
          "testOut": "21543\n45132\n34251\n13425\n52314",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "7x7",
          "isTest": true,
          "testIn": "13\n0 3 0>0 0 5 0\n        v   ^\n0 0 0 0 0 0 0\n  ^          \n4 5 0>0 0 2 7\n      v      \n0 0 0 0 0 0 0\n    v       v\n2 6 0 0 0 1 3\n            ^\n0 0 0 0 0 0 0\n             \n0 2 0 0<0 3<0",
          "testOut": "7342651\n6134572\n4563127\n3471265\n2657413\n1725346\n5216734",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "7x7",
          "isTest": false,
          "testIn": "13\n0>0>0 0>0 0>0\n    v ^     v\n0 7 0 0>0 0 0\nv            \n0>0 6>0 0 0 4\n             \n0 4 0 0 0 5 0\n             \n7 0>0>0 3 0 0\n        v    \n0 0<0<0 0 1 0\n             \n0 0<0 0 0 0<0",
          "testOut": "6542173\n5716432\n3165724\n2473651\n7621345\n4357216\n1234567",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "More 5x5",
          "isTest": true,
          "testIn": "9\n0 0<0 0<0\n    ^    \n0 0>0 0 0\n         \n0 0 0 0 0\n         \n0<0 0 0 0\nv ^      \n0 0 0<0<0",
          "testOut": "51324\n35412\n42153\n23541\n14235",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "More 5x5",
          "isTest": false,
          "testIn": "9\n0>0 0 0 3\n         \n0 0>0<0 0\n         \n0 0 0<0>0\n      ^ v\n0>0 0 0 0\n^        \n0 0>0 0 0",
          "testOut": "41523\n24135\n15342\n32451\n53214",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "4x4",
          "isTest": true,
          "testIn": "7\n0 0<3<0\n       \n0 0 0 0\n^      \n0>0 0 0\n^      \n0 0 0<0",
          "testOut": "2134\n1423\n3241\n4312",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "4x4",
          "isTest": false,
          "testIn": "7\n0 0 0<0\n       \n0 0<0 0\n       \n0 1 0 0\nv      \n0>0 0 0",
          "testOut": "1423\n2341\n4132\n3214",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "6x6",
          "isTest": true,
          "testIn": "11\n6 0 0 0 0 2\n           \n0 5 2 4 3 0\n        v  \n0 0 0 0 0 0\n^          \n0 0 0 0 0 0\n           \n0 2 1 3 6 0\n  ^        \n3 0 0 0 0 5",
          "testOut": "613542\n152436\n245613\n436251\n521364\n364125",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "6x6",
          "isTest": false,
          "testIn": "11\n5 6 3 2 1 4\n           \n0 0 0 0 0 0\n    ^ ^   v\n0 0 0 0 0 0\n  v     v  \n0 0 0<0 0 0\n          ^\n0 0 0 0 0 0\nv   ^      \n3 1 4 6 2 5",
          "testOut": "563214\n145362\n236451\n621543\n452136\n314625",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "More 6x6",
          "isTest": true,
          "testIn": "11\n0 1 0 0<4 0\n^         ^\n0 0 0 0 0 0\n           \n0>5 4 1 2 0\n           \n0 6 3 4 5 0\n    v      \n0 0 0 0 0 0\n           \n0 2>0 0 6 0",
          "testOut": "216345\n435216\n654123\n163452\n542631\n321564",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "More 6x6",
          "isTest": false,
          "testIn": "11\n0 2 4 5 6 0\n           \n0 0 0 0 0 0\n    v      \n1 0 0 0 0 6\n           \n6 0 0<0 0 3\n          v\n0 0 0 0 0 0\n           \n0 4 6 1 3 0",
          "testOut": "324561\n513624\n132456\n651243\n465312\n246135",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "3x3",
          "isTest": true,
          "testIn": "5\n0>0>0\nv    \n0 0 0\nv    \n0 0 0",
          "testOut": "321\n213\n132",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "3x3",
          "isTest": false,
          "testIn": "5\n0<0<0\n^    \n0 0 0\n^    \n0 0 0",
          "testOut": "123\n231\n312",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "1x1",
          "isTest": true,
          "testIn": "1\n0",
          "testOut": "1",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "1x1",
          "isTest": false,
          "testIn": "1\n1",
          "testOut": "1",
          "isValidator": true,
          "needValidation": false
        }
      ],
      "difficulty": "medium",
      "constraints": "There is only 1 correct solution to each board.\n1 ≤ [[size]] ≤ 13",
      "coverBinaryId": 41005407266049,
      "stubGenerator": "read size:int\nloop size read line:string(256)\nwrite answer",
      "inputDescription": "<<Line 1:>> number [[size]] of lines to read\n<<Next [[size]] lines:>>\n<< - even-numbered lines:>> string of length [[size]] alternating between a number {{0..n}} and a space or {{<}} or {{>}}.\n<< - odd-numbered lines:>> string of length [[size]] containing spaces and {{v}} or {{^}} on even-numbered positions and spaces on odd-numbered positions.",
      "solutionLanguage": "Kotlin",
      "outputDescription": "<<[[n]] lines:>> [[n]] digits for each row of the solved board\n(for [[n]] such that [[size]] = 2×[[n]] - 1)"
    },
    "draft": false,
    "readyForModeration": true,
    "statementHTML": "<div class=\"statement-body\">\n<div class=\"statement-section statement-goal\">\n   <h2><span class=\"icon icon-goal\">&nbsp;</span><span>Goal </span></h2>\n   <span class=\"question-statement\">Futoshiki is a Japanese numeric logic puzzle similar to the more popular Sudoku.<br>See https://en.wikipedia.org/wiki/Futoshiki<br>Like in Sudoku, in a Futoshiki of size n every row and every column must contain every number from 1 to n.<br>Unlike Sudoku there may be greater than / less than relations between cells.<br><br>For a n&times;n Futoshiki the input will be 2n-1 lines of digits <const>0..n</const> (<const>0</const> meaning empty), and either spaces or inequality constraints <const>^</const> <const>v</const> <const>&lt;</const> <const>&gt;</const> separating the digits of length 2n-1.<br><br><const>^</const> meaning the cell below the symbol has a higher value than the one above the symbol and so on.<br><br><br><strong>Example:</strong> A 2&times;2 Futoshiki<br><pre style=\"font-family: monospace\"></pre><pre style=\"font-family: monospace\">0&gt;0<br>v ^<br>0&lt;0</pre><pre style=\"font-family: monospace\"></pre>having the solution:<br><pre style=\"font-family: monospace\"></pre><pre style=\"font-family: monospace\">21<br>12</pre><pre style=\"font-family: monospace\"></pre></span>\n</div>\n<div class=\"statement-section statement-protocol\">\n   <div class=\"blk\">\n      <div class=\"title\">Input</div>\n      <div class=\"question-statement-input\"><strong>Line 1:</strong> number <var>size</var> of lines to read<br><strong>Next <var>size</var> lines:</strong><br><strong> - even-numbered lines:</strong> string of length <var>size</var> alternating between a number <const>0..n</const> and a space or <const>&lt;</const> or <const>&gt;</const>.<br><strong> - odd-numbered lines:</strong> string of length <var>size</var> containing spaces and <const>v</const> or <const>^</const> on even-numbered positions and spaces on odd-numbered positions.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Output</div>\n      <div class=\"question-statement-output\"><strong><var>n</var> lines:</strong> <var>n</var> digits for each row of the solved board<br>(for <var>n</var> such that <var>size</var> = 2&times;<var>n</var> - 1)</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Constraints</div>\n      <div class=\"question-statement-constraints\">There is only 1 correct solution to each board.<br>1 &le; <var>size</var> &le; 13</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Example</div>\n      <div class=\"statement-inout\">\n         <div class=\"statement-inout-in\">\n            <div class=\"title\">Input</div>\n            <pre class=\"question-statement-example-in\">3\n1 0\n   \n0 0</pre>\n         </div>\n         <div class=\"statement-inout-out\">\n            <div class=\"title\">Output</div>\n            <pre class=\"question-statement-example-out\">12\n21</pre>\n         </div>\n      </div>\n   </div>\n</div>"
  },
  "validatedFor": 180934272442,
  "avatar": 31016387398299,
  "commentCount": 21,
  "upVotes": 8,
  "downVotes": 2,
  "validateAction": {
    "actionId": 454571,
    "progress": 1,
    "alreadyDone": false
  },
  "statusHistory": [
    {
      "status": "REFUSED",
      "date": 1585580737004,
      "data": {
        "author": "SYSTEM",
        "reason": "INACTIVITY"
      }
    },
    {
      "status": "PENDING",
      "date": 1587984627083,
      "data": {
        "author": "ACTION",
        "reason": "EDIT"
      }
    },
    {
      "status": "ACCEPTED",
      "date": 1589796800272,
      "data": {
        "author": "ACTION"
      }
    }
  ],
  "editable": true,
  "draft": false,
  "readyForModeration": true
}