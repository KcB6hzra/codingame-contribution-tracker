{
  "id": 2151,
  "activeVersion": 32,
  "score": 8,
  "votableId": 10404056,
  "codingamerId": 270881,
  "views": 459,
  "commentableId": 10334692,
  "title": "Discrete Log Problem",
  "status": "ACCEPTED",
  "type": "PUZZLE_INOUT",
  "nickname": "Maurice_Moss",
  "publicHandle": "2151235757c7e95807b21332e9d9abdbe484",
  "codingamerHandle": "de015f1a510d60cdcd0551896a34c709188072",
  "lastVersion": {
    "version": 32,
    "autocloseTime": 1557596116477,
    "data": {
      "title": "Discrete Log Problem",
      "topics": [
        {
          "id": 74,
          "handle": "cryptology",
          "labelMap": {
            "1": "Cryptologie",
            "2": "Cryptography"
          },
          "pageTitle": "Cryptography: exercises and theory",
          "puzzleCount": 7,
          "parentTopicId": 43,
          "contentDetailsId": 105
        },
        {
          "id": 105,
          "handle": "modular-calculus",
          "labelMap": {
            "1": "Modular calculus",
            "2": "Modular calculus"
          },
          "puzzleCount": 0,
          "parentTopicId": 93
        }
      ],
      "solution": "import sys\r\nimport math\r\nimport time\r\n    \r\ndef bsgs(a, c, P):\r\n    \r\n    N = math.ceil(math.sqrt(P - 1))\r\n\r\n    memo = {}\r\n    ai = 1\r\n    for i in range(N):\r\n        memo[ai] = i\r\n        ai = (a*ai) % P\r\n\r\n    d = pow(a, N * (P - 2), P)     # https://en.wikipedia.org/wiki/Modular_multiplicative_inverse#Using_Euler.27s_theorem\r\n\r\n    for j in range(N):\r\n        y = (c * pow(d, j, P)) % P\r\n        if y in memo:\r\n            return j * N + memo[y]\r\n\r\n    return None\r\n\r\ng, h, q = [int(x) for x in input().split()] \r\n\r\ns = time.time()\r\n\r\nprint(bsgs(g, h, q))\r\n\r\nprint(time.time()-s, file=sys.stderr)",
      "statement": "ElGamal encryption is a public-key cryptosystem. It uses asymmetric key encryption for a safe communication between two people.\n\nLet us assume that Alice wants to communicate with Bob. Alice generates three large random integers:\n- [[Q]] a prime used as the order of the key\n- 0 < [[G]] < [[Q]] a generator\n- [[X]] Alice's secret key\n\nAlice computes [[H]] = [[G]]^[[X]] mod [[Q]] and <<publicly>> shares with Bob the public key ([[G]], [[H]], [[Q]]). As an attacker, you intercept this key and decide to spy on their communications. To do so, you need to find Alice's secret key [[X]]. This can be done by performing a discrete logarithm attack on this key. \n\nGiven the public key ([[G]], [[H]], [[Q]]), you are asked to perform this attack: find the <<lowest integer>> [[X]] such that [[G]]^[[X]] mod [[Q]] = [[H]].\n\nThe rest of this protocol is not explained to avoid overload but it can be found on https://en.wikipedia.org/wiki/ElGamal_encryption",
      "testCases": [
        {
          "title": "Test 1",
          "isTest": true,
          "testIn": "654 4547 11087",
          "testOut": "114",
          "isValidator": false
        },
        {
          "title": "Validator 1",
          "isTest": false,
          "testIn": "1020 3606 8669",
          "testOut": "479",
          "isValidator": true
        },
        {
          "title": "Test 2",
          "isTest": true,
          "testIn": "253941 1587010 2450219",
          "testOut": "15331",
          "isValidator": false
        },
        {
          "title": "Validator 2",
          "isTest": false,
          "testIn": "214063 425777 2580931",
          "testOut": "240766",
          "isValidator": true
        },
        {
          "title": "Test 3",
          "isTest": true,
          "testIn": "59930016 465179611 618142807",
          "testOut": "36249002",
          "isValidator": false
        },
        {
          "title": "Validator 3",
          "isTest": false,
          "testIn": "59077273 55836967 798117841",
          "testOut": "3057385",
          "isValidator": true
        },
        {
          "title": "Test 4",
          "isTest": true,
          "testIn": "303566540 5272582361 11123061581",
          "testOut": "100529399",
          "isValidator": false
        },
        {
          "title": "Validator 4",
          "isTest": false,
          "testIn": "8695125 3578996660 10172997949",
          "testOut": "607661655",
          "isValidator": true
        },
        {
          "title": "Big test",
          "isTest": true,
          "testIn": "49999999961 42 49999999967",
          "testOut": "23150749045",
          "isValidator": false
        },
        {
          "title": "Validator 7",
          "isTest": false,
          "testIn": "47922073590 23974922857 49999999961",
          "testOut": "24968866860",
          "isValidator": true
        },
        {
          "title": "Yet another big test",
          "isTest": true,
          "testIn": "42444879370 30224410788 49999999823",
          "testOut": "49994563227",
          "isValidator": false
        },
        {
          "title": "Validator 8",
          "isTest": false,
          "testIn": "31837007461 13873964466 49999999853",
          "testOut": "49998103452",
          "isValidator": true
        }
      ],
      "difficulty": "hard",
      "constraints": "1 < [[G]], [[H]] < [[Q]]\n1 < [[X]] < [[Q]]-1.\n0 < [[Q]] < 50.000.000.000",
      "stubGenerator": "read G:long H:long Q:long\nwrite X\n",
      "inputDescription": "<<Line 1:>> The public key ([[G]], [[H]], [[Q]])",
      "solutionLanguage": "Python3",
      "outputDescription": "<<Line 1:>> Alice's private key [[X]]."
    },
    "draft": false,
    "readyForModeration": true,
    "statementHTML": "<div class=\"statement-body\">\n<div class=\"statement-section statement-goal\">\n   <h2><span class=\"icon icon-goal\">&nbsp;</span><span>Goal </span></h2>\n   <span class=\"question-statement\">ElGamal encryption is a public-key cryptosystem. It uses asymmetric key encryption for a safe communication between two people.<br><br>Let us assume that Alice wants to communicate with Bob. Alice generates three large random integers:<br>- <var>Q</var> a prime used as the order of the key<br>- 0 &lt; <var>G</var> &lt; <var>Q</var> a generator<br>- <var>X</var> Alice's secret key<br><br>Alice computes <var>H</var> = <var>G</var>^<var>X</var> mod <var>Q</var> and <strong>publicly</strong> shares with Bob the public key (<var>G</var>, <var>H</var>, <var>Q</var>). As an attacker, you intercept this key and decide to spy on their communications. To do so, you need to find Alice's secret key <var>X</var>. This can be done by performing a discrete logarithm attack on this key. <br><br>Given the public key (<var>G</var>, <var>H</var>, <var>Q</var>), you are asked to perform this attack: find the <strong>lowest integer</strong> <var>X</var> such that <var>G</var>^<var>X</var> mod <var>Q</var> = <var>H</var>.<br><br>The rest of this protocol is not explained to avoid overload but it can be found on https://en.wikipedia.org/wiki/ElGamal_encryption</span>\n</div>\n<div class=\"statement-section statement-protocol\">\n   <div class=\"blk\">\n      <div class=\"title\">Input</div>\n      <div class=\"question-statement-input\"><strong>Line 1:</strong> The public key (<var>G</var>, <var>H</var>, <var>Q</var>)</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Output</div>\n      <div class=\"question-statement-output\"><strong>Line 1:</strong> Alice's private key <var>X</var>.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Constraints</div>\n      <div class=\"question-statement-constraints\">1 &lt; <var>G</var>, <var>H</var> &lt; <var>Q</var><br>1 &lt; <var>X</var> &lt; <var>Q</var>-1.<br>0 &lt; <var>Q</var> &lt; 50.000.000.000</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Example</div>\n      <div class=\"statement-inout\">\n         <div class=\"statement-inout-in\">\n            <div class=\"title\">Input</div>\n            <pre class=\"question-statement-example-in\">654 4547 11087</pre>\n         </div>\n         <div class=\"statement-inout-out\">\n            <div class=\"title\">Output</div>\n            <pre class=\"question-statement-example-out\">114</pre>\n         </div>\n      </div>\n   </div>\n</div>"
  },
  "validatedFor": 214768185322,
  "avatar": 30069480173944,
  "commentCount": 43,
  "upVotes": 10,
  "downVotes": 2,
  "validateAction": {
    "actionId": 339174,
    "progress": 1,
    "alreadyDone": false
  },
  "denyAction": {
    "actionId": 336239,
    "progress": 0,
    "alreadyDone": false
  },
  "statusHistory": [],
  "editable": true,
  "draft": false,
  "readyForModeration": true
}