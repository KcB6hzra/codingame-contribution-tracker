{
  "id": 4802,
  "activeVersion": 54,
  "score": 39,
  "votableId": 12333191,
  "codingamerId": 1429360,
  "views": 658,
  "commentableId": 12258078,
  "title": "Prime Fractals in Pascal's Triangle",
  "status": "ACCEPTED",
  "type": "PUZZLE_INOUT",
  "nickname": "comp0zr",
  "publicHandle": "48029e7d5a784565c53d734744d9ff7b0592",
  "codingamerHandle": "98eabcb2854b865e9ea54f483118b8c20639241",
  "lastVersion": {
    "version": 54,
    "autocloseTime": 1621990420676,
    "data": {
      "title": "Prime Fractals in Pascal's Triangle",
      "topics": [
        {
          "id": 94,
          "handle": "mathematics",
          "labelMap": {
            "1": "Mathematics",
            "2": "Mathematics"
          },
          "puzzleCount": 21,
          "parentTopicId": 93
        },
        {
          "id": 182,
          "handle": "combinatorics",
          "labelMap": {
            "1": "Combinatorics",
            "2": "Combinatorics"
          },
          "puzzleCount": 4,
          "parentTopicId": 93
        },
        {
          "id": 60,
          "handle": "dynamic-programming",
          "labelMap": {
            "1": "Programmation dynamique",
            "2": "Dynamic programming"
          },
          "pageTitle": "Dynamic programming: exercises and theory",
          "puzzleCount": 15,
          "parentTopicId": 41,
          "contentDetailsId": 85
        },
        {
          "id": 65,
          "handle": "memoization",
          "labelMap": {
            "1": "Mémoïsation",
            "2": "Memoization"
          },
          "pageTitle": "Memoization: exercises and theory",
          "puzzleCount": 8,
          "parentTopicId": 41,
          "contentDetailsId": 76
        },
        {
          "id": 71,
          "handle": "recursion",
          "labelMap": {
            "1": "Récursion",
            "2": "Recursion"
          },
          "pageTitle": "Recursion: exercises and theory",
          "puzzleCount": 14,
          "parentTopicId": 41,
          "contentDetailsId": 77
        }
      ],
      "solution": "#include <bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ULL;\ntypedef long long LL;\n\nconst ULL MAX = 10000000000000000000ULL;\nconst LL MOD = 1000000007;\n\nULL R, C, P;\n\nULL powers[64];\nLL values[64];\n\nmap<pair<ULL, ULL>, LL> memo;\n\nLL Multiply(LL a, LL b, LL mod = MOD)\n{\n    a %= mod;\n    b %= mod;\n \n    LL res = (a * b) % mod;\n\n    return (res < 0) ? res + mod : res;    \n}\n\nLL Solve(int level, ULL R, ULL C)\n{        \n    C = min(R, C);    \n\n    if(level < 0) \n    {\n        return 0;    \n    }            \n    if(memo.count({R, C}))\n    {\n        return memo[{R, C}];\n    }\n\n    LL power = powers[level];\n    LL val = values[level];    \n    LL right = -1;\n    LL res = 0;\n\n    for(ULL i = 1; i <= P; i++)\n    {\n        LL h_mult = min(i, C / power);        \n        LL v_mult = min(i, R / power);\n\n        if(i > v_mult)\n        {               \n            ULL next_row = R - (v_mult * power);\n\n            LL bottom = Multiply(h_mult, Solve(level - 1, next_row, power));\n            \n            if(i > h_mult)\n            {\n                ULL next_col = C - (h_mult * power);\n\n                right = Solve(level - 1, next_row, next_col);\n            }\n            res = (res + bottom + right) % MOD; \n            \n            break;\n        }\n        if(i > h_mult)\n        {            \n            right = (right == -1) \n                  ? Solve(level - 1, power, C - (h_mult * power))\n                  : right;\n\n            res = (res + right) % MOD;\n        }\n        res = (res + Multiply(h_mult, val)) % MOD;\n    }        \n    if(res < 0) res += MOD;\n\n    return memo[{R, C}] = res;\n}\n\nint main()\n{     \n    int t;\n    cin >> t;\n\n    while(t--)\n    {        \n        cin >> P >> R >> C;\n            \n        if(R == 0 || C == 0)\n        {\n            cout << 0 << \"\\n\";\n            continue;\n        }   \n        ULL level = log(MAX) / log(P);\n\n        powers[0] = values[0] = 1;\n\n        for(ULL i = 1; i <= level && (powers[i-1] * P) <= MAX; i++)\n        {\n            powers[i] = (powers[i-1] * P);            \n            values[i] = Multiply(values[i - 1], P * (P + 1) / 2);\n        }                          \n        cout << Solve(level, R, C) << \"\\n\";        \n\n        memo.clear();\n    }    \n    return 0;\n}\n",
      "statement": "<<Pascal's Triangle>> is a famous mathematical structure, in which the binomial coefficients are arranged in a triangular fashion. It is commonly generated recursively by defining the 0'th row/column as 1, padding each subsequent row with two 1's, and applying the recurrence:\n\n<<C(n, k) = C(n-1, k-1) + C(n-1, k)>>\n\n...where [[n]] and [[k]] represent the indices of the the triangle's rows and columns respectively. This produces the following collection of integers for the first few rows:\n`\n[0]|1\n[1]|1 1\n[2]|1 2 1\n[3]|1 3 3 1\n[4]|1 4 6 4 1\n[5]|1 5 10 10 5 1\n[6]|1 6 15 20 15 6 1\netc...\n`\nIn addition to its many practical applications in mathematics, Pascal's triangle also has many unusual and fascinating properties. One of its most intriguing characteristics pertains to divisibility, and can be demonstrated by shading all cells in the triangle that are not divisible by a given number (henceforth referred to as [[P]]). This expands into an infinite fractal pattern that closely resembles the well-known Sierpinski triangle. For example, here are the first 12 rows of the fractal that is formed when <<P = 3>>:\n`\n[01]|# (1)\n[02]|## (2)\n[03]|### (3)\n[04]|#__# (2)\n[05]|##_## (4)\n[06]|###### (6)\n[07]|#__#__# (3)\n[08]|##_##_## (6)\n[09]|######### (9)\n[10]|#________# (2)\n[11]|##_______## (4)\n[12]|###______### (6)\netc...\n`\nGiven three integers [[P]], [[R]], and [[C]], your task is to count the number of shaded cells in the first [[R]] rows and [[C]] columns of the resulting fractal. You can assume that the triangle's values are all left-aligned and displayed in the form of a two-dimensional matrix (as in the example above). As C(n, k) is undefined for k > n, disregard any cells where the column index is greater than the row. As the resulting numbers can be quite massive, print your answer modulo {{1000000007}}.\n\n============================================================================\n\n<<[Example]:>>\n\n<<P = 3>>\n<<R = 12>>\n<<C = 6>>\n`\n[01]|# (1)\n[02]|## (2)\n[03]|### (3)\n[04]|#__# (2)\n[05]|##_## (4)\n[06]|###### (6)\n[07]|#__#__. (2)\n[08]|##_##_.. (4)\n[09]|######... (6)\n[10]|#_____.... (1)\n[11]|##____..... (2)\n[12]|###___...... (3)\n\n('#' -- shaded)\n('_' -- unshaded)\n('.' -- out of bounds)\n`\nResult = (1 + 2 + 3 + 2 + 4 + 6 + 2 + 4 + 6 + 1 + 2 + 3) % 1000000007 = <<36>>",
      "testCases": [
        {
          "title": "Basic",
          "isTest": true,
          "testIn": "11\n3 12 6\n5 47 47\n5 114 114\n13 13 13\n5 3 3\n7 20 20\n13 61 25\n13 12 4\n11 63 27\n5 68 68\n17 43 8",
          "testOut": "36\n555\n2625\n91\n6\n147\n724\n42\n831\n1017\n260",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "Basic",
          "isTest": false,
          "testIn": "11\n13 12 4\n13 13 13\n5 3 3\n3 12 6\n5 47 47\n5 114 114\n17 43 8\n13 61 25\n11 63 27\n5 68 68\n7 20 20",
          "testOut": "42\n91\n6\n36\n555\n2625\n260\n724\n831\n1017\n147",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "R = C (easy)",
          "isTest": true,
          "testIn": "100\n5 87 87\n11 116 116\n17 136 136\n13 93 93\n11 22 22\n7 28 28\n7 60 60\n17 127 127\n3 27 27\n13 137 137\n17 169 169\n11 30 30\n7 131 131\n7 124 124\n5 136 136\n17 3 3\n3 59 59\n17 168 168\n5 57 57\n5 43 43\n11 174 174\n11 120 120\n7 138 138\n7 125 125\n17 171 171\n17 127 127\n5 181 181\n7 74 74\n7 171 171\n13 82 82\n11 126 126\n7 128 128\n7 106 106\n13 130 130\n5 58 58\n3 96 96\n3 146 146\n7 168 168\n7 165 165\n11 151 151\n5 9 9\n3 179 179\n7 185 185\n11 52 52\n7 200 200\n3 61 61\n7 169 169\n5 13 13\n13 187 187\n3 140 140\n11 171 171\n7 179 179\n17 2 2\n17 103 103\n11 93 93\n13 157 157\n5 81 81\n7 42 42\n11 90 90\n13 20 20\n13 130 130\n11 118 118\n11 172 172\n11 76 76\n11 128 128\n11 57 57\n17 154 154\n3 166 166\n13 84 84\n17 25 25\n13 72 72\n7 30 30\n11 20 20\n3 169 169\n13 116 116\n13 150 150\n3 124 124\n7 46 46\n7 52 52\n5 156 156\n17 89 89\n7 29 29\n5 151 151\n5 101 101\n7 165 165\n3 115 115\n17 57 57\n11 92 92\n17 166 166\n11 137 137\n13 152 152\n17 29 29\n17 8 8\n3 122 122\n7 196 196\n17 38 38\n11 194 194\n7 29 29\n11 12 12\n3 130 130",
          "testOut": "1566\n3861\n5508\n2572\n198\n280\n880\n4572\n216\n5313\n8245\n306\n3417\n3036\n3471\n6\n684\n8085\n738\n453\n6126\n4235\n3882\n3108\n8426\n4572\n4827\n1200\n5472\n1981\n4386\n3237\n2442\n5005\n756\n1440\n2844\n5376\n5160\n4968\n35\n4158\n6528\n840\n7890\n711\n5392\n63\n8523\n2664\n5886\n6024\n3\n3220\n2511\n7111\n1418\n588\n2403\n147\n5005\n4026\n5956\n1771\n4412\n1008\n6895\n3912\n2058\n225\n1533\n295\n156\n3951\n3978\n6342\n2040\n658\n796\n3893\n2355\n285\n3829\n2255\n5160\n1812\n1002\n2466\n7795\n4548\n6546\n309\n36\n1968\n7840\n489\n7520\n285\n68\n2256",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "R = C (easy)",
          "isTest": false,
          "testIn": "100\n13 137 137\n17 169 169\n11 30 30\n7 131 131\n7 124 124\n5 43 43\n11 174 174\n11 120 120\n5 136 136\n17 3 3\n3 59 59\n17 168 168\n5 57 57\n7 138 138\n5 87 87\n11 116 116\n17 136 136\n13 93 93\n11 22 22\n7 28 28\n7 60 60\n17 127 127\n3 27 27\n7 106 106\n13 130 130\n5 58 58\n3 96 96\n3 146 146\n7 168 168\n7 165 165\n11 151 151\n5 9 9\n7 125 125\n17 171 171\n17 127 127\n5 181 181\n7 74 74\n7 171 171\n13 82 82\n11 126 126\n7 128 128\n17 103 103\n11 93 93\n13 157 157\n5 81 81\n7 42 42\n11 90 90\n13 20 20\n13 130 130\n7 30 30\n11 20 20\n3 169 169\n13 116 116\n11 128 128\n3 179 179\n7 185 185\n11 52 52\n7 200 200\n3 61 61\n7 169 169\n5 13 13\n13 187 187\n3 140 140\n11 171 171\n7 179 179\n17 2 2\n11 118 118\n11 172 172\n11 76 76\n11 57 57\n17 154 154\n3 166 166\n13 84 84\n17 25 25\n13 72 72\n17 38 38\n11 194 194\n7 29 29\n11 12 12\n3 130 130\n13 150 150\n3 124 124\n7 46 46\n7 52 52\n5 156 156\n17 89 89\n7 165 165\n3 115 115\n17 57 57\n11 92 92\n17 166 166\n11 137 137\n13 152 152\n17 29 29\n17 8 8\n3 122 122\n7 196 196\n7 29 29\n5 151 151\n5 101 101",
          "testOut": "5313\n8245\n306\n3417\n3036\n453\n6126\n4235\n3471\n6\n684\n8085\n738\n3882\n1566\n3861\n5508\n2572\n198\n280\n880\n4572\n216\n2442\n5005\n756\n1440\n2844\n5376\n5160\n4968\n35\n3108\n8426\n4572\n4827\n1200\n5472\n1981\n4386\n3237\n3220\n2511\n7111\n1418\n588\n2403\n147\n5005\n295\n156\n3951\n3978\n4412\n4158\n6528\n840\n7890\n711\n5392\n63\n8523\n2664\n5886\n6024\n3\n4026\n5956\n1771\n1008\n6895\n3912\n2058\n225\n1533\n489\n7520\n285\n68\n2256\n6342\n2040\n658\n796\n3893\n2355\n5160\n1812\n1002\n2466\n7795\n4548\n6546\n309\n36\n1968\n7840\n285\n3829\n2255",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "R = C (medium)",
          "isTest": true,
          "testIn": "100\n5 930887 930887\n11 636916 636916\n17 238336 238336\n13 760493 760493\n11 641422 641422\n7 490028 490028\n7 520060 520060\n17 513927 513927\n3 383427 383427\n13 455737 455737\n17 595369 595369\n11 956430 956430\n7 21531 21531\n7 665124 665124\n5 703136 703136\n17 979803 979803\n3 723059 723059\n17 898168 898168\n5 18457 18457\n5 478043 478043\n11 377374 377374\n11 544920 544920\n7 898538 898538\n7 594325 594325\n17 664371 664371\n17 803527 803527\n5 268981 268981\n7 241874 241874\n7 999171 999171\n13 497282 497282\n11 420926 420926\n7 336328 336328\n7 126506 126506\n13 621730 621730\n5 925858 925858\n3 353896 353896\n3 100546 100546\n7 233368 233368\n7 990365 990365\n11 313751 313751\n5 426809 426809\n3 947179 947179\n7 393585 393585\n11 502652 502652\n7 612400 612400\n3 95061 95061\n7 993369 993369\n5 210013 210013\n13 698587 698587\n3 297540 297540\n11 480571 480571\n7 960379 960379\n17 66602 66602\n17 612903 612903\n11 570493 570493\n13 260757 260757\n5 560281 560281\n7 209442 209442\n11 429690 429690\n13 346620 346620\n13 744730 744730\n11 108118 108118\n11 905772 905772\n11 890676 890676\n11 698928 698928\n11 777857 777857\n17 872354 872354\n3 276966 276966\n13 964684 964684\n17 28625 28625\n13 332872 332872\n7 48830 48830\n11 530020 530020\n3 363369 363369\n13 486716 486716\n13 518150 518150\n3 700724 700724\n7 2246 2246\n7 493452 493452\n5 243556 243556\n17 597489 597489\n7 888229 888229\n5 792351 792351\n5 441501 441501\n7 87765 87765\n3 324915 324915\n17 275857 275857\n11 346492 346492\n17 148366 148366\n11 281937 281937\n13 452552 452552\n17 899229 899229\n17 975408 975408\n3 276122 276122\n7 794396 794396\n17 661238 661238\n11 573794 573794\n7 894429 894429\n11 231012 231012\n3 639530 639530",
          "testOut": "3222837\n899411843\n814595114\n802971516\n238708992\n911286212\n294325365\n610387481\n133040953\n15853874\n432834171\n185896825\n20637624\n445477334\n980078570\n624504585\n923830418\n549587577\n12547395\n921957761\n231547540\n293150600\n875603621\n242640175\n268611175\n748549163\n171149323\n454212985\n930177182\n730442272\n173570081\n530068730\n491597856\n918851556\n911483594\n70796017\n122429718\n388220365\n830210654\n419849115\n638968511\n719845780\n137877771\n607628367\n376084639\n105674112\n875078750\n746773911\n663000430\n727294464\n315386359\n530270174\n341372857\n869622459\n61612497\n100662934\n635782224\n44307545\n411225341\n370485462\n723057123\n554973408\n752381229\n962806340\n300479629\n812086048\n340719754\n606108096\n478338214\n68480775\n872938546\n91928676\n983889295\n95234329\n614097442\n319572309\n787194434\n509208\n928389892\n41732983\n461523603\n798008693\n705216796\n706787207\n264221328\n817459776\n504942069\n863749947\n204142808\n644638538\n947799193\n725122563\n155675577\n604977660\n991341467\n946618590\n132400209\n846675781\n743685319\n448211378",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "R = C (medium)",
          "isTest": false,
          "testIn": "100\n17 979803 979803\n3 723059 723059\n17 898168 898168\n5 18457 18457\n5 478043 478043\n11 377374 377374\n11 544920 544920\n7 898538 898538\n7 594325 594325\n17 664371 664371\n17 803527 803527\n5 268981 268981\n7 241874 241874\n7 999171 999171\n13 497282 497282\n11 420926 420926\n7 336328 336328\n7 960379 960379\n17 66602 66602\n17 612903 612903\n11 570493 570493\n13 260757 260757\n5 560281 560281\n7 209442 209442\n11 429690 429690\n13 346620 346620\n13 744730 744730\n11 108118 108118\n7 126506 126506\n13 621730 621730\n5 925858 925858\n3 353896 353896\n3 100546 100546\n7 233368 233368\n3 383427 383427\n13 455737 455737\n17 595369 595369\n11 956430 956430\n7 21531 21531\n7 665124 665124\n5 703136 703136\n7 990365 990365\n11 313751 313751\n5 426809 426809\n3 947179 947179\n7 393585 393585\n11 502652 502652\n7 612400 612400\n3 95061 95061\n7 993369 993369\n5 210013 210013\n13 698587 698587\n3 297540 297540\n11 480571 480571\n5 930887 930887\n11 636916 636916\n17 238336 238336\n13 760493 760493\n11 641422 641422\n7 490028 490028\n7 520060 520060\n17 513927 513927\n3 276122 276122\n7 794396 794396\n17 661238 661238\n11 573794 573794\n7 894429 894429\n11 231012 231012\n3 639530 639530\n3 276966 276966\n13 964684 964684\n17 28625 28625\n13 332872 332872\n7 48830 48830\n11 530020 530020\n3 363369 363369\n13 486716 486716\n13 518150 518150\n11 905772 905772\n11 890676 890676\n11 698928 698928\n11 777857 777857\n17 872354 872354\n3 700724 700724\n7 2246 2246\n7 493452 493452\n5 243556 243556\n17 597489 597489\n7 888229 888229\n5 792351 792351\n5 441501 441501\n7 87765 87765\n3 324915 324915\n17 275857 275857\n11 346492 346492\n17 148366 148366\n11 281937 281937\n13 452552 452552\n17 899229 899229\n17 975408 975408",
          "testOut": "624504585\n923830418\n549587577\n12547395\n921957761\n231547540\n293150600\n875603621\n242640175\n268611175\n748549163\n171149323\n454212985\n930177182\n730442272\n173570081\n530068730\n530270174\n341372857\n869622459\n61612497\n100662934\n635782224\n44307545\n411225341\n370485462\n723057123\n554973408\n491597856\n918851556\n911483594\n70796017\n122429718\n388220365\n133040953\n15853874\n432834171\n185896825\n20637624\n445477334\n980078570\n830210654\n419849115\n638968511\n719845780\n137877771\n607628367\n376084639\n105674112\n875078750\n746773911\n663000430\n727294464\n315386359\n3222837\n899411843\n814595114\n802971516\n238708992\n911286212\n294325365\n610387481\n604977660\n991341467\n946618590\n132400209\n846675781\n743685319\n448211378\n606108096\n478338214\n68480775\n872938546\n91928676\n983889295\n95234329\n614097442\n319572309\n752381229\n962806340\n300479629\n812086048\n340719754\n787194434\n509208\n928389892\n41732983\n461523603\n798008693\n705216796\n706787207\n264221328\n817459776\n504942069\n863749947\n204142808\n644638538\n947799193\n725122563\n155675577",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "R = C (hard)",
          "isTest": true,
          "testIn": "100\n5 15744537121098240 15744537121098240\n7 16451270124105600 16451270124105600\n7 10861021531 10861021531\n5 22036203828979200 22036203828979200\n5 10071197029152000 10071197029152000\n3 11129566414 11129566414\n5 11424268981 11424268981\n11 10137806863 10137806863\n13 28606427528716800 28606427528716800\n17 57758137992000000 57758137992000000\n3 11889947179 11889947179\n3 20820789374238000 20820789374238000\n3 28539408251750400 28539408251750400\n13 71636952287040000 71636952287040000\n11 10328720228843520 10328720228843520\n3 11572276966 11572276966\n17 10352406220 10352406220\n13 12040332872 12040332872\n17 12710645687738880 12710645687738880\n5 19731838814568000 19731838814568000\n13 11869470125 11869470125\n17 34785026103905280 34785026103905280\n17 10213975408 10213975408\n5 13254619815613440 13254619815613440\n3 11784639530 11784639530\n13 10967334940391760 10967334940391760\n11 31728013384032000 31728013384032000\n17 11012502955 11012502955\n11 10968338083 10968338083\n7 44633329072315200 44633329072315200\n7 11335354341 11335354341\n17 10949309331806160 10949309331806160\n7 10552473417 10552473417\n7 23948748513900000 23948748513900000\n17 12113903882 12113903882\n5 10711845895 10711845895\n11 51051531121920000 51051531121920000\n7 11704365085 11704365085\n13 11943327685 11943327685\n3 27114702982325280 27114702982325280\n11 11469262010 11469262010\n7 22771055347488000 22771055347488000\n5 11335939812 11335939812\n17 11065311706 11065311706\n17 11414829151 11414829151\n13 10324763921 10324763921\n13 11389867270 11389867270\n5 10711645631 10711645631\n13 12006811973 12006811973\n7 16642556238708000 16642556238708000\n11 11566288820 11566288820\n3 10726371156 10726371156\n13 13163061195648000 13163061195648000\n5 13073403661762500 13073403661762500\n5 11486222843 11486222843\n3 11266235190 11266235190\n3 11277849959 11277849959\n3 17285453221639680 17285453221639680\n7 10364319530 10364319530\n3 30386374603038720 30386374603038720\n7 23756424545196000 23756424545196000\n5 11144278051 11144278051\n13 10031308903 10031308903\n11 16571991450240000 16571991450240000\n17 11144522536 11144522536\n5 13656206031600000 13656206031600000\n17 26763226076620800 26763226076620800\n17 10386160867353600 10386160867353600\n11 36336528406976000 36336528406976000\n7 11411328206 11411328206\n7 10696947387 10696947387\n3 11369602727 11369602727\n13 11707056553 11707056553\n5 11010528947 11010528947\n17 11474514265697280 11474514265697280\n7 20369688905664000 20369688905664000\n13 10873524567 10873524567\n13 27172591948454400 27172591948454400\n17 69487104287047680 69487104287047680\n13 74997195168844800 74997195168844800\n5 11943003494 11943003494\n13 13903615526400000 13903615526400000\n3 11302539391 11302539391\n5 39821248725811200 39821248725811200\n17 11905241082 11905241082\n13 55939254414309000 55939254414309000\n11 10262692686 10262692686\n3 41371273850368000 41371273850368000\n13 44691988978080000 44691988978080000\n5 19529130001026240 19529130001026240\n5 59630419228608000 59630419228608000\n11 11615935711 11615935711\n3 10406011018 10406011018\n17 35595466354151424 35595466354151424\n17 10362575056 10362575056\n7 11751378131 11751378131\n17 34993159127884800 34993159127884800\n7 17250632527994880 17250632527994880\n3 32197995043099200 32197995043099200\n3 48033500944435200 48033500944435200",
          "testOut": "884754543\n429871953\n753234302\n574775907\n595329166\n961356880\n290790013\n316624481\n184540389\n981910289\n436546966\n144950663\n356175480\n492463298\n675767286\n768212855\n660213\n550271686\n538980736\n686867547\n239418431\n146154783\n847182056\n280300077\n635123948\n279729676\n186036704\n158738248\n255327687\n142148329\n233244030\n308444183\n323127758\n963802011\n644880479\n707868523\n291057384\n139378468\n35805792\n733622727\n526805822\n758951904\n768420088\n34450751\n142820888\n71651626\n334687251\n316753930\n15977741\n113985356\n511671032\n448229090\n719787327\n755526475\n259992089\n507908485\n777917882\n411651973\n551167368\n655256424\n857561959\n47348100\n8062631\n781006374\n340855702\n189849945\n515439492\n653527324\n505635309\n337996034\n301917527\n760380578\n304082320\n500569377\n968257063\n314844358\n452654579\n61938965\n373350383\n50917130\n3281460\n875091081\n926164666\n193008206\n232805337\n942343887\n222816806\n984778220\n674887703\n82801276\n902302551\n343583382\n165009388\n333323799\n406161996\n663356373\n941574976\n876625048\n331905123\n765004554",
          "isValidator": false,
          "needValidation": false
        },
        {
          "title": "R = C (hard)",
          "isTest": false,
          "testIn": "100\n7 10552473417 10552473417\n7 23948748513900000 23948748513900000\n17 12113903882 12113903882\n5 10711845895 10711845895\n11 51051531121920000 51051531121920000\n7 11704365085 11704365085\n13 11943327685 11943327685\n3 27114702982325280 27114702982325280\n11 11469262010 11469262010\n7 22771055347488000 22771055347488000\n5 11335939812 11335939812\n11 10328720228843520 10328720228843520\n3 11572276966 11572276966\n17 10352406220 10352406220\n13 12040332872 12040332872\n17 12710645687738880 12710645687738880\n5 19731838814568000 19731838814568000\n13 11869470125 11869470125\n17 34785026103905280 34785026103905280\n17 10213975408 10213975408\n5 13254619815613440 13254619815613440\n3 11784639530 11784639530\n3 11129566414 11129566414\n5 11424268981 11424268981\n11 10137806863 10137806863\n13 28606427528716800 28606427528716800\n17 57758137992000000 57758137992000000\n13 10967334940391760 10967334940391760\n11 31728013384032000 31728013384032000\n17 11012502955 11012502955\n17 11065311706 11065311706\n17 11414829151 11414829151\n13 10324763921 10324763921\n13 11389867270 11389867270\n5 10711645631 10711645631\n13 12006811973 12006811973\n7 16642556238708000 16642556238708000\n11 11566288820 11566288820\n3 10726371156 10726371156\n13 13163061195648000 13163061195648000\n5 13073403661762500 13073403661762500\n5 11486222843 11486222843\n3 11266235190 11266235190\n3 11277849959 11277849959\n3 17285453221639680 17285453221639680\n7 10364319530 10364319530\n3 30386374603038720 30386374603038720\n7 23756424545196000 23756424545196000\n5 11144278051 11144278051\n13 10031308903 10031308903\n11 16571991450240000 16571991450240000\n17 11144522536 11144522536\n5 13656206031600000 13656206031600000\n17 26763226076620800 26763226076620800\n17 10386160867353600 10386160867353600\n11 36336528406976000 36336528406976000\n7 11411328206 11411328206\n7 10696947387 10696947387\n3 11369602727 11369602727\n11 10968338083 10968338083\n7 44633329072315200 44633329072315200\n7 11335354341 11335354341\n17 10949309331806160 10949309331806160\n3 10406011018 10406011018\n17 35595466354151424 35595466354151424\n17 10362575056 10362575056\n7 11751378131 11751378131\n17 34993159127884800 34993159127884800\n7 17250632527994880 17250632527994880\n3 32197995043099200 32197995043099200\n3 48033500944435200 48033500944435200\n13 11707056553 11707056553\n5 11010528947 11010528947\n17 11474514265697280 11474514265697280\n7 20369688905664000 20369688905664000\n13 10873524567 10873524567\n13 27172591948454400 27172591948454400\n17 69487104287047680 69487104287047680\n13 74997195168844800 74997195168844800\n5 11943003494 11943003494\n3 11889947179 11889947179\n3 20820789374238000 20820789374238000\n3 28539408251750400 28539408251750400\n13 71636952287040000 71636952287040000\n5 15744537121098240 15744537121098240\n7 16451270124105600 16451270124105600\n7 10861021531 10861021531\n5 22036203828979200 22036203828979200\n5 10071197029152000 10071197029152000\n3 41371273850368000 41371273850368000\n13 44691988978080000 44691988978080000\n5 19529130001026240 19529130001026240\n5 59630419228608000 59630419228608000\n11 11615935711 11615935711\n13 13903615526400000 13903615526400000\n3 11302539391 11302539391\n5 39821248725811200 39821248725811200\n17 11905241082 11905241082\n13 55939254414309000 55939254414309000\n11 10262692686 10262692686",
          "testOut": "323127758\n963802011\n644880479\n707868523\n291057384\n139378468\n35805792\n733622727\n526805822\n758951904\n768420088\n675767286\n768212855\n660213\n550271686\n538980736\n686867547\n239418431\n146154783\n847182056\n280300077\n635123948\n961356880\n290790013\n316624481\n184540389\n981910289\n279729676\n186036704\n158738248\n34450751\n142820888\n71651626\n334687251\n316753930\n15977741\n113985356\n511671032\n448229090\n719787327\n755526475\n259992089\n507908485\n777917882\n411651973\n551167368\n655256424\n857561959\n47348100\n8062631\n781006374\n340855702\n189849945\n515439492\n653527324\n505635309\n337996034\n301917527\n760380578\n255327687\n142148329\n233244030\n308444183\n165009388\n333323799\n406161996\n663356373\n941574976\n876625048\n331905123\n765004554\n304082320\n500569377\n968257063\n314844358\n452654579\n61938965\n373350383\n50917130\n3281460\n436546966\n144950663\n356175480\n492463298\n884754543\n429871953\n753234302\n574775907\n595329166\n984778220\n674887703\n82801276\n902302551\n343583382\n875091081\n926164666\n193008206\n232805337\n942343887\n222816806",
          "isValidator": true,
          "needValidation": false
        },
        {
          "title": "R != C (easy)",
          "isTest": true,
          "testIn": "20\n5 26 87\n17 136 136\n3 13 50\n5 91 91\n13 141 141\n13 64 137\n11 30 30\n7 2 63\n5 130 130\n3 47 59\n5 17 57\n11 126 174\n7 138 138\n7 116 116\n17 49 127\n7 74 74\n7 125 197\n11 37 85\n17 39 47\n17 83 125",
          "testOut": "227\n5508\n52\n1726\n5731\n1300\n306\n3\n3405\n450\n102\n4386\n3882\n2694\n819\n1200\n3108\n436\n504\n2130",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "R != C (easy)",
          "isTest": false,
          "testIn": "20\n3 47 59\n5 17 57\n11 126 174\n17 49 127\n7 74 74\n7 125 197\n11 37 85\n17 39 47\n17 83 125\n5 91 91\n11 30 30\n7 2 63\n5 130 130\n13 141 141\n13 64 137\n7 138 138\n7 116 116\n5 26 87\n17 136 136\n3 13 50",
          "testOut": "450\n102\n4386\n819\n1200\n3108\n436\n504\n2130\n1726\n306\n3\n3405\n5731\n1300\n3882\n2694\n227\n5508\n52",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "R != C (medium)",
          "isTest": true,
          "testIn": "100\n5 930886 692777\n17 885386 238335\n11 641421 202362\n7 897763 520059\n3 383426 89172\n17 702567 595368\n7 722862 21530\n5 703135 513929\n3 723058 133069\n5 175011 18456\n11 484421 377373\n7 898537 575198\n17 664370 566413\n5 759956 268980\n7 999170 906996\n11 477084 420925\n7 750846 126505\n5 925857 616124\n3 898814 100545\n7 990364 344043\n5 426808 117276\n7 705403 393584\n7 999932 612399\n7 993368 947739\n13 698586 348094\n11 651434 480570\n17 710097 66601\n11 926652 570492\n5 724286 560280\n11 429689 228444\n13 958031 744729\n11 905771 834481\n11 704567 698927\n17 872353 254586\n13 964683 406219\n13 805732 332871\n11 530019 258270\n13 486715 226340\n3 700723 142618\n7 892921 493451\n17 597488 537764\n5 792350 165193\n7 470124 87764\n17 373743 275856\n17 709859 148365\n13 452551 316437\n17 975407 901474\n7 794395 36029\n11 573793 65818\n11 335928 231011\n7 964443 322404\n17 854538 118606\n13 344818 235128\n11 569917 67917\n7 987743 259470\n7 689772 295499\n13 755590 617505\n7 907669 469786\n3 388464 110197\n11 376348 228804\n7 949299 127828\n13 354340 35568\n17 613810 267605\n5 473730 44878\n3 178736 79444\n3 586708 503465\n3 412924 213258\n3 962600 305624\n7 911899 419379\n7 900973 290071\n11 808933 684930\n13 657199 370163\n17 252996 152959\n5 739668 187190\n7 365084 116466\n13 443376 327684\n3 517445 379107\n5 706887 418418\n13 451659 32172\n7 625210 166342\n3 697713 319301\n5 864819 401255\n11 955939 229904\n7 915667 311705\n17 829150 565984\n3 789224 602422\n7 645630 54081\n13 811972 207672\n5 905385 741222\n13 783898 606042\n7 280524 256190\n17 288819 108581\n3 495994 371155\n17 614769 85273\n3 721860 247255\n17 445884 421993\n17 962504 679567\n5 262754 31326\n13 828202 613202\n7 902021 222842",
          "testOut": "384395534\n285567405\n605709354\n717968038\n560564496\n69880733\n27418121\n362947910\n325158481\n156715989\n974954508\n208556540\n732227230\n270219113\n760047332\n955608960\n463933532\n979754161\n440889229\n317885969\n405449758\n25782832\n148049989\n803157200\n907555522\n283374551\n327595327\n696990736\n693232790\n365940320\n973230631\n493811289\n479304823\n557812293\n652716816\n525892853\n89699286\n894381328\n319787875\n323627413\n274915872\n352270299\n769924179\n711175190\n279376637\n409562169\n881266016\n646984297\n833633732\n383887035\n3086521\n796210202\n779689081\n863195130\n856158839\n456620982\n11541656\n859454042\n617920704\n640643927\n465196572\n172558861\n969741469\n815771475\n247040712\n211064054\n979415256\n942109850\n453734378\n174079656\n99612036\n11935770\n704325431\n360250050\n454458859\n395752692\n759381103\n674100229\n316167613\n750195635\n62593682\n602379455\n446210195\n641486216\n157570196\n12471843\n807355836\n239546496\n235758104\n20484913\n653828435\n419073554\n587709193\n135041512\n919409689\n569267021\n633897853\n337320300\n753391094\n418294844",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "R != C (medium)",
          "isTest": false,
          "testIn": "100\n17 702567 595368\n7 722862 21530\n5 703135 513929\n3 723058 133069\n5 175011 18456\n7 993368 947739\n13 698586 348094\n11 651434 480570\n17 710097 66601\n11 926652 570492\n7 990364 344043\n5 426808 117276\n7 705403 393584\n5 930886 692777\n17 885386 238335\n11 641421 202362\n7 897763 520059\n3 383426 89172\n11 484421 377373\n7 898537 575198\n17 664370 566413\n5 759956 268980\n7 999170 906996\n11 477084 420925\n11 530019 258270\n13 486715 226340\n3 700723 142618\n7 892921 493451\n11 905771 834481\n11 704567 698927\n17 872353 254586\n13 964683 406219\n13 805732 332871\n7 750846 126505\n5 925857 616124\n3 898814 100545\n7 999932 612399\n5 724286 560280\n11 429689 228444\n13 958031 744729\n7 987743 259470\n7 689772 295499\n13 755590 617505\n7 907669 469786\n3 388464 110197\n11 376348 228804\n7 949299 127828\n17 597488 537764\n5 792350 165193\n7 470124 87764\n17 373743 275856\n7 911899 419379\n7 900973 290071\n11 808933 684930\n13 657199 370163\n17 252996 152959\n5 739668 187190\n7 365084 116466\n11 573793 65818\n11 335928 231011\n7 964443 322404\n17 854538 118606\n13 344818 235128\n11 569917 67917\n17 709859 148365\n13 452551 316437\n17 975407 901474\n7 794395 36029\n13 443376 327684\n3 517445 379107\n5 706887 418418\n13 451659 32172\n7 625210 166342\n3 697713 319301\n5 864819 401255\n11 955939 229904\n5 473730 44878\n3 178736 79444\n3 586708 503465\n3 412924 213258\n3 962600 305624\n13 354340 35568\n17 613810 267605\n17 614769 85273\n3 721860 247255\n17 445884 421993\n17 962504 679567\n5 262754 31326\n13 828202 613202\n7 902021 222842\n5 905385 741222\n13 783898 606042\n7 280524 256190\n7 915667 311705\n17 829150 565984\n3 789224 602422\n17 288819 108581\n3 495994 371155\n7 645630 54081\n13 811972 207672",
          "testOut": "69880733\n27418121\n362947910\n325158481\n156715989\n803157200\n907555522\n283374551\n327595327\n696990736\n317885969\n405449758\n25782832\n384395534\n285567405\n605709354\n717968038\n560564496\n974954508\n208556540\n732227230\n270219113\n760047332\n955608960\n89699286\n894381328\n319787875\n323627413\n493811289\n479304823\n557812293\n652716816\n525892853\n463933532\n979754161\n440889229\n148049989\n693232790\n365940320\n973230631\n856158839\n456620982\n11541656\n859454042\n617920704\n640643927\n465196572\n274915872\n352270299\n769924179\n711175190\n453734378\n174079656\n99612036\n11935770\n704325431\n360250050\n454458859\n833633732\n383887035\n3086521\n796210202\n779689081\n863195130\n279376637\n409562169\n881266016\n646984297\n395752692\n759381103\n674100229\n316167613\n750195635\n62593682\n602379455\n446210195\n815771475\n247040712\n211064054\n979415256\n942109850\n172558861\n969741469\n135041512\n919409689\n569267021\n633897853\n337320300\n753391094\n418294844\n235758104\n20484913\n653828435\n641486216\n157570196\n12471843\n419073554\n587709193\n807355836\n239546496",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "R != C (hard)",
          "isTest": true,
          "testIn": "100\n5 439090686306580504 603461588876074990\n13 572599322072578912 416610512442290276\n11 659192494824944889 898961909284614961\n5 282136155260626421 503553594249130318\n17 241374024673916335 944819576786124352\n5 166093681770767474 278809444329944211\n13 785253318922573921 857327776402347173\n3 184198637349916957 168238885373712615\n11 413670197455364163 171804013107660693\n5 286629621992193035 525228526732101371\n7 60604810173715144 148101277185407070\n5 756966841820163800 444878179146544611\n7 526299710076255278 981472995856240219\n5 779807271639055831 912534278345493853\n17 403718204022285100 258338248473790194\n13 6832028228335556 47989288848323945\n3 555780012858182119 371177396421016181\n3 203858780551868266 522505060694862282\n13 218329747178294862 496654505452732600\n13 350680797185590425 663659475811515234\n17 913334689884981436 925069595088276126\n7 532089565222113558 28225294381073290\n11 582279521466792434 241948223941872641\n11 495817482465894644 253250036855122944\n7 761368756310286466 74957513320893366\n7 199267140679614003 179341991847042639\n7 948834992249914514 469866941550072429\n5 676790727184649567 158059689648166167\n5 193768231431332403 165165203182258093\n5 822427815442210023 147666881331965358\n5 1119852145224764 477280564208426884\n13 906768690524494966 638103534483855024\n11 196877724033610875 240668034503823557\n5 663840422005741147 635701219647302652\n17 184621603937607241 404425875724712220\n5 512053650010462182 90546080456081312\n13 359354375057759977 193609606881008494\n3 865114888223856247 966314078487062445\n11 429830451223952221 44385685592900477\n5 444787434384229287 764129134452015094\n7 796759840680336492 626422126920416161\n5 321511015227490388 283923080803391940\n7 218595216679870087 970352674615104211\n5 959928411121235117 313985524496474365\n17 580980435728552604 411579661907467566\n13 848300112489438502 662943027068716497\n3 676743399458521969 93467471224688930\n3 183243149014132506 853787940375193455\n13 768148849312688618 947167217124857910\n13 783998981701912436 500193927002651670\n17 260196494181148480 339409659889125179\n7 781212575243658155 152962765415451837\n11 64264498867747189 583167671197304514\n11 107851642434907908 638539807296827839\n7 361499005264655374 75655241862773866\n7 360937429300719633 46122319789265050\n7 646464856310973932 658180996214731610\n5 194203862126543472 49070509845296542\n5 892765743955678755 352554681358547634\n5 416638735555876384 288467251211211342\n5 311863381294797429 76652772802069035\n13 661974754362461476 95720814752045602\n11 923535139921544669 510282279178660238\n5 651373290003241987 639891331932309000\n17 398943073107968813 326859799931807371\n5 320049888185502922 455522615998820067\n13 916818947295549648 573535667139771686\n3 521846572202618737 471723836447964583\n11 232626483002128963 367128764787790634\n5 469596468254994398 584582847093190582\n7 569407816649855607 720334966980399094\n5 395202052367169413 327675761887139974\n7 286513143127754569 19654528359630489\n5 368870527335675933 857072204962834248\n17 193220797089935566 893673397743211696\n13 247877768682032385 939576681372869335\n3 408199081810544292 955898310704518123\n3 913878299438271679 904314387776384803\n13 548484677302085231 349597020603161802\n13 946734962379654383 316683649433366641\n17 600026113083676915 981297225259620646\n7 218492477845923473 828034452285017698\n11 978521223685367702 256189527182463020\n11 745327197678655649 845755367783669441\n7 667961211348450742 846429758890134956\n7 799699380401447512 484369983996319475\n7 541486968674350844 325971699594914972\n5 824441324782791215 181193060439430438\n5 139725966211878119 895014831037219966\n5 476166530781650441 664359375527346155\n17 3195006933744967 330811168985899038\n3 799377144687552618 841274389060451944\n3 142394658963974997 420959255720273156\n3 414421135865350602 605948875858193374\n17 901858298265880244 131539768568498482\n11 246091538945733235 993320593791799320\n5 241068670857542796 976286881688127375\n13 961499894360186503 36006738815708230\n5 22396463334369171 630599568655232296\n13 332854159904979343 809858135737808842",
          "testOut": "709494941\n228353649\n817920883\n958948321\n36724278\n490095886\n187569350\n398892023\n200593142\n857645401\n840606570\n211961908\n618989062\n66610636\n571443806\n61684357\n605160662\n618933342\n92321853\n649822910\n714264337\n402740563\n758986108\n709555730\n279041287\n827280806\n766512783\n23511986\n63196114\n298163789\n411756232\n645514070\n957106394\n537948887\n256885850\n313672297\n199541189\n448660922\n618479418\n943521225\n583645909\n977425916\n424443375\n312536181\n214832602\n172256979\n419840305\n851670792\n799900265\n267805352\n403641393\n686079661\n73669384\n190664308\n696060315\n855083823\n299248429\n484335996\n308554435\n709227770\n991352910\n35065149\n894533211\n617822824\n328938526\n640282099\n24008786\n966337623\n48727133\n363743481\n18409868\n494918235\n384489881\n31916426\n39703013\n200028273\n631765220\n501751031\n620227046\n57310287\n443504972\n376269440\n490489386\n83452935\n192872308\n934666515\n205466938\n111036893\n676706495\n655992472\n435489579\n400668738\n728967193\n361684789\n204774717\n875071893\n669590149\n956241526\n121229448\n673379436",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "R != C (hard)",
          "isTest": false,
          "testIn": "100\n5 211657929396026110 551610772620221017\n13 678297631421201672 551703606949469516\n11 664663831667521589 489689890584000166\n5 142001981433811609 746797458254543851\n17 655625462213455608 981749447932968273\n5 41670644397807317 796198876768483876\n13 148134598584801667 785050734005741584\n3 559638055793908755 112326904377665204\n11 618765485257356890 196293006061507331\n5 891120423622510274 627315331985685637\n7 832835059595285019 22710355813000927\n5 719372816941786688 789738655026481151\n7 779707696147613846 247710753650376531\n5 683569026982055122 490990146737449519\n17 688150747316906414 102642053388208177\n13 272869509738622441 826796479402066513\n3 266083884645202479 989571959983017135\n3 505247868004505242 578683361622664636\n13 47591132915864176 887669592841363099\n13 325819584271256543 222294495474365163\n17 697207529872166071 304191672414789368\n7 403352050892932872 97858693058976336\n11 401180322889126150 396008494229460768\n11 545986341170787344 571977741389639124\n7 541647362806594929 985323715643385674\n7 847687437700006806 356104451956145317\n7 403154688819893331 367497355387351238\n5 536092853466168663 584551527211260973\n5 273255334433963702 310533914154292701\n5 413493789036168626 473027369764014046\n17 367854714295756788 108888769917251503\n3 291666045421483355 298798027520231786\n3 772110391315236809 615814920010159596\n3 948482072329131908 80061032682207295\n17 49633872571492223 36402762230150117\n11 303752167537734376 688614272550436675\n5 516082728193013573 582083439334006569\n13 158344487107590585 931295613521995840\n5 433834486815728284 868349827863006202\n13 655162847541411888 282855449508467663\n11 348840142067541914 885676564693433631\n11 610177394942996725 452254969159775058\n11 144520704265573184 792823659106109787\n17 176141739449592725 408990149356162294\n7 998553657717102745 774474297204357271\n5 378527236818396030 808216790521341749\n7 832584773278506622 482202074337949918\n7 598314454903943347 117499766009233753\n17 558995897278410265 439666421073478947\n3 989434347070427635 168585555921435074\n3 12074004489766081 281686909092907806\n17 357180954783746895 740331395174096618\n11 789071636462065237 529995855594058802\n11 257009777796991843 241153318722859607\n13 337210675169541615 424367618682870174\n11 248022352544758889 374862376821808972\n5 333956701787012205 567045353914956087\n7 67777642985121575 530417101993482205\n7 979025210924982225 369889948261080205\n5 527820646410167678 772159194408915686\n11 272965747936073457 208718194247802363\n11 983948842834735157 555775067048536104\n13 838610296362327174 634630435747661729\n17 714967700453327695 191919688358839656\n3 600894763052253075 325543600360652635\n17 161999814125831150 962937136341370148\n7 185402309550224580 513504790940902355\n5 528471154603363439 313910600741447799\n13 104001523961889525 166686180319670713\n11 912813049777115406 248022556562075112\n7 975860236345789929 382982429898168568\n7 317275793636442897 901078642805640291\n7 354402644592304401 367630366098384142\n5 114985035474546943 441118947174232850\n5 698128968788876866 489010306699437285\n3 348748104479566828 222373514608790799\n13 539484061792384169 538740549613370443\n13 488275169968815352 702344011991962674\n3 653978002919650237 754113019444788877\n7 12077028241379866 33209139322214627\n7 877090409322377326 634532290525017794\n3 925187008137311169 961844986457982958\n5 177283710365773068 79002625118286848\n11 439965955027017560 90674130324612083\n7 600762089506690582 310763949066430119\n11 165975873572321195 580145897458126287\n3 964790850716401101 477499794792049981\n11 143770783794785056 420170166068959687\n17 591510502611347862 619668575499349809\n3 910616208313354515 460102431455978893\n7 272264621968626255 13829573642237133\n11 389345919506153712 87386032358593972\n13 361775414390365948 644392671585312471\n13 289134690695464105 709051479118840667\n7 481838143923769087 89630354024745777\n7 837524756640597383 648877097127733159\n11 443468075765738897 193102250134005438\n13 937949935207277307 170119652447103346\n5 620530995422756461 335696679720053983\n3 80884515360784681 382419709289667406",
          "testOut": "841574468\n343573764\n130901089\n781251061\n448807551\n83544272\n592596308\n403924868\n906214406\n69111875\n570998099\n221556106\n920749604\n840635675\n984150437\n871705092\n170775384\n975152801\n1772803\n926369794\n215447872\n177853179\n93609485\n705470423\n957067550\n818132024\n695660000\n476230198\n458666809\n413640418\n742672141\n544112446\n290903865\n766780777\n25702981\n411166309\n955838953\n516166402\n850826846\n326081162\n680982191\n718340465\n78375554\n736075029\n889419937\n538856534\n260475765\n911008849\n355499840\n128750491\n589747818\n597302775\n890186113\n837621464\n220003061\n951873939\n876046042\n838264341\n231037307\n185212701\n611721999\n884198586\n297894882\n392690660\n762925588\n585313403\n246943059\n50043498\n356318268\n247029571\n981812405\n967083970\n780547770\n259952184\n386883125\n7207328\n405467047\n438685307\n94185571\n292734338\n562232970\n77842912\n435704636\n269928105\n635945521\n266437357\n141308685\n801804117\n666006315\n34254345\n369152886\n922908444\n5170153\n854129629\n106296338\n599285302\n760804247\n364855067\n768881614\n371522322",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Mixed",
          "isTest": true,
          "testIn": "100\n11 6903190 2495425\n7 534754732214304 534754732214304\n3 22675730479515360 22675730479515360\n17 574 491\n7 230 54\n5 6418627 1830857\n13 580 338\n17 37580136668874240 445223061803520\n13 27877628509038000 554769972240960\n3 540383426 304089172\n7 7390358 1328205\n11 5533459 591100\n7 11602384030469232 4681558448848512\n13 59564345800386600 805568227788744\n13 7565100 5204346\n13 9058025 7211388\n5 80 56\n7 7988010013839035920 7988010013839035920\n13 5790417 2056856\n17 481 316\n13 13687740373950720 13687740373950720\n3 7056552 5204916\n13 7100237 7100237\n3 589 568\n7 102520059 44897763\n13 317 230\n13 2361250235388728896 2416949\n11 7472816619014586368 6351072931327186848\n11 7228023 6266761\n17 219791603062665270 12922105493499840\n7 6366831854239599616 1850952926\n3 7149314 772757\n11 570 462\n5 315 257\n17 9356620 925433\n13 244390290658976000 4969596829409280\n7 43 43\n17 5933681 5518157\n17 860348706772200 860348706772200\n17 236417135415355440 49309162945755895\n17 69443395040149680 15030106110425952\n5 2648518 2648518\n13 41348621284488000 593144881655040\n7 7832857774167014400 6353159535988834304\n5 628175011 89018456\n7 96 70\n3 45 14\n11 377 179\n11 550 527\n5 8532290 528946\n13 7226057 6764524\n5 468703135 101513929\n17 521595368 294702567\n7 3563023483574034432 3370633290388482048\n7 46 5\n7 375 375\n11 3436873 3228458\n13 339 231\n13 305 18\n11 189641421 25202362\n5 681692777 681692777\n17 6620483 1804289\n11 474 143\n5 544 57\n11 22593327131547648 5328648091269360\n5 7812645415879167072 85239928691027968\n3 813256262818458030 29915215519200480\n3 9110699 5550270\n13 6819080 4799051\n11 859484421 653377373\n7 6059479 6059479\n13 3439214 788355\n7 23063628273399168 332314179563520\n5 569 163\n3 20814654859479936 3454885718893056\n17 16974097223275280 7795786123944000\n3 576 483\n11 4504234 4504234\n7 861021530 278722862\n3 635723058 369133069\n11 111 111\n13 590 282\n3 19880643846286080 288101452241024\n11 2353094913903362048 1255179497\n5 4152274 4152274\n17 11388026592448000 1456414294030100\n7 405 82\n5 76 8\n11 177 85\n17 719885386 424238335\n11 84 25\n7 98 37\n5 421 231\n7 526 193\n17 70 13\n11 518863985685045 518863985685045\n13 3524566 3524566\n11 54370000151947920 7565207439894720\n5 24 24\n13 373 247",
          "testOut": "113082768\n799852493\n610084796\n66119\n4166\n105503059\n44567\n938003001\n458303909\n11047037\n606592018\n910770092\n551028318\n379755835\n977807398\n639494152\n1265\n608304338\n162983273\n36650\n315916109\n58074945\n616973404\n27898\n516835648\n18567\n977614905\n163123896\n413713747\n735449760\n918531181\n328041041\n52194\n12300\n565830554\n790425325\n595\n108782451\n358205444\n609489906\n744634995\n725873602\n583807866\n278491395\n314397984\n1942\n264\n19524\n50289\n593877530\n467084167\n587161778\n640184606\n124179254\n160\n22612\n482010954\n21515\n3289\n665272802\n924407885\n78728103\n20737\n9917\n362809789\n198724012\n740523971\n625363650\n689162218\n751619180\n433346581\n387418281\n319689799\n20859\n938534345\n845897326\n26058\n702722628\n467338046\n273133909\n3641\n43517\n791732485\n965507339\n478842649\n725042976\n10558\n370\n4932\n392664908\n1082\n1452\n17685\n23632\n575\n869215710\n29827583\n552766257\n200\n23111",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Mixed",
          "isTest": false,
          "testIn": "100\n17 5933681 5518157\n17 860348706772200 860348706772200\n17 236417135415355440 49309162945755895\n17 69443395040149680 15030106110425952\n5 2648518 2648518\n11 5533459 591100\n7 11602384030469232 4681558448848512\n13 59564345800386600 805568227788744\n3 589 568\n11 6903190 2495425\n7 534754732214304 534754732214304\n3 22675730479515360 22675730479515360\n17 574 491\n7 230 54\n5 6418627 1830857\n13 580 338\n17 37580136668874240 445223061803520\n13 27877628509038000 554769972240960\n3 540383426 304089172\n7 7390358 1328205\n7 7988010013839035920 7988010013839035920\n13 5790417 2056856\n17 481 316\n13 13687740373950720 13687740373950720\n7 6366831854239599616 1850952926\n3 7149314 772757\n11 570 462\n5 315 257\n17 9356620 925433\n13 244390290658976000 4969596829409280\n7 43 43\n7 102520059 44897763\n13 317 230\n13 2361250235388728896 2416949\n13 7226057 6764524\n5 468703135 101513929\n17 521595368 294702567\n13 6819080 4799051\n11 859484421 653377373\n7 6059479 6059479\n13 3439214 788355\n7 23063628273399168 332314179563520\n5 569 163\n13 339 231\n13 305 18\n11 189641421 25202362\n5 681692777 681692777\n17 6620483 1804289\n11 474 143\n5 628175011 89018456\n7 96 70\n3 45 14\n11 377 179\n11 7472816619014586368 6351072931327186848\n11 7228023 6266761\n17 219791603062665270 12922105493499840\n3 7056552 5204916\n13 7100237 7100237\n13 7565100 5204346\n13 9058025 7211388\n5 80 56\n13 41348621284488000 593144881655040\n7 7832857774167014400 6353159535988834304\n11 550 527\n5 8532290 528946\n5 421 231\n7 526 193\n17 70 13\n11 518863985685045 518863985685045\n13 3524566 3524566\n11 54370000151947920 7565207439894720\n5 24 24\n13 373 247\n7 861021530 278722862\n3 635723058 369133069\n11 111 111\n13 590 282\n3 19880643846286080 288101452241024\n7 405 82\n5 76 8\n11 177 85\n3 20814654859479936 3454885718893056\n17 16974097223275280 7795786123944000\n3 576 483\n11 4504234 4504234\n17 719885386 424238335\n11 84 25\n7 98 37\n5 544 57\n11 22593327131547648 5328648091269360\n5 7812645415879167072 85239928691027968\n3 813256262818458030 29915215519200480\n3 9110699 5550270\n11 2353094913903362048 1255179497\n5 4152274 4152274\n17 11388026592448000 1456414294030100\n7 3563023483574034432 3370633290388482048\n7 46 5\n7 375 375\n11 3436873 3228458",
          "testOut": "108782451\n358205444\n609489906\n744634995\n725873602\n910770092\n551028318\n379755835\n27898\n113082768\n799852493\n610084796\n66119\n4166\n105503059\n44567\n938003001\n458303909\n11047037\n606592018\n608304338\n162983273\n36650\n315916109\n918531181\n328041041\n52194\n12300\n565830554\n790425325\n595\n516835648\n18567\n977614905\n467084167\n587161778\n640184606\n689162218\n751619180\n433346581\n387418281\n319689799\n20859\n21515\n3289\n665272802\n924407885\n78728103\n20737\n314397984\n1942\n264\n19524\n163123896\n413713747\n735449760\n58074945\n616973404\n977807398\n639494152\n1265\n583807866\n278491395\n50289\n593877530\n17685\n23632\n575\n869215710\n29827583\n552766257\n200\n23111\n467338046\n273133909\n3641\n43517\n791732485\n10558\n370\n4932\n938534345\n845897326\n26058\n702722628\n392664908\n1082\n1452\n9917\n362809789\n198724012\n740523971\n625363650\n965507339\n478842649\n725042976\n124179254\n160\n22612\n482010954",
          "isValidator": true,
          "needValidation": true
        }
      ],
      "difficulty": "expert",
      "constraints": "1 ≤ [[T]] ≤ 100\n1 ≤ [[R]], [[C]] ≤ 10^19\n3 ≤ [[P]] ≤ 17\n\n[[P]] is prime.",
      "coverBinaryId": 52965649690853,
      "stubGenerator": "read T:int\nloop T read P:long R:word(20) C:word(20)\nloop T write answer",
      "inputDescription": "<<Line 1:>> A single integer, [[T]], denoting the number of test cases.\n\n<<Next [[T]] lines:>> Three space-separated integers, [[P]], [[R]], and [[C]], for a test case.",
      "solutionLanguage": "C++",
      "outputDescription": "<<[[T]] lines:>> A single integer representing the number of shaded cells in the first [[R]] rows and [[C]] columns of the fractal that is formed after shading all cells that are non-divisible by [[P]] for a test case. Output your results modulo {{1000000007}}."
    },
    "draft": false,
    "readyForModeration": true,
    "statementHTML": "<div class=\"statement-body\">\n<div class=\"statement-section statement-goal\">\n   <h2><span class=\"icon icon-goal\">&nbsp;</span><span>Goal </span></h2>\n   <span class=\"question-statement\"><strong>Pascal's Triangle</strong> is a famous mathematical structure, in which the binomial coefficients are arranged in a triangular fashion. It is commonly generated recursively by defining the 0'th row/column as 1, padding each subsequent row with two 1's, and applying the recurrence:<br><br><strong>C(n, k) = C(n-1, k-1) + C(n-1, k)</strong><br><br>...where <var>n</var> and <var>k</var> represent the indices of the the triangle's rows and columns respectively. This produces the following collection of integers for the first few rows:<br><pre style=\"font-family: monospace\"><br>[0]|1<br>[1]|1 1<br>[2]|1 2 1<br>[3]|1 3 3 1<br>[4]|1 4 6 4 1<br>[5]|1 5 10 10 5 1<br>[6]|1 6 15 20 15 6 1<br>etc...<br></pre><br>In addition to its many practical applications in mathematics, Pascal's triangle also has many unusual and fascinating properties. One of its most intriguing characteristics pertains to divisibility, and can be demonstrated by shading all cells in the triangle that are not divisible by a given number (henceforth referred to as <var>P</var>). This expands into an infinite fractal pattern that closely resembles the well-known Sierpinski triangle. For example, here are the first 12 rows of the fractal that is formed when <strong>P = 3</strong>:<br><pre style=\"font-family: monospace\"><br>[01]|# (1)<br>[02]|## (2)<br>[03]|### (3)<br>[04]|#__# (2)<br>[05]|##_## (4)<br>[06]|###### (6)<br>[07]|#__#__# (3)<br>[08]|##_##_## (6)<br>[09]|######### (9)<br>[10]|#________# (2)<br>[11]|##_______## (4)<br>[12]|###______### (6)<br>etc...<br></pre><br>Given three integers <var>P</var>, <var>R</var>, and <var>C</var>, your task is to count the number of shaded cells in the first <var>R</var> rows and <var>C</var> columns of the resulting fractal. You can assume that the triangle's values are all left-aligned and displayed in the form of a two-dimensional matrix (as in the example above). As C(n, k) is undefined for k &gt; n, disregard any cells where the column index is greater than the row. As the resulting numbers can be quite massive, print your answer modulo <const>1000000007</const>.<br><br>============================================================================<br><br><strong>[Example]:</strong><br><br><strong>P = 3</strong><br><strong>R = 12</strong><br><strong>C = 6</strong><br><pre style=\"font-family: monospace\"><br>[01]|# (1)<br>[02]|## (2)<br>[03]|### (3)<br>[04]|#__# (2)<br>[05]|##_## (4)<br>[06]|###### (6)<br>[07]|#__#__. (2)<br>[08]|##_##_.. (4)<br>[09]|######... (6)<br>[10]|#_____.... (1)<br>[11]|##____..... (2)<br>[12]|###___...... (3)<br><br>('#' -- shaded)<br>('_' -- unshaded)<br>('.' -- out of bounds)<br></pre><br>Result = (1 + 2 + 3 + 2 + 4 + 6 + 2 + 4 + 6 + 1 + 2 + 3) % 1000000007 = <strong>36</strong></span>\n</div>\n<div class=\"statement-section statement-protocol\">\n   <div class=\"blk\">\n      <div class=\"title\">Input</div>\n      <div class=\"question-statement-input\"><strong>Line 1:</strong> A single integer, <var>T</var>, denoting the number of test cases.<br><br><strong>Next <var>T</var> lines:</strong> Three space-separated integers, <var>P</var>, <var>R</var>, and <var>C</var>, for a test case.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Output</div>\n      <div class=\"question-statement-output\"><strong><var>T</var> lines:</strong> A single integer representing the number of shaded cells in the first <var>R</var> rows and <var>C</var> columns of the fractal that is formed after shading all cells that are non-divisible by <var>P</var> for a test case. Output your results modulo <const>1000000007</const>.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Constraints</div>\n      <div class=\"question-statement-constraints\">1 &le; <var>T</var> &le; 100<br>1 &le; <var>R</var>, <var>C</var> &le; 10^19<br>3 &le; <var>P</var> &le; 17<br><br><var>P</var> is prime.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Example</div>\n      <div class=\"statement-inout\">\n         <div class=\"statement-inout-in\">\n            <div class=\"title\">Input</div>\n            <pre class=\"question-statement-example-in\">11\n3 12 6\n5 47 47\n5 114 114\n13 13 13\n5 3 3\n7 20 20\n13 61 25\n13 12 4\n11 63 27\n5 68 68\n17 43 8</pre>\n         </div>\n         <div class=\"statement-inout-out\">\n            <div class=\"title\">Output</div>\n            <pre class=\"question-statement-example-out\">36\n555\n2625\n91\n6\n147\n724\n42\n831\n1017\n260</pre>\n         </div>\n      </div>\n   </div>\n</div>"
  },
  "validatedFor": 148760958539,
  "avatar": 5127913573349,
  "commentCount": 34,
  "upVotes": 43,
  "downVotes": 4,
  "validateAction": {
    "actionId": 563477,
    "progress": 1,
    "alreadyDone": false
  },
  "statusHistory": [
    {
      "status": "REFUSED",
      "date": 1607681137000,
      "data": {
        "author": "SYSTEM",
        "reason": "INACTIVITY"
      }
    },
    {
      "status": "PENDING",
      "date": 1608023937411,
      "data": {
        "author": "ACTION",
        "reason": "EDIT"
      }
    },
    {
      "status": "REFUSED",
      "date": 1610618737002,
      "data": {
        "author": "SYSTEM",
        "reason": "INACTIVITY"
      }
    },
    {
      "status": "PENDING",
      "date": 1619397478169,
      "data": {
        "author": "ACTION",
        "reason": "EDIT"
      }
    },
    {
      "status": "ACCEPTED",
      "date": 1621969544817,
      "data": {
        "author": "ACTION"
      }
    }
  ],
  "editable": true,
  "draft": false,
  "readyForModeration": true
}