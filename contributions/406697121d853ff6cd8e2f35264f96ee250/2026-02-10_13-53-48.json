{
  "id": 406,
  "activeVersion": 36,
  "score": 10,
  "votableId": 3091026,
  "codingamerId": 552776,
  "views": 593,
  "commentableId": 3037856,
  "title": "Ticket to Ride: Europe",
  "status": "ACCEPTED",
  "type": "PUZZLE_INOUT",
  "nickname": "player_one",
  "publicHandle": "406697121d853ff6cd8e2f35264f96ee250",
  "codingamerHandle": "fefb3b0a360d9451bde5553900470e2d677255",
  "lastVersion": {
    "version": 36,
    "data": {
      "title": "Ticket to Ride: Europe",
      "topics": [
        {
          "id": 66,
          "handle": "optimization",
          "labelMap": {
            "1": "Optimisation",
            "2": "Optimization"
          },
          "pageTitle": "Optimization: exercises and theory",
          "puzzleCount": 10,
          "parentTopicId": 41,
          "contentDetailsId": 87
        },
        {
          "id": 60,
          "handle": "dynamic-programming",
          "labelMap": {
            "1": "Programmation dynamique",
            "2": "Dynamic programming"
          },
          "pageTitle": "Dynamic programming: exercises and theory",
          "puzzleCount": 18,
          "parentTopicId": 41,
          "contentDetailsId": 85
        },
        {
          "id": 56,
          "handle": "backtracking",
          "labelMap": {
            "1": "Retour sur trace",
            "2": "Backtracking"
          },
          "pageTitle": "Backtracking: exercises and theory",
          "puzzleCount": 9,
          "parentTopicId": 41,
          "contentDetailsId": 80
        }
      ],
      "solution": "using System;\nusing System.Diagnostics;\nusing System.Linq;\nusing System.Collections.Generic;\n\npublic static class TicketsToRideEurope\n{\n    private readonly struct Route {\n        public readonly int Pow, Length, Engines, Color, From, To;\n        public Route(int pow, int length, int engines, int color, int from, int to) {\n            Pow = pow; Length = length; Engines = engines; Color = color; From = from; To = to;\n        }\n        public override int GetHashCode() => Pow;\n    }\n    private readonly struct Ticket {\n        public readonly int Points, From, To;\n        public Ticket(int points, int from, int to) { Points = points; From = from; To = to; }\n    }\n    private readonly struct Hand {\n        public readonly int TrainCars;\n        public readonly int[] Cards;\n        public Hand(int trainCars, int[] cards) { TrainCars = trainCars; Cards = cards; }\n    }\n    private static int[] ComputePaths(int from, int to) {\n        var paths = new List<int>();\n        Span<(int city, int path)> queue = stackalloc (int, int)[4096];\n        int idx = 0, end = 1; queue[0] = (from, 0);\n        while (idx < end) {\n            var (cur, path) = queue[idx++];\n            bool skip = false;\n            for (int i = 0; i < paths.Count; i++)\n                if ((path & paths[i]) == paths[i]) {\n                    skip = true;\n                    break;\n                }\n            if (skip) continue;\n            if (cur == to) { paths.Add(path); continue; }\n            for (int i = 0; i < Routes.Length; i++) {\n                if ((path & Routes[i].Pow) != 0) continue;\n                if (Routes[i].From == cur)\n                    queue[end++] = (Routes[i].To, path | Routes[i].Pow);\n                else if (Routes[i].To == cur)\n                    queue[end++] = (Routes[i].From, path | Routes[i].Pow);\n            }\n        }\n        return paths.ToArray();\n    }\n    private static bool CanBuild(int build) {\n        int trainCars = 0, openCount = 0;\n        Span<int> costs = stackalloc int[ColorCount];\n        var open = new int[Routes.Length]; // No sort on Span<T> with this version of .Net :(\n        for (int i = 0; i < Routes.Length; i++) {\n            if ((Routes[i].Pow & build) == 0) continue;\n            trainCars += Routes[i].Length;\n            costs[Gray] += Routes[i].Engines;\n            int rest = Routes[i].Length - Routes[i].Engines;\n            if (rest == 0) continue;\n            if (Routes[i].Color == Gray) {\n                open[openCount++] = rest;\n                continue;\n            }\n            int avail = Avail.Cards[Routes[i].Color] - costs[Routes[i].Color];\n            if (rest <= avail)\n                costs[Routes[i].Color] += rest;\n            else {\n                costs[Gray] += rest - avail;\n                costs[Routes[i].Color] = Avail.Cards[Routes[i].Color];\n            }\n        }\n        if (trainCars > Avail.TrainCars) return false;\n        if (openCount == 0) return costs[Gray] <= Avail.Cards[Gray];\n\n        Array.Resize(ref open, openCount);\n        Array.Sort(open, (a, b) => b - a);\n        for (int i = 0; i < open.Length; i++) {\n            int idx = -1, free = 0;\n            for (int j = 0; j < costs.Length - 1; j++)\n                if (Avail.Cards[j] - costs[j] > free) {\n                    idx = j;\n                    free = Math.Min(open[i], Avail.Cards[j] - costs[j]);\n                }\n            if (idx >= 0) costs[idx] += free;\n            costs[Gray] += open[i] - free;\n        }\n        return costs[Gray] <= Avail.Cards[Gray];\n    }\n    private static int GetScore(int build) {\n        if (!CanBuild(build)) return int.MinValue;\n        int score = 0;\n        for (int i = 0; i < Tickets.Length; i++) {\n            int ticketScore = -Tickets[i].Points;\n            for (int j = 0; j < Paths[i].Length; j++)\n                if ((build & Paths[i][j]) == Paths[i][j]) {\n                    ticketScore = Tickets[i].Points;\n                    break;\n                }\n            score += ticketScore;\n        }\n        int idx = 0;\n        while (build > 0) {\n            if ((build & 1) != 0) score += RouteScore[Routes[idx].Length];\n            build >>= 1; idx++;\n        }\n        return score;\n    }\n    private static int GetMaxScore(int index, int build, int omitCount) {\n        if (omitCount == 0) {\n            for (int i = index; i < Routes.Length; i++)\n                build |= Routes[i].Pow;\n            return GetScore(build);\n        }\n        if (omitCount == Routes.Length - index)\n            return GetScore(build);\n        return Math.Max(GetMaxScore(index + 1, build, omitCount - 1), GetMaxScore(index + 1, build | Routes[index].Pow, omitCount));\n    }\n\n    private const int ColorCount = 9, Gray = 8;\n    private static readonly int[] RouteScore = { 0, 1, 2, 4, 7, 0, 15 };\n    private static Hand Avail;\n    private static Ticket[] Tickets;\n    private static Route[] Routes;\n    private static int[][] Paths;\n    public static void Main()\n    {\n        var inputs = Console.ReadLine().Split(' ');\n        Avail = new Hand(int.Parse(inputs[0]), Console.ReadLine().Split(' ').Select(s => int.Parse(s)).ToArray());\n        Tickets = new Ticket[int.Parse(inputs[1])];\n        Routes = new Route[int.Parse(inputs[2])];\n        Paths = new int[Tickets.Length][];\n\n        var cities = new List<string>();\n        int AddOrGetCity(string city) {\n            int id = cities.IndexOf(city);\n            if (id < 0) {\n                id = cities.Count;\n                cities.Add(city);\n            }\n            return id;\n        }\n\n        for (int i = 0; i < Tickets.Length; i++) {\n            inputs = Console.ReadLine().Split(' ');\n            Tickets[i] = new Ticket(int.Parse(inputs[0]), AddOrGetCity(inputs[1]), AddOrGetCity(inputs[2]));\n        }\n\n        string[] colors = { \"Red\", \"Yellow\", \"Green\", \"Blue\", \"White\", \"Black\", \"Orange\", \"Pink\", \"Gray\" };\n        for (int i = 0, pow = 1; i < Routes.Length; i++, pow *= 2) {\n            inputs = Console.ReadLine().Split(' ');\n            Routes[i] = new Route(pow, int.Parse(inputs[0]), int.Parse(inputs[1]), Array.IndexOf(colors, inputs[2]), AddOrGetCity(inputs[3]), AddOrGetCity(inputs[4]));\n        }\n\n        for (int i = 0; i < Paths.Length; i++)\n            Paths[i] = ComputePaths(Tickets[i].From, Tickets[i].To);\n\n        int maxScore = int.MinValue;\n        for (int omit = 0; omit <= Routes.Length; omit++) {\n            int score = GetMaxScore(0, 0, omit);\n            if (score > int.MinValue) {\n                if (maxScore > score) break;\n                maxScore = score;\n            }\n        }\n        Console.WriteLine(maxScore);\n    }\n}",
      "statement": "Ticket to Ride is a classic board game by Alan Moon and Days of Wonder in which you earn points by connecting cities via train routes. In this puzzle, you must calculate the maximum possible score in a Ticket to Ride scenario.\n\n<<EARNING POINTS>>\n - Each completed route provides a certain number of points.\n - Each completed ticket card earns you a certain number of bonus points.\n - Ticket cards that are not completed are worth negative points.\n\n<<COMPLETING ROUTES>>\nEach route connects two cities, and requires you to expend two resources, both [[trainCars]] and cards, to complete it. The [[length]] of the route informs you how many of each resource are required. A route of [[length]] = {{3}} requires 3 [[trainCars]] <<AND>> 3 cards.\n\n<<STARTING GAME STATE>>\nYou will be provided with:\n - Number of [[trainCars]] available for use. (Resource #1)\n - Number and type of cards in your hand (Resource #2)\n - Number and nature of tickets in your hand.\n - A list of available routes on the board, and the resources required to complete each one.\n\n<<SCORING ROUTES>>\nPoints awarded for completing a route are based on the route [[length]]:\n - length of 1: 1 pt\n - length of 2: 2 pts\n - length of 3: 4 pts\n - length of 4: 7 pts\n - length of 6: 15 pts\n\n<<SCORING TICKETS>>\nEach ticket specifies two cities and a number of bonus points to be earned. If the two cities are connected via train routes (either directly or indirectly) then the points for the ticket are added to your score. If not, then the ticket’s points are deducted from your score.\n\n<<CARDS AND ROUTES>>\nEach <<card>> in your hand is EITHER a colored card ({{8}} colors available) OR an engine card (wild). Likewise, each <<route>> is EITHER one of the {{8}} colors, OR is {{Gray}}. To complete a colored route, you must expend  [[length]] cards <<of the SAME color>> from your hand. So, to complete a {{Pink}} route of [[length]] = {{3}}, you would need to expend 3 pink cards.\n\n<<ENGINE CARDS>>\nEngines are wild, and can be used as a substitute for any colored card.\n\n<<GRAY ROUTES>>\n{{Gray}} routes can be any color you want them to be. However, to complete a {{Gray}} route, the cards you expend <<MUST>> be all of the same color (potentially supplemented with engines).\n\n<<FERRIES>>\nSome {{Gray}} routes (called “ferries”) require that a certain number of the cards you expend <<MUST>> be engine cards.\n\n<<FERRY EXAMPLE>>\nA ferry of [[length]] = {{3}} and [[requiredEngines]] = {{1}} could be completed with:\n - 2 red cards and 1 engine,\n - 1 black and 2 engines,\n - but <<NOT>> 3 blue cards,\n - and <<NOT>> 1 green, 1 yellow, and 1 engine\n\n<<SCORING EXAMPLE>>\nGiven:\n - A {{5}} point ticket for connecting Athina to Angora\n - Two routes:\n1) Athina to Smyrna ([[length]] = {{2}})\n2) Smyrna to Angora ([[length]] = {{3}})\n\nTotal points received for completing both routes = <<11 POINTS>>:\n - 2 pts: complete route #1\n - 4 pts: complete route #2\n - 5 pts: complete ticket",
      "testCases": [
        {
          "title": "One ticket, three routes",
          "isTest": true,
          "testIn": "6 1 3\n1 2 0 0 0 0 3 0 0\n6 Zurich Budapest\n1 0 Red Wien Budapest\n2 0 Yellow Zurich Munchen\n3 0 Orange Munchen Wien",
          "testOut": "13",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "One ticket, two routes",
          "isTest": false,
          "testIn": "6 1 2\n3 3 0 0 0 0 0 0 0\n6 Warszawa Smolensk\n3 0 Red Warszawa Wilno\n3 0 Yellow Wilno Smolensk",
          "testOut": "14",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Colored route 1",
          "isTest": true,
          "testIn": "4 0 1\n4 0 0 0 0 0 0 0 0\n4 0 Red Pamplona Marseille",
          "testOut": "7",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Colored route 1",
          "isTest": false,
          "testIn": "4 0 1\n0 0 4 0 0 0 0 0 0\n4 0 Green Riga Wilno",
          "testOut": "7",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Colored route 2",
          "isTest": true,
          "testIn": "2 0 1\n0 0 2 0 0 0 0 0 0\n2 0 Green Kharkov Rostov",
          "testOut": "2",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Colored route 2",
          "isTest": false,
          "testIn": "1 0 1\n0 0 0 0 1 0 0 0 0\n1 0 White Wien Budapest",
          "testOut": "1",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Car shortage",
          "isTest": true,
          "testIn": "1 0 1\n2 2 2 2 2 2 2 2 2\n2 0 Orange Smolensk Moskva",
          "testOut": "0",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Car shortage",
          "isTest": false,
          "testIn": "1 0 1\n3 3 3 3 3 3 3 3 3\n3 0 Orange Munchen Wien",
          "testOut": "0",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Card shortage",
          "isTest": true,
          "testIn": "2 0 1\n2 2 2 2 2 2 1 2 0\n2 0 Orange Smolensk Moskva",
          "testOut": "0",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Card shortage",
          "isTest": false,
          "testIn": "3 0 1\n3 3 3 3 3 3 0 3 0\n3 0 Orange Munchen Wien",
          "testOut": "0",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Use an engine",
          "isTest": true,
          "testIn": "2 0 1\n2 2 2 2 2 2 1 2 1\n2 0 Orange Smolensk Moskva",
          "testOut": "2",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Use some engines",
          "isTest": false,
          "testIn": "3 0 1\n3 3 3 3 3 3 0 3 3\n3 0 Orange Munchen Wien",
          "testOut": "4",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Gray route",
          "isTest": true,
          "testIn": "4 0 1\n4 0 0 0 0 0 0 0 0\n4 0 Gray Berlin Danzig",
          "testOut": "7",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Gray route",
          "isTest": false,
          "testIn": "4 0 1\n0 4 0 0 0 0 0 0 0\n4 0 Gray Riga Petrograd",
          "testOut": "7",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Gray mixed colors",
          "isTest": true,
          "testIn": "4 0 1\n1 0 1 0 1 0 1 0 1\n4 0 Gray Berlin Danzig",
          "testOut": "0",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Gray mixed colors",
          "isTest": false,
          "testIn": "4 0 1\n1 0 1 0 1 0 1 0 1\n4 0 Gray Riga Petrograd",
          "testOut": "0",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Ferry",
          "isTest": true,
          "testIn": "6 0 1\n0 0 4 0 0 0 0 0 2\n6 2 Gray Palermo Smyrna",
          "testOut": "15",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Ferry",
          "isTest": false,
          "testIn": "2 0 1\n0 0 0 1 0 0 0 0 1\n2 1 Gray Dieppe London",
          "testOut": "2",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Engine shortage",
          "isTest": true,
          "testIn": "6 0 1\n0 0 6 0 0 0 0 0 1\n6 2 Gray Palermo Smyrna",
          "testOut": "0",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Engine shortage",
          "isTest": false,
          "testIn": "2 0 1\n0 0 0 2 0 0 0 0 0\n2 1 Gray Dieppe London",
          "testOut": "0",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Two routes",
          "isTest": true,
          "testIn": "6 0 2\n4 0 0 0 0 0 2 0 0\n4 0 Gray Berlin Danzig\n2 0 Orange Smolensk Moskva",
          "testOut": "9",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Two routes",
          "isTest": false,
          "testIn": "7 0 2\n4 0 0 0 0 0 3 0 0\n4 0 Gray Riga Petrograd\n3 0 Orange Munchen Wien",
          "testOut": "11",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Expend cars",
          "isTest": true,
          "testIn": "4 0 2\n4 0 0 0 0 0 2 0 0\n4 0 Gray Berlin Danzig\n2 0 Orange Smolensk Moskva",
          "testOut": "7",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Expend cars",
          "isTest": false,
          "testIn": "4 0 2\n4 0 0 0 0 0 3 0 0\n4 0 Gray Riga Petrograd\n3 0 Orange Munchen Wien",
          "testOut": "7",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Expend cards",
          "isTest": true,
          "testIn": "6 0 2\n0 0 0 0 0 0 5 0 0\n4 0 Gray Berlin Danzig\n2 0 Orange Smolensk Moskva",
          "testOut": "7",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Expend cards",
          "isTest": false,
          "testIn": "7 0 2\n0 0 0 0 0 0 5 0 0\n4 0 Gray Riga Petrograd\n3 0 Orange Munchen Wien",
          "testOut": "7",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Simple ticket",
          "isTest": true,
          "testIn": "6 1 3\n0 0 2 0 2 2 0 0 0\n6 Zurich Brindisi\n2 0 Green Zurich Venezia\n2 0 White Brindisi Roma\n2 0 Black Venezia Roma",
          "testOut": "12",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Simple ticket",
          "isTest": false,
          "testIn": "6 1 3\n1 2 0 0 0 0 3 0 0\n6 Zurich Budapest\n2 0 Yellow Zurich Munchen\n3 0 Orange Wien Munchen\n1 0 Red Wien Budapest",
          "testOut": "13",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Rules: Incomplete ticket",
          "isTest": true,
          "testIn": "4 1 3\n1 0 0 2 1 5 3 2 1\n5 Athena Angora\n3 0 Red Frankfurt Berlin\n6 2 Gray Palermo Smyrna\n6 0 Gray Budapest Kyiv",
          "testOut": "-5",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Rules: Incomplete ticket",
          "isTest": false,
          "testIn": "6 1 4\n1 2 5 1 0 0 0 0 0\n9 Berlin Roma\n3 0 White Madrid Pamplona\n3 0 Orange Cadiz Madrid\n4 0 Black Edinburgh London\n2 1 Gray Athina Smyrna",
          "testOut": "-9",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Multiple tickets",
          "isTest": true,
          "testIn": "15 3 8\n4 3 4 1 0 0 2 1 4\n2 Lisboa Cadiz\n5 Rostov Erzurum\n8 Barcelona Munchen\n2 0 Gray Sochi Rostov\n3 0 Red Sochi Erzurum\n2 0 Blue Cadiz Lisboa\n4 0 Gray Barcelona Marseille\n2 0 Pink Marseille Zurich\n2 0 Yellow Zurich Munchen\n6 0 Gray Budapest Kyiv\n1 0 White Wien Budapest",
          "testOut": "34",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Multiple tickets",
          "isTest": false,
          "testIn": "16 4 9\n0 0 2 1 3 4 3 1 4\n3 London Paris\n3 Berlin Wein\n5 Frankfurt Kobenhavn\n5 Athena Angora\n3 0 Green Berlin Wein\n2 0 Green Frankfurt Essen\n3 1 Gray Kobenhavn Essen\n1 0 Pink Dieppe Paris\n2 1 Gray Athina Smyrna\n3 0 Black Frankfurt Berlin\n2 0 Blue Berlin Essen\n6 2 Gray Smyrna Palermo\n3 0 Orange Angora Smyrna",
          "testOut": "21",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Engines and gray routes",
          "isTest": true,
          "testIn": "12 0 5\n0 0 3 2 0 4 0 0 3\n6 2 Gray Smyrna Palermo\n4 0 Gray Bucuresti Kyiv\n2 1 Gray Sevastopol Sochi\n4 0 Green Wilno Riga\n4 0 Blue Wilno Petrograd",
          "testOut": "22",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Engines and gray routes",
          "isTest": false,
          "testIn": "12 0 5\n4 3 0 2 0 3 0 0 3\n6 2 Gray Smyrna Palermo\n4 0 Gray Berlin Danzig\n4 0 Blue Wien Warszawa\n2 0 Pink Marseille Zurich\n2 0 Yellow Zurich Munchen",
          "testOut": "24",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Shades of gray",
          "isTest": true,
          "testIn": "6 1 2\n4 2 0 0 0 0 0 0 0\n3 Dieppe Brighton\n2 0 Gray Dieppe London\n4 0 Gray London Brighton",
          "testOut": "12",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Shades of gray",
          "isTest": false,
          "testIn": "7 1 2\n4 3 0 0 0 0 0 0 0\n3 Dieppe Brighton\n3 0 Gray Dieppe London\n4 0 Gray London Brighton",
          "testOut": "14",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Shades of gray 2",
          "isTest": true,
          "testIn": "4 2 3\n2 1 0 0 0 0 0 0 1\n15 Dieppe London\n5 London Brighton\n2 0 Gray Dieppe London\n2 0 Red London Brighton\n1 0 Yellow Orleans Rouen",
          "testOut": "24",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Shades of gray 2",
          "isTest": false,
          "testIn": "4 2 3\n2 0 1 0 0 0 0 0 1\n15 Dieppe London\n5 London Brighton\n2 0 Gray Dieppe London\n2 0 Red London Brighton\n1 0 Green Orleans Rouen",
          "testOut": "24",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "The long trap",
          "isTest": true,
          "testIn": "4 4 3\n3 0 0 0 0 0 0 0 0\n3 Manchester London\n2 Dieppe Paris\n2 Lille Paris\n1 Dieppe Lille\n3 0 Red Manchester London\n2 0 Red Dieppe Paris\n1 0 Red Paris Lille",
          "testOut": "5",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "The long trap",
          "isTest": false,
          "testIn": "4 4 3\n3 0 0 0 0 0 0 0 0\n3 Manchester London\n2 Dieppe Paris\n2 Rouen Paris\n1 Dieppe Rouen\n3 0 Red Manchester London\n2 0 Red Dieppe Paris\n1 0 Red Paris Rouen",
          "testOut": "5",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Another long trap",
          "isTest": true,
          "testIn": "6 0 3\n6 0 0 0 0 0 0 0 0\n4 0 Red Manchester London\n3 0 Red Dieppe Paris\n3 0 Red Paris Luton",
          "testOut": "8",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Another long trap",
          "isTest": false,
          "testIn": "6 0 3\n6 0 0 0 0 0 0 0 0\n4 0 Red Manchester London\n3 0 Red Dieppe Paris\n3 0 Red Paris Rouen",
          "testOut": "8",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "The middle trap",
          "isTest": true,
          "testIn": "12 0 4\n6 6 0 0 0 0 0 0 0\n6 0 Yellow Bodmin Wenford\n4 0 Red Manchester London\n3 0 Red Dieppe Paris\n3 0 Red Paris Luton",
          "testOut": "23",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "The middle trap",
          "isTest": false,
          "testIn": "12 0 4\n6 6 0 0 0 0 0 0 0\n6 0 Yellow Bodmin Wenford\n4 0 Red Manchester London\n3 0 Red Dieppe Paris\n3 0 Red Paris Rouen",
          "testOut": "23",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Multi-purpose routes",
          "isTest": true,
          "testIn": "16 5 15\n3 2 0 2 4 3 3 2 5\n3 Berlin Wien\n9 Berlin Roma\n3 London Paris\n5 Dieppe Marseille\n7 Brest Marseille\n2 1 Gray Dieppe London\n1 0 Pink Dieppe Paris\n4 0 Gray Paris Marseille\n3 0 Black Brest Paris\n4 0 Red Marseille Pamplona\n3 0 Gray Paris Zurich\n2 0 Pink Zurich Marseille\n3 0 Green Berlin Wien\n2 0 Gray Zagrab Wien\n2 0 Gray Zagrab Venezia\n2 0 Black Roma Venezia\n4 0 Orange London Edinburgh\n2 0 Orange Dieppe Brest\n1 0 Black Amsterdam Bruxelles\n2 2 Gray London Amsterdam",
          "testOut": "41",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Multi-purpose routes",
          "isTest": false,
          "testIn": "16 5 14\n3 2 0 2 4 3 3 2 5\n3 Berlin Wien\n9 Berlin Roma\n3 London Paris\n5 Dieppe Marseille\n7 Brest Marseille\n2 1 Gray Dieppe London\n1 0 Pink Dieppe Paris\n4 0 Gray Paris Marseille\n2 0 Orange Brest Dieppe\n3 0 Gray Paris Zurich\n2 0 Pink Paris Marseille\n3 0 Green Berlin Wien\n2 0 Gray Zagrab Wien\n2 0 Gray Zagrab Venezia\n2 0 Black Roma Venezia\n3 0 Black Brest Paris\n4 0 Pink Pamplona Brest\n4 0 Red Marseille Paris\n2 0 Gray Barcelona Pamplona",
          "testOut": "44",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Oh, the possibilities!",
          "isTest": true,
          "testIn": "24 5 20\n4 3 5 3 3 3 6 6 4\n21 Cadiz Stockholm\n8 Marseille Essen\n8 Madrid Zurich\n8 Madrid Dieppe\n7 Amsterdam Pamplona\n3 0 Orange Cadiz Madrid\n3 0 White Madrid Pamplona\n2 0 Yellow Madrid Barcelona\n2 0 Gray Barcelona Pamplona\n4 0 Green Pamplona Paris\n2 0 Pink Marseille Zurich\n3 0 Gray Zurich Paris\n1 0 Pink Paris Dieppe\n2 0 Red Paris Bruxelles\n2 0 Green Dieppe Bruxelles\n2 0 Blue Bruxelles Frankfurt\n2 0 Yellow Zurich Munchen\n2 0 Pink Munchen Frankfurt\n2 0 Green Essen Frankfurt\n3 0 Orange Paris Frankfurt\n3 0 Yellow Amsterdam Essen\n2 0 White Frankfurt Amsterdam\n1 0 Black Bruxelles Amsterdam\n3 1 Gray Essen Kobenhavn\n3 0 White Kobenhavn Stockholm",
          "testOut": "51",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Oh, the possibilities!",
          "isTest": false,
          "testIn": "25 5 20\n2 5 5 4 5 3 5 7 3\n21 Cadiz Stockholm\n8 Marseille Essen\n8 Madrid Zurich\n8 Madrid Dieppe\n7 Amsterdam Pamplona\n3 0 Orange Cadiz Madrid\n3 0 Black Madrid Pamplona\n2 0 Yellow Madrid Barcelona\n2 0 Gray Barcelona Pamplona\n4 0 Blue Pamplona Paris\n2 0 Pink Marseille Zurich\n3 0 Gray Zurich Paris\n1 0 Pink Paris Dieppe\n2 0 Yellow Paris Bruxelles\n2 0 Green Dieppe Bruxelles\n2 0 Blue Bruxelles Frankfurt\n2 0 Yellow Zurich Munchen\n2 0 Pink Munchen Frankfurt\n2 0 Green Essen Frankfurt\n3 0 White Paris Frankfurt\n3 0 Yellow Amsterdam Essen\n2 0 White Frankfurt Amsterdam\n1 0 Black Bruxelles Amsterdam\n3 1 Gray Essen Kobenhavn\n3 0 White Kobenhavn Stockholm",
          "testOut": "56",
          "isValidator": true,
          "needValidation": true
        }
      ],
      "difficulty": "expert",
      "constraints": "{{0}} ≤ [[trainCars]] < {{30}}\n{{0}} ≤ [[numTickets]] < {{30}}\n{{0}} ≤ [[numRoutes]] < {{30}}",
      "coverBinaryId": 55532548865311,
      "stubGenerator": "read trainCars:int numTickets:int numRoutes:int\nread red:int yellow:int green:int blue:int white:int black:int orange:int pink:int engine:int\nloop numTickets read points:int cityA:word(32) cityB:word(32)\nloop numRoutes read length:int requiredEngines:int color:word(6) cityA:word(32) cityB:word(32)\nwrite points",
      "inputDescription": "<<Line 1:>> Three space-separated integers: number of [[trainCars]], number of tickets ([[numTickets]]) you have, and number of available routes ([[numRoutes]]) on the board.\n\n<<Line 2:>> Nine space-separated integers for the number of [[red]], [[yellow]], [[green]], [[blue]], [[white]], [[black]], [[orange]], [[pink]], and [[engine]] cards you have in your hand.\n\n<<Next [[numTickets]] lines:>> One line for each ticket in your hand. Each line has an integer for the [[points]] value of the ticket, followed by two space-separated city names.\n\n<<Next [[numRoutes]] lines:>> One line for each available route on the board. Each line has an integer for the [[length]] of the route (in number of train cars), an integer for the number of [[requiredEngines]], a [[color]] ({{Red}}, {{Yellow}}, {{Green}}, {{Blue}}, {{White}}, {{Black}}, {{Orange}}, {{Pink}}, or {{Gray}}), and two space-separated city names.",
      "solutionLanguage": "C#",
      "outputDescription": "A single integer indicating the maximum possible score."
    },
    "draft": false,
    "readyForModeration": true,
    "statementHTML": "<div class=\"statement-body\">\n<div class=\"statement-section statement-goal\">\n   <h2><span class=\"icon icon-goal\">&nbsp;</span><span>Goal </span></h2>\n   <span class=\"question-statement\">Ticket to Ride is a classic board game by Alan Moon and Days of Wonder in which you earn points by connecting cities via train routes. In this puzzle, you must calculate the maximum possible score in a Ticket to Ride scenario.<br><br><strong>EARNING POINTS</strong><br> - Each completed route provides a certain number of points.<br> - Each completed ticket card earns you a certain number of bonus points.<br> - Ticket cards that are not completed are worth negative points.<br><br><strong>COMPLETING ROUTES</strong><br>Each route connects two cities, and requires you to expend two resources, both <var>trainCars</var> and cards, to complete it. The <var>length</var> of the route informs you how many of each resource are required. A route of <var>length</var> = <const>3</const> requires 3 <var>trainCars</var> <strong>AND</strong> 3 cards.<br><br><strong>STARTING GAME STATE</strong><br>You will be provided with:<br> - Number of <var>trainCars</var> available for use. (Resource #1)<br> - Number and type of cards in your hand (Resource #2)<br> - Number and nature of tickets in your hand.<br> - A list of available routes on the board, and the resources required to complete each one.<br><br><strong>SCORING ROUTES</strong><br>Points awarded for completing a route are based on the route <var>length</var>:<br> - length of 1: 1 pt<br> - length of 2: 2 pts<br> - length of 3: 4 pts<br> - length of 4: 7 pts<br> - length of 6: 15 pts<br><br><strong>SCORING TICKETS</strong><br>Each ticket specifies two cities and a number of bonus points to be earned. If the two cities are connected via train routes (either directly or indirectly) then the points for the ticket are added to your score. If not, then the ticket&rsquo;s points are deducted from your score.<br><br><strong>CARDS AND ROUTES</strong><br>Each <strong>card</strong> in your hand is EITHER a colored card (<const>8</const> colors available) OR an engine card (wild). Likewise, each <strong>route</strong> is EITHER one of the <const>8</const> colors, OR is <const>Gray</const>. To complete a colored route, you must expend  <var>length</var> cards <strong>of the SAME color</strong> from your hand. So, to complete a <const>Pink</const> route of <var>length</var> = <const>3</const>, you would need to expend 3 pink cards.<br><br><strong>ENGINE CARDS</strong><br>Engines are wild, and can be used as a substitute for any colored card.<br><br><strong>GRAY ROUTES</strong><br><const>Gray</const> routes can be any color you want them to be. However, to complete a <const>Gray</const> route, the cards you expend <strong>MUST</strong> be all of the same color (potentially supplemented with engines).<br><br><strong>FERRIES</strong><br>Some <const>Gray</const> routes (called &ldquo;ferries&rdquo;) require that a certain number of the cards you expend <strong>MUST</strong> be engine cards.<br><br><strong>FERRY EXAMPLE</strong><br>A ferry of <var>length</var> = <const>3</const> and <var>requiredEngines</var> = <const>1</const> could be completed with:<br> - 2 red cards and 1 engine,<br> - 1 black and 2 engines,<br> - but <strong>NOT</strong> 3 blue cards,<br> - and <strong>NOT</strong> 1 green, 1 yellow, and 1 engine<br><br><strong>SCORING EXAMPLE</strong><br>Given:<br> - A <const>5</const> point ticket for connecting Athina to Angora<br> - Two routes:<br>1) Athina to Smyrna (<var>length</var> = <const>2</const>)<br>2) Smyrna to Angora (<var>length</var> = <const>3</const>)<br><br>Total points received for completing both routes = <strong>11 POINTS</strong>:<br> - 2 pts: complete route #1<br> - 4 pts: complete route #2<br> - 5 pts: complete ticket</span>\n</div>\n<div class=\"statement-section statement-protocol\">\n   <div class=\"blk\">\n      <div class=\"title\">Input</div>\n      <div class=\"question-statement-input\"><strong>Line 1:</strong> Three space-separated integers: number of <var>trainCars</var>, number of tickets (<var>numTickets</var>) you have, and number of available routes (<var>numRoutes</var>) on the board.<br><br><strong>Line 2:</strong> Nine space-separated integers for the number of <var>red</var>, <var>yellow</var>, <var>green</var>, <var>blue</var>, <var>white</var>, <var>black</var>, <var>orange</var>, <var>pink</var>, and <var>engine</var> cards you have in your hand.<br><br><strong>Next <var>numTickets</var> lines:</strong> One line for each ticket in your hand. Each line has an integer for the <var>points</var> value of the ticket, followed by two space-separated city names.<br><br><strong>Next <var>numRoutes</var> lines:</strong> One line for each available route on the board. Each line has an integer for the <var>length</var> of the route (in number of train cars), an integer for the number of <var>requiredEngines</var>, a <var>color</var> (<const>Red</const>, <const>Yellow</const>, <const>Green</const>, <const>Blue</const>, <const>White</const>, <const>Black</const>, <const>Orange</const>, <const>Pink</const>, or <const>Gray</const>), and two space-separated city names.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Output</div>\n      <div class=\"question-statement-output\">A single integer indicating the maximum possible score.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Constraints</div>\n      <div class=\"question-statement-constraints\"><const>0</const> &le; <var>trainCars</var> &lt; <const>30</const><br><const>0</const> &le; <var>numTickets</var> &lt; <const>30</const><br><const>0</const> &le; <var>numRoutes</var> &lt; <const>30</const></div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Example</div>\n      <div class=\"statement-inout\">\n         <div class=\"statement-inout-in\">\n            <div class=\"title\">Input</div>\n            <pre class=\"question-statement-example-in\">6 1 3\n1 2 0 0 0 0 3 0 0\n6 Zurich Budapest\n1 0 Red Wien Budapest\n2 0 Yellow Zurich Munchen\n3 0 Orange Munchen Wien</pre>\n         </div>\n         <div class=\"statement-inout-out\">\n            <div class=\"title\">Output</div>\n            <pre class=\"question-statement-example-out\">13</pre>\n         </div>\n      </div>\n   </div>\n</div>"
  },
  "validatedFor": 290822888929,
  "avatar": 52487021619351,
  "commentCount": 23,
  "upVotes": 11,
  "downVotes": 1,
  "validateAction": {
    "actionId": 48344,
    "progress": 1,
    "alreadyDone": false
  },
  "statusHistory": [],
  "editable": true,
  "draft": false,
  "readyForModeration": true
}