{
  "id": 7678,
  "activeVersion": 11,
  "score": 6,
  "votableId": 20911251,
  "codingamerId": 4081634,
  "views": 178,
  "commentableId": 20805499,
  "title": "Code Breaker Puzzle",
  "status": "ACCEPTED",
  "type": "PUZZLE_INOUT",
  "nickname": "Wontonimo",
  "publicHandle": "7678a765bbb9954cb849f2c03804d4ae5ba2",
  "codingamerHandle": "d0699d9a8e4995e142b0a5cf6a16e1934361804",
  "lastVersion": {
    "version": 11,
    "autocloseTime": 1640046059904,
    "data": {
      "title": "Code Breaker Puzzle",
      "topics": [
        {
          "id": 61,
          "handle": "encoding",
          "category": "INTERMEDIATE",
          "labelMap": {
            "1": "Encodage",
            "2": "Encoding"
          },
          "pageTitle": "Encoding: exercises and theory",
          "puzzleCount": 12,
          "parentTopicId": 41,
          "contentDetailsId": 86
        },
        {
          "id": 46,
          "handle": "loops",
          "category": "FUNDAMENTALS",
          "labelMap": {
            "1": "Boucles",
            "2": "Loops"
          },
          "pageTitle": "Loops: exercises and theory",
          "puzzleCount": 58,
          "parentTopicId": 39,
          "contentDetailsId": 71
        }
      ],
      "solution": "import sys\n\nalphabet = input()\nmessage = input()\nword = input()\n\ndef decode(alphabet, message, word):\n    length = len(alphabet)\n    for a in range(length):\n        for b in range(1,length):\n            encoded = [ ((c+a)*b)%length for c in range(length) ]\n            mapping = [0]*length\n            for i,x in enumerate(encoded):\n                mapping[x] = i\n\n            result=\"\".join([alphabet[mapping[alphabet.index(c)]] for c in message])\n            if word in result:\n                return result,a,b\n\ndef encode(alphabet, message, a, b):\n    length = len(alphabet)\n    mapping = [ ((c+a)*b)%length for c in range(length) ]\n    return \"\".join([alphabet[mapping[alphabet.index(c)]] for c in message])\n\nresult, a, b = decode(alphabet, message, word)\nprint(result)",
      "statement": "Decode a secret message.  Each message is encoded using something a little more complicated than a Caesar cipher.  Unlike a Caesar cipher which can be expressed as (X+A)%L, where A is the cipher variable and L is the length of the alphabet, this encoding instead is expressed as ((X+A)*B)%L.  A is the shift and B is the multiply.  Your task is to discover the secret message from an alphabet, an encoded message, and a word that is guaranteed to be in the secret message.\n\n{{For this puzzle, the shift and multiply is not provided but the solution involves discovering it.  The shift and multiply may be different for every test case.}}\n\n<<There is only one unique solution to each test>>\n\nThe first 4 test cases have B=1 and therefore can be solved using a simple Caesar cipher.",
      "testCases": [
        {
          "title": "Hello world",
          "isTest": true,
          "testIn": "ABCDEFGHIJKLMNOPQRSTUVWXYZ_\nIFMMPAXPSME\nWORLD",
          "testOut": "HELLO_WORLD",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Hello world",
          "isTest": false,
          "testIn": "ABCDEFGHIJKLMNOPQRSTUVWXYZ_\nXPSMEAIFMMP\nWORLD",
          "testOut": "WORLD_HELLO",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Baking your code",
          "isTest": true,
          "testIn": "ABCDEFGHIJKLMNOPQRSTUVWXYZ_\nAPMHXQMHQ_HQVHAPMHWCMV\nPIE",
          "testOut": "THE_PIE_IS_IN_THE_OVEN",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Baking your code",
          "isTest": false,
          "testIn": "ABCDEFGHIJKLMNOPQRSTUVWXYZ_\nMAYTIBYTBLTBGTMAYTHOYG\nOVEN",
          "testOut": "THE_PIE_IS_IN_THE_OVEN",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Ominous",
          "isTest": true,
          "testIn": "ABCDE1FGH2IJK5LMN7OPQR8STU9VWXYZ_\nAVU5QVYWJVNQJVXQPVEVU5QVYWJPVD1Z_\nHIDE",
          "testOut": "1_YOU_CAN_RUN_BUT_2_YOU_CANT_HIDE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Ominous",
          "isTest": false,
          "testIn": "ABCDEFGHIJKLMNOPQRSTUVWXYZ_1234509876\nSRPFLR42EKRILER3LKRTRPFLR42ER7650\nCANT",
          "testOut": "1_YOU_CANT_RUN_BUT_2_YOU_CAN_HIDE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Common knowledge",
          "isTest": true,
          "testIn": "A1B2C3D4E5F6G7H8I9J0K-L+M=NOP;Q:R<S>T?U,V.W/XY|Z_\n/-8DA42D546OD+.D4D;S<0D,S47D+9D2SYD;S.8D2SY,D:4>PY<O<SA<\nUNKNOWN",
          "testOut": "THE_WAY_BACK_IS_A_LONG_ROAD_IF_YOU_LOSE_YOUR_MAP-UNKNOWN",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Common knowledge",
          "isTest": false,
          "testIn": "B2C3D4E5FA6G7H18I9J0K-L+M=N[O]P;Q:R<S>T?U,V.W/XY|Z_\n0,=;9[7B?1<],71B1|;5<B>;635B69[?B+9-5B4,>?9[7B3<];>B2]|\nDUSTING",
          "testOut": "JUMPING_THROUGH_HYPER_SPACE_AINT_LIKE_DUSTING_CROPS_BOY",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "First Multiplier",
          "isTest": true,
          "testIn": "ABCDEFGHIJKLMNOPQRSTUVWXYZ_\nNQVTMO_S\nWHAT",
          "testOut": "WHATS_UP",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "First Multiplier",
          "isTest": false,
          "testIn": "ABCDEFGHIJKLMNOPQRSTUVWXYZ_\nFXRFEHXIJOOCNA\nLIKE",
          "testOut": "I_LIKE_CARROTS",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "So Cryptic",
          "isTest": true,
          "testIn": "A1B2C3D4E5F6G7H8I9J0K-L+M=NOP;Q:R<S>T?U,V.W/XY|Z_\n_A74CNQM4N2VN_>45:M4VZNM4_A74VNQM\nALWAYS",
          "testOut": "YOU_CANT_ALWAYS_GET_WHAT_YOU_WANT",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "So Cryptic",
          "isTest": false,
          "testIn": "A1B2C3D4E5F6G7H8I9J0K-L+M=NOP;Q:R<S>T?U,V.W/XY|Z_\n3A2S<WSH.AS25HSD.-Y2<-YDSH.AS,Y2S/TE2SH.ASJYY_\nSOMETIMES",
          "testOut": "BUT_IF_YOU_TRY_SOMETIMES_YOU_GET_WHAT_YOU_NEED",
          "isValidator": true,
          "needValidation": true
        }
      ],
      "difficulty": "medium",
      "constraints": "The alphabet, message, and word are all limited to less than 200 characters\nThe shift and multiply are both less than or equal to the length of the alphabet",
      "stubGenerator": "read ALPHABET:string(200)\nread MESSAGE:string(200)\nread WORD:string(200)\nwrite HELLO_WORLD",
      "inputDescription": "<<Line 1:>> [[ALPHABET]] The characters in the cipher \n<<Line 2:>> [[MESSAGE]] The encrypted message\n<<Line 3:>> [[WORD]] The word that is in the message",
      "solutionLanguage": "Python3",
      "outputDescription": "<<Line 1>> Decrypted message"
    },
    "draft": false,
    "readyForModeration": true,
    "statementHTML": "<div class=\"statement-body\">\n<div class=\"statement-section statement-goal\">\n   <h2><span class=\"icon icon-goal\">&nbsp;</span><span>Goal </span></h2>\n   <span class=\"question-statement\">Decode a secret message.  Each message is encoded using something a little more complicated than a Caesar cipher.  Unlike a Caesar cipher which can be expressed as (X+A)%L, where A is the cipher variable and L is the length of the alphabet, this encoding instead is expressed as ((X+A)*B)%L.  A is the shift and B is the multiply.  Your task is to discover the secret message from an alphabet, an encoded message, and a word that is guaranteed to be in the secret message.<br><br><const>For this puzzle, the shift and multiply is not provided but the solution involves discovering it.  The shift and multiply may be different for every test case.</const><br><br><strong>There is only one unique solution to each test</strong><br><br>The first 4 test cases have B=1 and therefore can be solved using a simple Caesar cipher.</span>\n</div>\n<div class=\"statement-section statement-protocol\">\n   <div class=\"blk\">\n      <div class=\"title\">Input</div>\n      <div class=\"question-statement-input\"><strong>Line 1:</strong> <var>ALPHABET</var> The characters in the cipher <br><strong>Line 2:</strong> <var>MESSAGE</var> The encrypted message<br><strong>Line 3:</strong> <var>WORD</var> The word that is in the message</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Output</div>\n      <div class=\"question-statement-output\"><strong>Line 1</strong> Decrypted message</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Constraints</div>\n      <div class=\"question-statement-constraints\">The alphabet, message, and word are all limited to less than 200 characters<br>The shift and multiply are both less than or equal to the length of the alphabet</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Example</div>\n      <div class=\"statement-inout\">\n         <div class=\"statement-inout-in\">\n            <div class=\"title\">Input</div>\n            <pre class=\"question-statement-example-in\">ABCDEFGHIJKLMNOPQRSTUVWXYZ_\nIFMMPAXPSME\nWORLD</pre>\n         </div>\n         <div class=\"statement-inout-out\">\n            <div class=\"title\">Output</div>\n            <pre class=\"question-statement-example-out\">HELLO_WORLD</pre>\n         </div>\n      </div>\n   </div>\n</div>"
  },
  "validatedFor": 133178441390,
  "avatar": 54970169109216,
  "commentCount": 19,
  "upVotes": 8,
  "downVotes": 2,
  "validateAction": {
    "actionId": 609482,
    "progress": 1,
    "alreadyDone": false
  },
  "statusHistory": [
    {
      "status": "ACCEPTED",
      "date": 1637551792984,
      "data": {
        "author": "ACTION"
      }
    }
  ],
  "editable": true,
  "draft": false,
  "readyForModeration": true
}