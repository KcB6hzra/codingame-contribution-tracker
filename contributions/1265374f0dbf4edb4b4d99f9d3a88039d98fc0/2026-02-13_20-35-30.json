{
  "id": 126537,
  "activeVersion": 26,
  "score": 0,
  "votableId": 37330300,
  "codingamerId": 6132028,
  "views": 108,
  "commentableId": 37169388,
  "title": "Hidden Links",
  "status": "PENDING",
  "type": "PUZZLE_INOUT",
  "nickname": "NicknamedTwice",
  "publicHandle": "1265374f0dbf4edb4b4d99f9d3a88039d98fc0",
  "codingamerHandle": "d2434fa80c97cbc8809e37d800f205eb8202316",
  "lastVersion": {
    "version": 26,
    "autocloseTime": 1773606642546,
    "freezeTime": 1771619442546,
    "data": {
      "title": "Hidden Links",
      "topics": [
        {
          "id": 100,
          "handle": "graph-theory",
          "category": "INTERMEDIATE",
          "labelMap": {
            "1": "Graph theory",
            "2": "Graph theory"
          },
          "puzzleCount": 5,
          "parentTopicId": 93
        }
      ],
      "solution": "MOD = 10**9 + 7\nn = gets.to_i\na, b = gets.split.map &:to_i\nA = [nil] + (1..n).map { |i| ((i * a + b) % n) + 1 }\ndeg = Array.new(n + 1, 0)\nind = Array.new(n + 1, 0)\n\n(1..n).each { |i| ind[A[i]] += 1; deg[A[i]] += 1 }\n\nq = (1..n).select { |i| ind[i].zero? }\ntree = Array.new(n + 1, false)\n\nwhile u = q.shift\n  tree[u] = true\n  v = A[u]\n  ind[v] -= 1\n  q << v if ind[v].zero?\nend\n\nres = 1\n(1..n).each { |i| res = res * (deg[i] + 1) % MOD if tree[i] }\n\nvis = tree.dup\n(1..n).each do |i|\n  next if vis[i]\n  u, m, p, s = i, 0, 1, 0\n  until vis[u]\n    vis[u] = true\n    d = deg[u]\n    m += 1\n    p = p * (d + 1) % MOD\n    s += d\n    u = A[u]\n  end\n  res = res * ((m > 1 ? p - s : 1) % MOD) % MOD\nend\n\nputs res\n\n=begin\nPython solution\n\nfrom collections import Counter, deque\n\nMOD = 10**9+7\nn = int(input())\na, b = map(int, input().split())\nf = [0] + [((i*a + b) % n) + 1 for i in range(1, n+1)]\n\ndeg = Counter(f[1:])\nind = deg.copy()\n\nq = deque(i for i in range(1, n+1) if ind[i] == 0)\ntree = [0] * (n+1)\n\nwhile q:\n    u = q.popleft()\n    tree[u] = True\n    v = f[u]\n    ind[v] -= 1\n    if ind[v] == 0:\n        q.append(v)\n\nres = 1\nfor i in range(1, n+1):\n    if tree[i]:\n        res = res * (deg[i] + 1) % MOD\n\nvis = tree[:]\nfor i in range(1, n+1):\n    if not vis[i]:\n        u, m, P, S = i, 0, 1, 0\n        while not vis[u]:\n            vis[u] = True\n            d = deg[u]\n            S += d\n            P = P * (d + 1) % MOD\n            m += 1\n            u = f[u]\n        if m > 1:\n            res = res * ((P - S) % MOD) % MOD\n\nprint(res)\n=end\n",
      "statement": "A secure device holds [[n]] code-chips numbered from 1 to [[n]], each placed in a distinct slot. Each chip [[i]] has a secret pointer [[P]][﻿[[i]]﻿] (also between 1 and [[n]]) that moves with the chip wherever it goes.\nWhen you trigger a slot [[j]]:\n\n<<1)>> Look at the chip currently in slot [[j]]; suppose it’s chip [[c]].\n<<2)>> Look up the pointer [[P]][﻿[[c]]﻿].\n<<3)>> Swap the chips in slot [[j]] and slot [[P]][﻿[[c]]﻿].\n\nYou may trigger any slot any number of times (including zero).\n\nFind the number of distinct chip configurations [[r]] reachable by performing any sequence of these swaps starting from the initial ordered configuration.\n\nPrint this number modulo <<{{10^9 + 7}}>>.\n\nYou are not given the array [[P]] directly. Instead, you must generate it yourself using the formula:\n\n`[[P]][﻿[[i]]﻿] = (([[i]] * [[a]] + [[b]]) mod [[n]]) + 1`\nfor all [[i]] from 1 to [[n]].",
      "testCases": [
        {
          "title": "Test 1",
          "isTest": true,
          "testIn": "1\n1 1",
          "testOut": "1",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 1",
          "isTest": false,
          "testIn": "2\n2 2",
          "testOut": "1",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 2",
          "isTest": true,
          "testIn": "4\n1 2",
          "testOut": "12",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 2",
          "isTest": false,
          "testIn": "5\n1 1",
          "testOut": "27",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 3",
          "isTest": true,
          "testIn": "6\n1 2",
          "testOut": "8",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 3",
          "isTest": false,
          "testIn": "10\n2 6",
          "testOut": "73",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 4",
          "isTest": true,
          "testIn": "11\n2021 1337",
          "testOut": "1014",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 4",
          "isTest": false,
          "testIn": "7\n1335 69",
          "testOut": "58",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 5",
          "isTest": true,
          "testIn": "10\n7 3",
          "testOut": "144",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 5",
          "isTest": false,
          "testIn": "12\n3 7",
          "testOut": "10",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 6",
          "isTest": true,
          "testIn": "100\n2 5",
          "testOut": "355266061",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 6",
          "isTest": false,
          "testIn": "120\n5 2",
          "testOut": "28515516",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 7",
          "isTest": true,
          "testIn": "1000\n54321 9876",
          "testOut": "688422210",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 7",
          "isTest": false,
          "testIn": "1500\n98765 12345",
          "testOut": "949407419",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 8",
          "isTest": true,
          "testIn": "999999\n987654321 123456789",
          "testOut": "944759232",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 8",
          "isTest": false,
          "testIn": "1000000\n123456789 987654321",
          "testOut": "140725974",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 9",
          "isTest": true,
          "testIn": "5\n3 7",
          "testOut": "12",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 9",
          "isTest": false,
          "testIn": "7\n4 6",
          "testOut": "25",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 10",
          "isTest": true,
          "testIn": "11\n17 99",
          "testOut": "1014",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 10",
          "isTest": false,
          "testIn": "13\n19 100",
          "testOut": "4084",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 11",
          "isTest": true,
          "testIn": "3000\n4321 8765",
          "testOut": "897891737",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 11",
          "isTest": false,
          "testIn": "2500\n1234 5678",
          "testOut": "77380078",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 12",
          "isTest": true,
          "testIn": "10000\n9999 123",
          "testOut": "930096291",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 12",
          "isTest": false,
          "testIn": "12000\n8888 1111",
          "testOut": "142015878",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 13",
          "isTest": true,
          "testIn": "65536\n33 77",
          "testOut": "111437982",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 13",
          "isTest": false,
          "testIn": "32768\n44 88",
          "testOut": "439462079",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 14",
          "isTest": true,
          "testIn": "999983\n10007 10009",
          "testOut": "632152542",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 14",
          "isTest": false,
          "testIn": "999979\n10013 10021",
          "testOut": "145536392",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Test 15",
          "isTest": true,
          "testIn": "1000000\n424242 999999937",
          "testOut": "742220637",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 15",
          "isTest": false,
          "testIn": "1000000\n999999937 424242",
          "testOut": "647211366",
          "isValidator": true,
          "needValidation": true
        }
      ],
      "difficulty": "expert",
      "constraints": "1 ≤ [[n]] ≤ 10^6\n1 ≤ [[a]], [[b]] ≤ 10^9\n1 ≤ [[P]][﻿[[i]]﻿] ≤ [[n]]",
      "coverBinaryId": 145442988289291,
      "stubGenerator": "read n:int\nread a:int b:int\nwrite Good Luck!",
      "inputDescription": "<<Line 1:>> A single integer [[n]].\n<<Line 2:>> Two space-separated integers [[a]] and [[b]].",
      "solutionLanguage": "Ruby",
      "outputDescription": "<<Line 1:>> A single integer [[r]], modulo <<{{10^9 + 7}}>>."
    },
    "draft": false,
    "readyForModeration": true,
    "statementHTML": "<div class=\"statement-body\">\n<div class=\"statement-section statement-goal\">\n   <h2><span class=\"icon icon-goal\">&nbsp;</span><span>Goal </span></h2>\n   <span class=\"question-statement\">A secure device holds <var>n</var> code-chips numbered from 1 to <var>n</var>, each placed in a distinct slot. Each chip <var>i</var> has a secret pointer <var>P</var>[﻿<var>i</var>﻿] (also between 1 and <var>n</var>) that moves with the chip wherever it goes.<br>When you trigger a slot <var>j</var>:<br><br><strong>1)</strong> Look at the chip currently in slot <var>j</var>; suppose it&rsquo;s chip <var>c</var>.<br><strong>2)</strong> Look up the pointer <var>P</var>[﻿<var>c</var>﻿].<br><strong>3)</strong> Swap the chips in slot <var>j</var> and slot <var>P</var>[﻿<var>c</var>﻿].<br><br>You may trigger any slot any number of times (including zero).<br><br>Find the number of distinct chip configurations <var>r</var> reachable by performing any sequence of these swaps starting from the initial ordered configuration.<br><br>Print this number modulo <strong><const>10^9 + 7</const></strong>.<br><br>You are not given the array <var>P</var> directly. Instead, you must generate it yourself using the formula:<br><br><pre style=\"font-family: monospace\"><var>P</var>[﻿<var>i</var>﻿] = ((<var>i</var> * <var>a</var> + <var>b</var>) mod <var>n</var>) + 1</pre><br>for all <var>i</var> from 1 to <var>n</var>.</span>\n</div>\n<div class=\"statement-section statement-protocol\">\n   <div class=\"blk\">\n      <div class=\"title\">Input</div>\n      <div class=\"question-statement-input\"><strong>Line 1:</strong> A single integer <var>n</var>.<br><strong>Line 2:</strong> Two space-separated integers <var>a</var> and <var>b</var>.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Output</div>\n      <div class=\"question-statement-output\"><strong>Line 1:</strong> A single integer <var>r</var>, modulo <strong><const>10^9 + 7</const></strong>.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Constraints</div>\n      <div class=\"question-statement-constraints\">1 &le; <var>n</var> &le; 10^6<br>1 &le; <var>a</var>, <var>b</var> &le; 10^9<br>1 &le; <var>P</var>[﻿<var>i</var>﻿] &le; <var>n</var></div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Example</div>\n      <div class=\"statement-inout\">\n         <div class=\"statement-inout-in\">\n            <div class=\"title\">Input</div>\n            <pre class=\"question-statement-example-in\">1\n1 1</pre>\n         </div>\n         <div class=\"statement-inout-out\">\n            <div class=\"title\">Output</div>\n            <pre class=\"question-statement-example-out\">1</pre>\n         </div>\n      </div>\n   </div>\n</div>"
  },
  "avatar": 136778820182751,
  "commentCount": 5,
  "upVotes": 0,
  "downVotes": 0,
  "statusHistory": [],
  "editable": true,
  "draft": false,
  "readyForModeration": true
}