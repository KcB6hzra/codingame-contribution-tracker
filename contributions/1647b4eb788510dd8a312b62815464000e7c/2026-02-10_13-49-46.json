{
  "id": 1647,
  "activeVersion": 17,
  "score": -5,
  "votableId": 8984599,
  "codingamerId": 2802559,
  "views": 412,
  "commentableId": 8919544,
  "title": "Encryption/Decryption of Enigma Machine",
  "status": "ACCEPTED",
  "type": "PUZZLE_INOUT",
  "nickname": "SudeepMukherjee",
  "publicHandle": "1647b4eb788510dd8a312b62815464000e7c",
  "codingamerHandle": "3b034ff8e396772b3271686d470b78bd9552082",
  "lastVersion": {
    "version": 17,
    "autocloseTime": 1541232336884,
    "data": {
      "title": "Encryption/Decryption of Enigma Machine",
      "topics": [
        {
          "id": 74,
          "handle": "cryptology",
          "labelMap": {
            "1": "Cryptologie",
            "2": "Cryptography"
          },
          "pageTitle": "Cryptography: exercises and theory",
          "puzzleCount": 2,
          "parentTopicId": 43,
          "contentDetailsId": 105
        },
        {
          "id": 112,
          "handle": "string-manipulation",
          "labelMap": {
            "1": "String manipulation",
            "2": "String manipulation"
          },
          "puzzleCount": 1,
          "parentTopicId": 93
        },
        {
          "id": 61,
          "handle": "encoding",
          "labelMap": {
            "1": "Encodage",
            "2": "Encoding"
          },
          "pageTitle": "Encoding: exercises and theory",
          "puzzleCount": 3,
          "parentTopicId": 41,
          "contentDetailsId": 86
        },
        {
          "id": 73,
          "handle": "strings",
          "labelMap": {
            "1": "Chaînes de caractères",
            "2": "Strings"
          },
          "pageTitle": "Strings: exercises and theory",
          "puzzleCount": 11,
          "parentTopicId": 41,
          "contentDetailsId": 73
        }
      ],
      "solution": "import java.util.*;\n\npublic class Solution {\n\n    /**\n     * @param args\n     */\n    public static void main(String[] args) {\n        // TODO Auto-generated method stub\n        Scanner in = new Scanner(System.in);\n    \n        String str = in.next();\n        int N = in.nextInt();\n        String Rotor1 = in.next();\n        String Rotor2 = in.next();\n        String Rotor3 = in.next();\n        String message = in.next();\n        \n        HashMap<Character, Integer> map = new HashMap<Character, Integer>();\n        \n        for(int i=0; i< Rotor3.length(); i++) {\n            map.put(Rotor3.charAt(i), i);\n        }\n        \n        if(str.trim().equals(\"ENCODE\")) {\n            HashMap<Character, Character> map_1 = new HashMap<Character, Character>();\n            HashMap<Character, Character> map_2 = new HashMap<Character, Character>();\n            HashMap<Character, Character> map_3 = new HashMap<Character, Character>();\n            \n            char[] c1 = Rotor1.toCharArray();\n            char[] c2 = Rotor2.toCharArray();\n            char[] c3 = Rotor3.toCharArray();\n            \n            for(int j=0; j< c1.length; j++) {\n                map_1.put((char)(65+j), c1[j]);\n                map_2.put((char)(65+j), c2[j]);\n                map_3.put((char)(65+j), c3[j]);\n            }\n            \n            for(int i=0; i< message.length(); i++, N++) {\n                int temp = ((int)message.charAt(i)%65 + N) %26 + 65;\n                char c = map_1.get((char)temp);\n                c = map_2.get(c);\n                c = map_3.get(c);\n                System.out.print(c);\n            }\n        } else {\n            \n            HashMap<Character, Character> map_1 = new HashMap<Character, Character>();\n            HashMap<Character, Character> map_2 = new HashMap<Character, Character>();\n            HashMap<Character, Character> map_3 = new HashMap<Character, Character>();\n            \n            char[] c1 = Rotor1.toCharArray();\n            char[] c2 = Rotor2.toCharArray();\n            char[] c3 = Rotor3.toCharArray();\n            \n            for(int j=0; j< c1.length; j++) {\n                map_1.put(c1[j], (char)(65+j));\n                map_2.put(c2[j], (char)(65+j));\n                map_3.put(c3[j], (char)(65+j));\n            }\n            for(int i=0; i< message.length(); i++) {\n\n                char c = message.charAt(i);\n                c = map_3.get(c);\n                c = map_2.get(c);\n                c = map_1.get(c);\n                \n                int temp = (c-i-N);\n                \n               while(temp < 65)\n                       temp += 26;\n                System.out.print((char)((temp)%65%26+65));\n            }\n        }\n    }\n\n}\n",
      "statement": "During World War II, the Germans were using an encryption code called Enigma – which was basically an encryption machine that encrypted messages for transmission. The Enigma code went many years unbroken. Here's How the basic machine works:\n\nFirst Caesar shift is applied using an incrementing number:\nIf String is {{AAA}} and starting number is {{4}} then output will be {{EFG}}. \n`{{A + 4 = E}}\n{{A + 4 + 1 = F}}\n{{A + 4 + 1 + 1 = G}}`\nNow map {{EFG}} to first ROTOR such as:\n`ABCDEFGHIJKLMNOPQRSTUVWXYZ\nBDFHJLCPRTXVZNYEIWGAKMUSQO`So {{EFG}} becomes {{JLC}}. Then it is passed through 2 more rotors to get the final value.\n\nIf the second ROTOR is {{AJDKSIRUXBLHWTMCQGZNPYFVOE}}, we apply the substitution step again thus:\n`ABCDEFGHIJKLMNOPQRSTUVWXYZ\nAJDKSIRUXBLHWTMCQGZNPYFVOE`So {{JLC}} becomes {{BHD}}.\n\nIf the third ROTOR is {{EKMFLGDQVZNTOWYHXUSPAIBRCJ}}, then the final substitution is:\n`ABCDEFGHIJKLMNOPQRSTUVWXYZ\nEKMFLGDQVZNTOWYHXUSPAIBRCJ`So {{BHD}} becomes {{KQF}}.\n\nFinal output is sent via Radio Transmitter.",
      "testCases": [
        {
          "title": "Encode 3",
          "isTest": true,
          "testIn": "ENCODE\n4\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nAJDKSIRUXBLHWTMCQGZNPYFVOE\nEKMFLGDQVZNTOWYHXUSPAIBRCJ\nAAA",
          "testOut": "KQF",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 1",
          "isTest": false,
          "testIn": "DECODE\n4\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nAJDKSIRUXBLHWTMCQGZNPYFVOE\nEKMFLGDQVZNTOWYHXUSPAIBRCJ\nKQF",
          "testOut": "AAA",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Encode 23",
          "isTest": true,
          "testIn": "ENCODE\n7\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nAJDKSIRUXBLHWTMCQGZNPYFVOE\nEKMFLGDQVZNTOWYHXUSPAIBRCJ\nWEATHERREPORTWINDYTODAY",
          "testOut": "ALWAURKQEQQWLRAWZHUYKVN",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 2",
          "isTest": false,
          "testIn": "DECODE\n7\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nAJDKSIRUXBLHWTMCQGZNPYFVOE\nEKMFLGDQVZNTOWYHXUSPAIBRCJ\nALWAURKQEQQWLRAWZHUYKVN",
          "testOut": "WEATHERREPORTWINDYTODAY",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Decode 21",
          "isTest": true,
          "testIn": "DECODE\n9\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nAJDKSIRUXBLHWTMCQGZNPYFVOE\nEKMFLGDQVZNTOWYHXUSPAIBRCJ\nPQSACVVTOISXFXCIAMQEM",
          "testOut": "EVERYONEISWELCOMEHERE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 3",
          "isTest": false,
          "testIn": "DECODE\n8\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nUXBLHWTMCQGZNPYFVOEAJDKSIR\nEKMFLGNTOWYHXUSPAIBRCJDQVZ\nEPXAMAGWGUWQSTPTYPOCMYYJPGUEWCVGGCEZKANOQ",
          "testOut": "BETTERTHREEHOURSTOOSOONTHANAMINUTETOOLATE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Encode 21",
          "isTest": true,
          "testIn": "ENCODE\n9\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nAJDKSIRUXBLHWTMCQGZNPYFVOE\nEKMFLGDQVZNTOWYHXUSPAIBRCJ\nEVERYONEISWELCOMEHERE",
          "testOut": "PQSACVVTOISXFXCIAMQEM",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 4",
          "isTest": false,
          "testIn": "ENCODE\n8\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nAJDKSIRUXBLHWTMCQGZNPYFVOE\nEKMFLGDQVZNTOWYHXUSPAIBRCJ\nBETTERTHREEHOURSTOOSOONTHANAMINUTETOOLATE",
          "testOut": "WPAKRKMHMBHZDSPSGPYERGGXPMBWHEOMMEWQFKTYZ",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Encode 42",
          "isTest": true,
          "testIn": "ENCODE\n9\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nAJDKSIRUXBLHWTMCQGZNPYFVOE\nEKMFLGDQVZNTOWYHXUSPAIBRCJ\nEVERYONEISWELCOMEHEREEVERYONEISWELCOMEHERE",
          "testOut": "PQSACVVTOISXFXCIAMQEMDZIXFJJSTQIENEFQXVZYV",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 5",
          "isTest": false,
          "testIn": "ENCODE\n4\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nAJDKSIRUXBLHWTMCQGZNPYFVOE\nEKMFLGDQVZNTOWYHXUSPAIBRCJ\nTHEQUICKBROWNFOXJUMPSOVERALAZYSPHINXOFBLACKQUARTZ",
          "testOut": "JLIJVGLBPKVCAHFRASDLRPBQEASQQQZXGEOIVTGVUBKCRJSUO",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Decode 49",
          "isTest": true,
          "testIn": "DECODE\n5\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nAJDKSIRUXBLHWTMCQGZNPYFVOE\nEKMFLGDQVZNTOWYHXUSPAIBRCJ\nXPCXAUPHYQALKJMGKRWPGYHFTKRFFFNOUTZCABUAEHQLGXREZ",
          "testOut": "THEQUICKBROWNFOXJUMPSOVERALAZYSPHINXOFBLACKQUARTZ",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Validator 6",
          "isTest": false,
          "testIn": "DECODE\n6\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nAJDKSIRUXBLHWTMCQGZNPYFVOE\nEKMFLGDQVZNTOWYHXUSPAIBRCJ\nIVLZDOOGHMLBABDMZKVRKQJMBATTLGVMRXRAVBOJCO",
          "testOut": "EVERYONEISWELCOMEHEREEVERYONEISWELCOMEHERE",
          "isValidator": true,
          "needValidation": true
        }
      ],
      "difficulty": "easy",
      "constraints": "0 ≤ [[N]] < 26\n[[Message]] consists only of uppercase letters (A-Z)\n1 ≤ [[Message]] length < 50",
      "coverBinaryId": 38863263315387,
      "stubGenerator": "read Operation:string(256)\nread pseudoRandomNumber:int\nloop 3 read rotor:string(27)\nread message:string(1024)\nwrite message",
      "inputDescription": "<<Line 1:>>  {{ENCODE}} or {{DECODE}}\n<<Line 2:>> Starting shift [[N]]\n<<Lines 3-5:>>\n{{BDFHJLCPRTXVZNYEIWGAKMUSQO}} ROTOR I\n{{AJDKSIRUXBLHWTMCQGZNPYFVOE}} ROTOR II\n{{EKMFLGDQVZNTOWYHXUSPAIBRCJ}} ROTOR III\n<<Line 6:>> [[Message]] to Encode or Decode",
      "solutionLanguage": "Java",
      "outputDescription": "Encoded or Decoded String"
    },
    "draft": false,
    "readyForModeration": true,
    "statementHTML": "<div class=\"statement-body\">\n<div class=\"statement-section statement-goal\">\n   <h2><span class=\"icon icon-goal\">&nbsp;</span><span>Goal </span></h2>\n   <span class=\"question-statement\">During World War II, the Germans were using an encryption code called Enigma &ndash; which was basically an encryption machine that encrypted messages for transmission. The Enigma code went many years unbroken. Here's How the basic machine works:<br><br>First Caesar shift is applied using an incrementing number:<br>If String is <const>AAA</const> and starting number is <const>4</const> then output will be <const>EFG</const>. <br><pre style=\"font-family: monospace\"><const>A + 4 = E</const><br><const>A + 4 + 1 = F</const><br><const>A + 4 + 1 + 1 = G</const></pre><br>Now map <const>EFG</const> to first ROTOR such as:<br><pre style=\"font-family: monospace\">ABCDEFGHIJKLMNOPQRSTUVWXYZ<br>BDFHJLCPRTXVZNYEIWGAKMUSQO</pre>So <const>EFG</const> becomes <const>JLC</const>. Then it is passed through 2 more rotors to get the final value.<br><br>If the second ROTOR is <const>AJDKSIRUXBLHWTMCQGZNPYFVOE</const>, we apply the substitution step again thus:<br><pre style=\"font-family: monospace\">ABCDEFGHIJKLMNOPQRSTUVWXYZ<br>AJDKSIRUXBLHWTMCQGZNPYFVOE</pre>So <const>JLC</const> becomes <const>BHD</const>.<br><br>If the third ROTOR is <const>EKMFLGDQVZNTOWYHXUSPAIBRCJ</const>, then the final substitution is:<br><pre style=\"font-family: monospace\">ABCDEFGHIJKLMNOPQRSTUVWXYZ<br>EKMFLGDQVZNTOWYHXUSPAIBRCJ</pre>So <const>BHD</const> becomes <const>KQF</const>.<br><br>Final output is sent via Radio Transmitter.</span>\n</div>\n<div class=\"statement-section statement-protocol\">\n   <div class=\"blk\">\n      <div class=\"title\">Input</div>\n      <div class=\"question-statement-input\"><strong>Line 1:</strong>  <const>ENCODE</const> or <const>DECODE</const><br><strong>Line 2:</strong> Starting shift <var>N</var><br><strong>Lines 3-5:</strong><br><const>BDFHJLCPRTXVZNYEIWGAKMUSQO</const> ROTOR I<br><const>AJDKSIRUXBLHWTMCQGZNPYFVOE</const> ROTOR II<br><const>EKMFLGDQVZNTOWYHXUSPAIBRCJ</const> ROTOR III<br><strong>Line 6:</strong> <var>Message</var> to Encode or Decode</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Output</div>\n      <div class=\"question-statement-output\">Encoded or Decoded String</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Constraints</div>\n      <div class=\"question-statement-constraints\">0 &le; <var>N</var> &lt; 26<br><var>Message</var> consists only of uppercase letters (A-Z)<br>1 &le; <var>Message</var> length &lt; 50</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Example</div>\n      <div class=\"statement-inout\">\n         <div class=\"statement-inout-in\">\n            <div class=\"title\">Input</div>\n            <pre class=\"question-statement-example-in\">ENCODE\n4\nBDFHJLCPRTXVZNYEIWGAKMUSQO\nAJDKSIRUXBLHWTMCQGZNPYFVOE\nEKMFLGDQVZNTOWYHXUSPAIBRCJ\nAAA</pre>\n         </div>\n         <div class=\"statement-inout-out\">\n            <div class=\"title\">Output</div>\n            <pre class=\"question-statement-example-out\">KQF</pre>\n         </div>\n      </div>\n   </div>\n</div>"
  },
  "validatedFor": 231218043407,
  "avatar": 21191945710888,
  "commentCount": 28,
  "upVotes": 3,
  "downVotes": 8,
  "validateAction": {
    "actionId": 271105,
    "progress": 1,
    "alreadyDone": false
  },
  "statusHistory": [],
  "editable": true,
  "draft": false,
  "readyForModeration": true
}