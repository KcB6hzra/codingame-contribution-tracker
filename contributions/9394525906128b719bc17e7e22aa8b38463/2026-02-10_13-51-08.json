{
  "id": 939,
  "activeVersion": 21,
  "score": 7,
  "votableId": 6412165,
  "codingamerId": 2178794,
  "views": 366,
  "commentableId": 6352344,
  "title": "Completed Mahjong Hands",
  "status": "ACCEPTED",
  "type": "PUZZLE_INOUT",
  "nickname": "Unihedron",
  "publicHandle": "9394525906128b719bc17e7e22aa8b38463",
  "codingamerHandle": "1d1729a2d8c008c6cf728ee88f1faa6d4978712",
  "lastVersion": {
    "version": 21,
    "data": {
      "title": "Completed Mahjong Hands",
      "topics": [],
      "solution": "[a,[b,c]]=readline(j=m=0).split` `\nd=[...h='mpsz'].map(k=>!~(i=a.indexOf(k))?'':a.slice([j,j=i+1][0],i))\nd[i=h.indexOf(c)]=[...d[i]].concat(b).sort().join``\nif(~(''+d).search`(1+9+,){3}1+2+3+4+5+6+7`\n||d.every(k=>/^(?:(.)\\1(?!\\1))*$/.test(k)))print`TRUE`\nelse A:{\na=/(.)(\\1*)/g\ne=d.pop()\nwhile (n=a.exec(e))\n  if (!n[2]){print`FALSE`;break A}\n  else if(n[2].length == 1)if(m){print`FALSE`;break A}\n  else m=1\n// partialset:string (len % 3 == 0) -> true iff fail\nf=l=>{\n    // empty: cleared\n    if(!l.length)return\n    var[h,n,b]=l;\n    // single. impossible\n    if((a=n-h)>1)return 1\n    // step up, must be start of run: 122*3\n    i=l.indexOf(+n+1)\n    if(a==1)\n        // i == -1: incomplete run, impossible\n        return !~i?1:f(l.slice(2,i)+l.slice(i+1))\n    // (by elimination) h==n: same tile, check both runs and triplet\n    // potential for run: 111*22*3\n    if(~i) {\n        c=l.slice(1,i)+l.slice(i+1,i=l.indexOf(+n+2))+l.slice(i+1)\n        if(~i&&!f(c))\n            return\n    }\n    // potential for triplet: 111\n    return !(n==b && !f(l.slice(3)))\n}\nm=d.filter(k=>{\n    if(!(c=k.length%3))\n        // maybe all sets\n        return f(k)\n    else if(c==2) {\n        // might have pair here\n        r=/(.)\\1/g;\n        while (n=r.exec(k))\n            if(!f(k.slice(0,n.index)+k.slice(r.lastIndex)))\n                return m=1,0\n    }\n    return 1\n}).length?0:m\nprint(m?'TRUE':'FALSE')\n}",
      "statement": "<<Mahjong>> is a tabletop game played using tiles. It features three \"number\" suits (pins, sous, mans, represented as {{p}}, {{s}} and {{m}}) from {{1}} to {{9}}, and one \"honor\" suit {{z}} of seven distinct tiles. Note that contrary to western card games, tiles are not unique.\n\nhttps://user-images.githubusercontent.com/5595067/33491135-4ac4b4e6-d6f4-11e7-8df6-038f113fcef9.png\n\nTo complete a hand and win, the 13 tiles in your hand are combined with 1 newly drawn tile and must result in one of the following winning configurations:\n\n • <<4 sets>> and <<1 pair>>, self-explanatory\n • <<seven pairs>>, where all pairs are distinct (twice the same pair wouldn't qualify)\n • <<kokushi musou>>: one of each of the {{1}} and {{9}} of each number suit, one of every seven honors, the remaining tile forming a pair. (e.g. {{19m19p19s11234567z}})\n\nA <<pair>> is any of the two same tiles: {{11m}}, {{33s}}, {{44p}}, {{55z}}, etc.\n\nA <<set>> consists of 3 tiles of the same suit. It can either be a <<run>>: 3 number tiles ({{p}}, {{s}} or {{m}}) in a connected run like {{123s}} or {{234s}}, but not {{1m 2p 3s}} or{{234z}}; or a <<triplet>> of any suit, not necessarily numbers, like {{111z}}, {{222m}}.\n\nSo honor tiles (non-numbers, represented by {{z}}) can only form pairs or triplets, but not runs. {{567z}} is not a set, {{555z}} is a valid set, {{55z}} is a valid pair.\n\nA single tile can only be counted as part of one set or pair: there is no sharing or reusing.\n\nGiven a [[sorted hand]] of {{13}} tiles and one [[tile]], check whether the {{14}} tiles make up a completed hand.\n\nAttribution: Cover art \"The mahjong game\" by Lark Ascending on flickr (https://flickr.com/photos/vwilliams/5878216928)",
      "testCases": [
        {
          "title": "Four triplets",
          "isTest": true,
          "testIn": "222888m444p2277z 7z",
          "testOut": "TRUE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Four triplets",
          "isTest": false,
          "testIn": "333999m555p1133z 1z",
          "testOut": "TRUE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Wrong wait",
          "isTest": true,
          "testIn": "1122335778899m 1m",
          "testOut": "FALSE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Wrong wait",
          "isTest": false,
          "testIn": "1334455778899m 3m",
          "testOut": "FALSE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "All sequences",
          "isTest": true,
          "testIn": "234m45789p45688s 6p",
          "testOut": "TRUE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "All sequences",
          "isTest": false,
          "testIn": "34577m123p34678s 5s",
          "testOut": "TRUE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Wrong wind",
          "isTest": true,
          "testIn": "888m55s11222333z 4z",
          "testOut": "FALSE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Wrong wind",
          "isTest": false,
          "testIn": "55p888s22233344z 1z",
          "testOut": "FALSE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Seven pairs",
          "isTest": true,
          "testIn": "11m4477p8899s116z 6z",
          "testOut": "TRUE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Seven pairs",
          "isTest": false,
          "testIn": "55m1177p477s2233z 4s",
          "testOut": "TRUE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Kokushi musou, any wait",
          "isTest": true,
          "testIn": "19m19p19s1234567z 6z",
          "testOut": "TRUE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Kokushi musou, closed wait",
          "isTest": false,
          "testIn": "19m199p19s123467z 5z",
          "testOut": "TRUE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Complex hand",
          "isTest": true,
          "testIn": "122223567m3555p 4p",
          "testOut": "TRUE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Complex hand",
          "isTest": false,
          "testIn": "123345666m5557s 6s",
          "testOut": "TRUE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Complex wait",
          "isTest": true,
          "testIn": "1122223m111222z 4m",
          "testOut": "TRUE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Complex wait",
          "isTest": false,
          "testIn": "3344445p111222s 6p",
          "testOut": "TRUE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "No pair",
          "isTest": true,
          "testIn": "234m2233445566p 4p",
          "testOut": "FALSE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "No pair",
          "isTest": false,
          "testIn": "233445p4555678s 5s",
          "testOut": "FALSE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Wrong draw",
          "isTest": true,
          "testIn": "1133344566777m 9m",
          "testOut": "FALSE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Wrong draw",
          "isTest": false,
          "testIn": "2355567777889s 2s",
          "testOut": "FALSE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Right draw",
          "isTest": true,
          "testIn": "1133344566777m 5m",
          "testOut": "TRUE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Right draw",
          "isTest": false,
          "testIn": "2355567777889s 4s",
          "testOut": "TRUE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Trash",
          "isTest": true,
          "testIn": "113367m124578p1z 1z",
          "testOut": "FALSE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Trash",
          "isTest": false,
          "testIn": "124578m113367p2z 2z",
          "testOut": "FALSE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Golden gate bridge",
          "isTest": true,
          "testIn": "123345567789m3p 3p",
          "testOut": "TRUE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Golden gate bridge",
          "isTest": false,
          "testIn": "123345567789p3s 3s",
          "testOut": "TRUE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Four overlapping runs",
          "isTest": true,
          "testIn": "11m11112223333p 2p",
          "testOut": "TRUE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Four overlapping runs",
          "isTest": false,
          "testIn": "66667777888m33p 8m",
          "testOut": "TRUE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Not seven pairs",
          "isTest": true,
          "testIn": "11m4477p8899s666z 6z",
          "testOut": "FALSE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Not seven pairs",
          "isTest": false,
          "testIn": "55m117777p4s2233z 4s",
          "testOut": "FALSE",
          "isValidator": true,
          "needValidation": true
        },
        {
          "title": "Kokushi musou, missed wait",
          "isTest": true,
          "testIn": "19m139p19s123567z 4z",
          "testOut": "FALSE",
          "isValidator": false,
          "needValidation": true
        },
        {
          "title": "Kokushi musou, missed wait",
          "isTest": false,
          "testIn": "19m19p19s1234567z 7s",
          "testOut": "FALSE",
          "isValidator": true,
          "needValidation": true
        }
      ],
      "difficulty": "expert",
      "constraints": "14 ≤ length of [[sequence]] ≤ 17\nlength of [[tile]] = 2",
      "coverBinaryId": 135349505011073,
      "stubGenerator": "read line:string(20)\nwrite FALSE",
      "inputDescription": "<<Line 1:>> A [[sequence]] of numbers and letters, {{Space}}, a [[tile]] of a number and a letter\n\nIn the notation, the numeric value of every tile in a suit comes first, then the suit's letter. Tiles are grouped per suit, so each letters is written at most once. The three numbers suits are ordered from {{m}} to {{p}} to {{s}} and consist of ranks {{1}} to {{9}}. The honor suit orders last, is represented as {{z}} and consists of seven tiles from {{1}} to {{7}}.\n\nAs you may have gathered from the statement, in this puzzle the honor suit's tiles are represented as digits for ease of parsing and distinction, but they do not behave like numbers.",
      "solutionLanguage": "Javascript",
      "outputDescription": "<<Line 1:>> {{TRUE}} if and only if it is a match, otherwise {{FALSE}}."
    },
    "draft": false,
    "readyForModeration": true,
    "statementHTML": "<div class=\"statement-body\">\n<div class=\"statement-section statement-goal\">\n   <h2><span class=\"icon icon-goal\">&nbsp;</span><span>Goal </span></h2>\n   <span class=\"question-statement\"><strong>Mahjong</strong> is a tabletop game played using tiles. It features three &quot;number&quot; suits (pins, sous, mans, represented as <const>p</const>, <const>s</const> and <const>m</const>) from <const>1</const> to <const>9</const>, and one &quot;honor&quot; suit <const>z</const> of seven distinct tiles. Note that contrary to western card games, tiles are not unique.<br><br>https://user-images.githubusercontent.com/5595067/33491135-4ac4b4e6-d6f4-11e7-8df6-038f113fcef9.png<br><br>To complete a hand and win, the 13 tiles in your hand are combined with 1 newly drawn tile and must result in one of the following winning configurations:<br><br>&emsp;&bull; <strong>4 sets</strong> and <strong>1 pair</strong>, self-explanatory<br>&emsp;&bull; <strong>seven pairs</strong>, where all pairs are distinct (twice the same pair wouldn't qualify)<br>&emsp;&bull; <strong>kokushi musou</strong>: one of each of the <const>1</const> and <const>9</const> of each number suit, one of every seven honors, the remaining tile forming a pair. (e.g. <const>19m19p19s11234567z</const>)<br><br>A <strong>pair</strong> is any of the two same tiles: <const>11m</const>, <const>33s</const>, <const>44p</const>, <const>55z</const>, etc.<br><br>A <strong>set</strong> consists of 3 tiles of the same suit. It can either be a <strong>run</strong>: 3 number tiles (<const>p</const>, <const>s</const> or <const>m</const>) in a connected run like <const>123s</const> or <const>234s</const>, but not <const>1m 2p 3s</const> or<const>234z</const>; or a <strong>triplet</strong> of any suit, not necessarily numbers, like <const>111z</const>, <const>222m</const>.<br><br>So honor tiles (non-numbers, represented by <const>z</const>) can only form pairs or triplets, but not runs. <const>567z</const> is not a set, <const>555z</const> is a valid set, <const>55z</const> is a valid pair.<br><br>A single tile can only be counted as part of one set or pair: there is no sharing or reusing.<br><br>Given a <var>sorted hand</var> of <const>13</const> tiles and one <var>tile</var>, check whether the <const>14</const> tiles make up a completed hand.<br><br>Attribution: Cover art &quot;The mahjong game&quot; by Lark Ascending on flickr (https://flickr.com/photos/vwilliams/5878216928)</span>\n</div>\n<div class=\"statement-section statement-protocol\">\n   <div class=\"blk\">\n      <div class=\"title\">Input</div>\n      <div class=\"question-statement-input\"><strong>Line 1:</strong> A <var>sequence</var> of numbers and letters, <const>Space</const>, a <var>tile</var> of a number and a letter<br><br>In the notation, the numeric value of every tile in a suit comes first, then the suit's letter. Tiles are grouped per suit, so each letters is written at most once. The three numbers suits are ordered from <const>m</const> to <const>p</const> to <const>s</const> and consist of ranks <const>1</const> to <const>9</const>. The honor suit orders last, is represented as <const>z</const> and consists of seven tiles from <const>1</const> to <const>7</const>.<br><br>As you may have gathered from the statement, in this puzzle the honor suit's tiles are represented as digits for ease of parsing and distinction, but they do not behave like numbers.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Output</div>\n      <div class=\"question-statement-output\"><strong>Line 1:</strong> <const>TRUE</const> if and only if it is a match, otherwise <const>FALSE</const>.</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Constraints</div>\n      <div class=\"question-statement-constraints\">14 &le; length of <var>sequence</var> &le; 17<br>length of <var>tile</var> = 2</div>\n   </div>\n   <div class=\"blk\">\n      <div class=\"title\">Example</div>\n      <div class=\"statement-inout\">\n         <div class=\"statement-inout-in\">\n            <div class=\"title\">Input</div>\n            <pre class=\"question-statement-example-in\">222888m444p2277z 7z</pre>\n         </div>\n         <div class=\"statement-inout-out\">\n            <div class=\"title\">Output</div>\n            <pre class=\"question-statement-example-out\">TRUE</pre>\n         </div>\n      </div>\n   </div>\n</div>"
  },
  "validatedFor": 250023209174,
  "avatar": 17500773502453,
  "commentCount": 23,
  "upVotes": 8,
  "downVotes": 1,
  "validateAction": {
    "actionId": 173004,
    "progress": 1,
    "alreadyDone": false
  },
  "statusHistory": [],
  "editable": true,
  "draft": false,
  "readyForModeration": true
}